[{"filePath":"D:\\shavi acadimy\\Shavierp\\__tests__\\components\\theme-provider.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\shavi acadimy\\Shavierp\\__tests__\\components\\ui\\glass-card.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\shavi acadimy\\Shavierp\\__tests__\\lib\\nazmly\\lead-scorer.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\shavi acadimy\\Shavierp\\__tests__\\lib\\nazmly\\webhook-validator.test.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'logWebhookEvent' is defined but never used.","line":4,"column":5,"nodeType":null,"messageId":"unusedVar","endLine":4,"endColumn":20},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'isEventProcessed' is defined but never used.","line":5,"column":5,"nodeType":null,"messageId":"unusedVar","endLine":5,"endColumn":21}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { describe, it, expect } from 'vitest';\r\nimport {\r\n    verifyWebhookSignature,\r\n    logWebhookEvent,\r\n    isEventProcessed\r\n} from '@/lib/nazmly/webhook-validator';\r\nimport crypto from 'crypto';\r\n\r\ndescribe('Webhook Validator', () => {\r\n    describe('verifyWebhookSignature', () => {\r\n        it('should verify valid signature', () => {\r\n            const secret = 'test-secret';\r\n            const payload = JSON.stringify({ event: 'test' });\r\n\r\n            const signature = crypto\r\n                .createHmac('sha256', secret)\r\n                .update(payload)\r\n                .digest('hex');\r\n\r\n            const result = verifyWebhookSignature(payload, signature, secret);\r\n            expect(result).toBe(true);\r\n        });\r\n\r\n        it('should reject invalid signature', () => {\r\n            const result = verifyWebhookSignature(\r\n                'payload',\r\n                'invalid-signature',\r\n                'secret'\r\n            );\r\n\r\n            expect(result).toBe(false);\r\n        });\r\n\r\n        it('should return false on error', () => {\r\n            const result = verifyWebhookSignature(\r\n                'payload',\r\n                'short', // Too short for timingSafeEqual\r\n                'secret'\r\n            );\r\n\r\n            expect(result).toBe(false);\r\n        });\r\n    });\r\n});\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\shavi acadimy\\Shavierp\\app\\(dashboard)\\customer-success\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\shavi acadimy\\Shavierp\\app\\(dashboard)\\customer-success\\students\\new\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\shavi acadimy\\Shavierp\\app\\(dashboard)\\customer-success\\students\\page.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'fetchStudents'. Either include it or remove the dependency array.","line":26,"column":8,"nodeType":"ArrayExpression","endLine":26,"endColumn":22,"suggestions":[{"desc":"Update the dependencies array to be: [fetchStudents, statusFilter]","fix":{"range":[742,756],"text":"[fetchStudents, statusFilter]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport { useEffect, useState } from 'react';\r\nimport { useRouter } from 'next/navigation';\r\nimport { MagnifyingGlassIcon, FunnelIcon } from '@heroicons/react/24/outline';\r\n\r\ninterface Student {\r\n    id: string;\r\n    full_name: string;\r\n    email: string;\r\n    status: string;\r\n    attendance_rate: number;\r\n    engagement_score: number;\r\n    enrollment_date: string;\r\n}\r\n\r\nexport default function StudentsPage() {\r\n    const router = useRouter();\r\n    const [students, setStudents] = useState<Student[]>([]);\r\n    const [loading, setLoading] = useState(true);\r\n    const [search, setSearch] = useState('');\r\n    const [statusFilter, setStatusFilter] = useState('');\r\n\r\n    useEffect(() => {\r\n        fetchStudents();\r\n    }, [statusFilter]);\r\n\r\n    async function fetchStudents() {\r\n        try {\r\n            setLoading(true);\r\n            const params = new URLSearchParams();\r\n            if (statusFilter) params.append('status', statusFilter);\r\n            if (search) params.append('search', search);\r\n\r\n            const response = await fetch(`/api/customer-success/students?${params}`);\r\n            const data = await response.json();\r\n            setStudents(data.students || []);\r\n        } catch (error) {\r\n            console.error('Failed to fetch students:', error);\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    }\r\n\r\n    function getStatusBadge(status: string) {\r\n        const colors: Record<string, string> = {\r\n            active: 'bg-green-500/20 text-green-400',\r\n            at_risk: 'bg-red-500/20 text-red-400',\r\n            paused: 'bg-yellow-500/20 text-yellow-400',\r\n            dropped: 'bg-gray-500/20 text-gray-400',\r\n            completed: 'bg-blue-500/20 text-blue-400'\r\n        };\r\n\r\n        return (\r\n            <span className={`px-2 py-1 rounded text-xs font-medium ${colors[status] || 'bg-gray-500/20 text-gray-400'}`}>\r\n                {status}\r\n            </span>\r\n        );\r\n    }\r\n\r\n    return (\r\n        <div className=\"p-8 space-y-6\">\r\n            {/* Header */}\r\n            <div className=\"flex items-center justify-between\">\r\n                <div>\r\n                    <h1 className=\"text-3xl font-bold text-white\">Students</h1>\r\n                    <p className=\"text-slate-400 mt-1\">Manage all your students</p>\r\n                </div>\r\n            </div>\r\n\r\n            {/* Filters */}\r\n            <div className=\"bg-slate-800/50 border border-slate-700 rounded-lg p-4\">\r\n                <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\r\n                    <div className=\"relative\">\r\n                        <MagnifyingGlassIcon className=\"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-slate-400\" />\r\n                        <input\r\n                            type=\"text\"\r\n                            placeholder=\"Search students...\"\r\n                            value={search}\r\n                            onChange={(e) => setSearch(e.target.value)}\r\n                            onKeyDown={(e) => e.key === 'Enter' && fetchStudents()}\r\n                            className=\"w-full bg-slate-900 border border-slate-700 rounded-lg pl-10 pr-4 py-2 text-white placeholder-slate-400 focus:outline-none focus:border-purple-600\"\r\n                        />\r\n                    </div>\r\n\r\n                    <select\r\n                        value={statusFilter}\r\n                        onChange={(e) => setStatusFilter(e.target.value)}\r\n                        className=\"bg-slate-900 border border-slate-700 rounded-lg px-4 py-2 text-white focus:outline-none focus:border-purple-600\"\r\n                    >\r\n                        <option value=\"\">All Statuses</option>\r\n                        <option value=\"active\">Active</option>\r\n                        <option value=\"at_risk\">At Risk</option>\r\n                        <option value=\"paused\">Paused</option>\r\n                        <option value=\"completed\">Completed</option>\r\n                        <option value=\"dropped\">Dropped</option>\r\n                    </select>\r\n\r\n                    <button\r\n                        onClick={fetchStudents}\r\n                        className=\"flex items-center justify-center gap-2 bg-slate-700 hover:bg-slate-600 text-white px-4 py-2 rounded-lg transition-colors\"\r\n                    >\r\n                        <FunnelIcon className=\"w-5 h-5\" />\r\n                        Apply Filters\r\n                    </button>\r\n                </div>\r\n            </div>\r\n\r\n            {/* Students Table */}\r\n            <div className=\"bg-slate-800/50 border border-slate-700 rounded-lg overflow-hidden\">\r\n                {loading ? (\r\n                    <div className=\"p-8 text-center\">\r\n                        <div className=\"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-purple-600\"></div>\r\n                        <p className=\"text-slate-400 mt-2\">Loading students...</p>\r\n                    </div>\r\n                ) : students.length === 0 ? (\r\n                    <div className=\"p-8 text-center\">\r\n                        <p className=\"text-slate-400\">No students found</p>\r\n                    </div>\r\n                ) : (\r\n                    <table className=\"w-full\">\r\n                        <thead className=\"bg-slate-900/50 border-b border-slate-700\">\r\n                            <tr>\r\n                                <th className=\"px-6 py-3 text-left text-xs font-medium text-slate-400 uppercase tracking-wider\">\r\n                                    Student\r\n                                </th>\r\n                                <th className=\"px-6 py-3 text-left text-xs font-medium text-slate-400 uppercase tracking-wider\">\r\n                                    Status\r\n                                </th>\r\n                                <th className=\"px-6 py-3 text-left text-xs font-medium text-slate-400 uppercase tracking-wider\">\r\n                                    Attendance\r\n                                </th>\r\n                                <th className=\"px-6 py-3 text-left text-xs font-medium text-slate-400 uppercase tracking-wider\">\r\n                                    Engagement\r\n                                </th>\r\n                                <th className=\"px-6 py-3 text-left text-xs font-medium text-slate-400 uppercase tracking-wider\">\r\n                                    Enrolled\r\n                                </th>\r\n                            </tr>\r\n                        </thead>\r\n                        <tbody className=\"divide-y divide-slate-700\">\r\n                            {students.map((student) => (\r\n                                <tr\r\n                                    key={student.id}\r\n                                    onClick={() => router.push(`/customer-success/students/${student.id}`)}\r\n                                    className=\"hover:bg-slate-700/50 cursor-pointer transition-colors\"\r\n                                >\r\n                                    <td className=\"px-6 py-4 whitespace-nowrap\">\r\n                                        <div>\r\n                                            <div className=\"text-sm font-medium text-white\">\r\n                                                {student.full_name}\r\n                                            </div>\r\n                                            <div className=\"text-sm text-slate-400\">{student.email}</div>\r\n                                        </div>\r\n                                    </td>\r\n                                    <td className=\"px-6 py-4 whitespace-nowrap\">\r\n                                        {getStatusBadge(student.status)}\r\n                                    </td>\r\n                                    <td className=\"px-6 py-4 whitespace-nowrap text-sm text-white\">\r\n                                        {student.attendance_rate?.toFixed(1)}%\r\n                                    </td>\r\n                                    <td className=\"px-6 py-4 whitespace-nowrap text-sm text-white\">\r\n                                        {student.engagement_score}/100\r\n                                    </td>\r\n                                    <td className=\"px-6 py-4 whitespace-nowrap text-sm text-slate-400\">\r\n                                        {new Date(student.enrollment_date).toLocaleDateString()}\r\n                                    </td>\r\n                                </tr>\r\n                            ))}\r\n                        </tbody>\r\n                    </table>\r\n                )}\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\shavi acadimy\\Shavierp\\app\\(dashboard)\\customer-success\\tickets\\new\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\shavi acadimy\\Shavierp\\app\\(dashboard)\\customer-success\\tickets\\page.tsx","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: Property or signature expected.","line":10,"column":0}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport { useEffect, useState } from 'react';\r\nimport { useRouter } from 'next/navigation';\r\n\r\ninterface Ticket {\r\n    id: string;\r\n    subject: string;\r\n    status: string;\r\ninterface Ticket {\r\n    id: string;\r\n    subject: string;\r\n    status: string;\r\n    priority: string;\r\n    student: {\r\n        full_name: string;\r\n        email: string;\r\n    };\r\n    created_at: string;\r\n}\r\n\r\nexport default function TicketsPage() {\r\n    // Removed unused router\r\n    const [tickets, setTickets] = useState<Ticket[]>([]);\r\n    const [loading, setLoading] = useState(true);\r\n    const [statusFilter, setStatusFilter] = useState('');\r\n    const [priorityFilter, setPriorityFilter] = useState('');\r\n\r\n    useEffect(() => {\r\n        fetchTickets();\r\n    }, [statusFilter, priorityFilter]);\r\n\r\n    async function fetchTickets() {\r\n        try {\r\n            setLoading(true);\r\n            const params = new URLSearchParams();\r\n            if (statusFilter) params.append('status', statusFilter);\r\n            if (priorityFilter) params.append('priority', priorityFilter);\r\n\r\n            const response = await fetch(`/api/customer-success/tickets?${params}`);\r\n            const data = await response.json();\r\n            setTickets(data.tickets || []);\r\n        } catch (error) {\r\n            console.error('Failed to fetch tickets:', error);\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    }\r\n\r\n    function getPriorityBadge(priority: string) {\r\n        const colors: Record<string, string> = {\r\n            urgent: 'bg-red-500/20 text-red-400',\r\n            high: 'bg-orange-500/20 text-orange-400',\r\n            medium: 'bg-yellow-500/20 text-yellow-400',\r\n            low: 'bg-blue-500/20 text-blue-400'\r\n        };\r\n\r\n        return (\r\n            <span className={`px-2 py-1 rounded text-xs font-medium ${colors[priority] || 'bg-gray-500/20 text-gray-400'}`}>\r\n                {priority}\r\n            </span>\r\n        );\r\n    }\r\n\r\n    function getStatusBadge(status: string) {\r\n        const colors: Record<string, string> = {\r\n            open: 'bg-red-500/20 text-red-400',\r\n            in_progress: 'bg-yellow-500/20 text-yellow-400',\r\n            waiting: 'bg-blue-500/20 text-blue-400',\r\n            resolved: 'bg-green-500/20 text-green-400',\r\n            closed: 'bg-gray-500/20 text-gray-400'\r\n        };\r\n\r\n        return (\r\n            <span className={`px-2 py-1 rounded text-xs font-medium ${colors[status] || 'bg-gray-500/20 text-gray-400'}`}>\r\n                {status.replace('_', ' ')}\r\n            </span>\r\n        );\r\n    }\r\n\r\n    return (\r\n        <div className=\"p-8 space-y-6\">\r\n            <div className=\"flex items-center justify-between\">\r\n                <div>\r\n                    <h1 className=\"text-3xl font-bold text-white\">Support Tickets</h1>\r\n                    <p className=\"text-slate-400 mt-1\">Manage student support requests</p>\r\n                </div>\r\n            </div>\r\n\r\n            {/* Filters */}\r\n            <div className=\"bg-slate-800/50 border border-slate-700 rounded-lg p-4\">\r\n                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n                    <select\r\n                        value={statusFilter}\r\n                        onChange={(e) => setStatusFilter(e.target.value)}\r\n                        className=\"bg-slate-900 border border-slate-700 rounded-lg px-4 py-2 text-white focus:outline-none focus:border-purple-600\"\r\n                    >\r\n                        <option value=\"\">All Statuses</option>\r\n                        <option value=\"open\">Open</option>\r\n                        <option value=\"in_progress\">In Progress</option>\r\n                        <option value=\"waiting\">Waiting</option>\r\n                        <option value=\"resolved\">Resolved</option>\r\n                        <option value=\"closed\">Closed</option>\r\n                    </select>\r\n\r\n                    <select\r\n                        value={priorityFilter}\r\n                        onChange={(e) => setPriorityFilter(e.target.value)}\r\n                        className=\"bg-slate-900 border border-slate-700 rounded-lg px-4 py-2 text-white focus:outline-none focus:border-purple-600\"\r\n                    >\r\n                        <option value=\"\">All Priorities</option>\r\n                        <option value=\"urgent\">Urgent</option>\r\n                        <option value=\"high\">High</option>\r\n                        <option value=\"medium\">Medium</option>\r\n                        <option value=\"low\">Low</option>\r\n                    </select>\r\n                </div>\r\n            </div>\r\n\r\n            {/* Tickets Table */}\r\n            <div className=\"bg-slate-800/50 border border-slate-700 rounded-lg overflow-hidden\">\r\n                {loading ? (\r\n                    <div className=\"p-8 text-center\">\r\n                        <div className=\"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-purple-600\"></div>\r\n                        <p className=\"text-slate-400 mt-2\">Loading tickets...</p>\r\n                    </div>\r\n                ) : tickets.length === 0 ? (\r\n                    <div className=\"p-8 text-center\">\r\n                        <p className=\"text-slate-400\">No tickets found</p>\r\n                    </div>\r\n                ) : (\r\n                    <table className=\"w-full\">\r\n                        <thead className=\"bg-slate-900/50 border-b border-slate-700\">\r\n                            <tr>\r\n                                <th className=\"px-6 py-3 text-left text-xs font-medium text-slate-400 uppercase tracking-wider\">\r\n                                    Subject\r\n                                </th>\r\n                                <th className=\"px-6 py-3 text-left text-xs font-medium text-slate-400 uppercase tracking-wider\">\r\n                                    Student\r\n                                </th>\r\n                                <th className=\"px-6 py-3 text-left text-xs font-medium text-slate-400 uppercase tracking-wider\">\r\n                                    Priority\r\n                                </th>\r\n                                <th className=\"px-6 py-3 text-left text-xs font-medium text-slate-400 uppercase tracking-wider\">\r\n                                    Status\r\n                                </th>\r\n                                <th className=\"px-6 py-3 text-left text-xs font-medium text-slate-400 uppercase tracking-wider\">\r\n                                    Created\r\n                                </th>\r\n                            </tr>\r\n                        </thead>\r\n                        <tbody className=\"divide-y divide-slate-700\">\r\n                            {tickets.map((ticket) => (\r\n                                <tr\r\n                                    key={ticket.id}\r\n                                    className=\"hover:bg-slate-700/50 cursor-pointer transition-colors\"\r\n                                >\r\n                                    <td className=\"px-6 py-4\">\r\n                                        <div className=\"text-sm font-medium text-white\">\r\n                                            {ticket.subject}\r\n                                        </div>\r\n                                    </td>\r\n                                    <td className=\"px-6 py-4 whitespace-nowrap\">\r\n                                        <div className=\"text-sm text-white\">{ticket.student?.full_name || '-'}</div>\r\n                                        <div className=\"text-sm text-slate-400\">{ticket.student?.email || '-'}</div>\r\n                                    </td>\r\n                                    <td className=\"px-6 py-4 whitespace-nowrap\">\r\n                                        {getPriorityBadge(ticket.priority)}\r\n                                    </td>\r\n                                    <td className=\"px-6 py-4 whitespace-nowrap\">\r\n                                        {getStatusBadge(ticket.status)}\r\n                                    </td>\r\n                                    <td className=\"px-6 py-4 whitespace-nowrap text-sm text-slate-400\">\r\n                                        {new Date(ticket.created_at).toLocaleDateString()}\r\n                                    </td>\r\n                                </tr>\r\n                            ))}\r\n                        </tbody>\r\n                    </table>\r\n                )}\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\shavi acadimy\\Shavierp\\app\\(dashboard)\\finance\\expenses\\new\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\shavi acadimy\\Shavierp\\app\\(dashboard)\\finance\\expenses\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\shavi acadimy\\Shavierp\\app\\(dashboard)\\finance\\invoices\\new\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\shavi acadimy\\Shavierp\\app\\(dashboard)\\finance\\invoices\\page.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'fetchInvoices'. Either include it or remove the dependency array.","line":29,"column":8,"nodeType":"ArrayExpression","endLine":29,"endColumn":22,"suggestions":[{"desc":"Update the dependencies array to be: [fetchInvoices, statusFilter]","fix":{"range":[817,831],"text":"[fetchInvoices, statusFilter]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport { useEffect, useState } from 'react';\r\nimport { useRouter } from 'next/navigation';\r\n// Removed unused MagnifyingGlassIcon\r\nimport { PlusIcon, DocumentCheckIcon } from '@heroicons/react/24/outline';\r\n\r\ninterface Invoice {\r\n    id: string;\r\n    invoice_number: string;\r\n    title: string;\r\n    amount: number;\r\n    created_at: string;\r\n    status: 'draft' | 'sent' | 'paid' | 'overdue' | 'pending';\r\n    student?: {\r\n        full_name: string;\r\n        email: string;\r\n    };\r\n}\r\n\r\nexport default function InvoicesListPage() {\r\n    const router = useRouter();\r\n    const [invoices, setInvoices] = useState<Invoice[]>([]);\r\n    const [loading, setLoading] = useState(true);\r\n    const [statusFilter, setStatusFilter] = useState('all');\r\n\r\n    useEffect(() => {\r\n        fetchInvoices();\r\n    }, [statusFilter]);\r\n\r\n    async function fetchInvoices() {\r\n        setLoading(true);\r\n        try {\r\n            const params = new URLSearchParams();\r\n            if (statusFilter !== 'all') params.append('status', statusFilter);\r\n\r\n            const response = await fetch(`/api/finance/invoices?${params.toString()}`);\r\n            if (response.ok) {\r\n                const data = await response.json();\r\n                setInvoices(data.invoices || []);\r\n            }\r\n        } catch (error) {\r\n            console.error('Failed to fetch invoices:', error);\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    }\r\n\r\n    const getStatusColor = (status: string) => {\r\n        switch (status) {\r\n            case 'paid': return 'bg-green-500/10 text-green-500';\r\n            case 'pending':\r\n            case 'sent': return 'bg-yellow-500/10 text-yellow-500';\r\n            case 'overdue': return 'bg-red-500/10 text-red-500';\r\n            case 'draft': return 'bg-slate-500/10 text-slate-500';\r\n            default: return 'bg-slate-500/10 text-slate-500';\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div className=\"p-8 space-y-6\">\r\n            <div className=\"flex items-center justify-between\">\r\n                <div>\r\n                    <h1 className=\"text-3xl font-bold text-white\">Invoices</h1>\r\n                    <p className=\"text-slate-400 mt-1\">Billing history and revenue tracking</p>\r\n                </div>\r\n                <button\r\n                    onClick={() => router.push('/finance/invoices/new')}\r\n                    className=\"flex items-center gap-2 px-4 py-2 bg-purple-600 hover:bg-purple-700 text-white rounded-lg transition-colors\"\r\n                >\r\n                    <PlusIcon className=\"w-5 h-5\" />\r\n                    New Invoice\r\n                </button>\r\n            </div>\r\n\r\n            {/* Filters */}\r\n            <div className=\"flex gap-4 p-4 bg-slate-800/50 border border-slate-700 rounded-lg\">\r\n                <button\r\n                    onClick={() => setStatusFilter('all')}\r\n                    className={`px-4 py-2 rounded-lg text-sm transition-colors ${statusFilter === 'all' ? 'bg-purple-600 text-white' : 'text-slate-400 hover:text-white'}`}\r\n                >\r\n                    All\r\n                </button>\r\n                <button\r\n                    onClick={() => setStatusFilter('sent')}\r\n                    className={`px-4 py-2 rounded-lg text-sm transition-colors ${statusFilter === 'sent' ? 'bg-purple-600 text-white' : 'text-slate-400 hover:text-white'}`}\r\n                >\r\n                    Pending\r\n                </button>\r\n                <button\r\n                    onClick={() => setStatusFilter('paid')}\r\n                    className={`px-4 py-2 rounded-lg text-sm transition-colors ${statusFilter === 'paid' ? 'bg-purple-600 text-white' : 'text-slate-400 hover:text-white'}`}\r\n                >\r\n                    Paid\r\n                </button>\r\n                <button\r\n                    onClick={() => setStatusFilter('overdue')}\r\n                    className={`px-4 py-2 rounded-lg text-sm transition-colors ${statusFilter === 'overdue' ? 'bg-purple-600 text-white' : 'text-slate-400 hover:text-white'}`}\r\n                >\r\n                    Overdue\r\n                </button>\r\n            </div>\r\n\r\n            {/* List */}\r\n            <div className=\"bg-slate-800/50 border border-slate-700 rounded-lg overflow-hidden\">\r\n                <table className=\"w-full text-left\">\r\n                    <thead className=\"bg-slate-800\">\r\n                        <tr>\r\n                            <th className=\"p-4 text-sm font-medium text-slate-300\">Invoice #</th>\r\n                            <th className=\"p-4 text-sm font-medium text-slate-300\">Student</th>\r\n                            <th className=\"p-4 text-sm font-medium text-slate-300\">Title</th>\r\n                            <th className=\"p-4 text-sm font-medium text-slate-300\">Amount</th>\r\n                            <th className=\"p-4 text-sm font-medium text-slate-300\">Date</th>\r\n                            <th className=\"p-4 text-sm font-medium text-slate-300\">Status</th>\r\n                            <th className=\"p-4 text-sm font-medium text-slate-300\"></th>\r\n                        </tr>\r\n                    </thead>\r\n                    <tbody className=\"divide-y divide-slate-700\">\r\n                        {loading ? (\r\n                            <tr><td colSpan={7} className=\"p-8 text-center text-slate-400\">Loading invoices...</td></tr>\r\n                        ) : invoices.length === 0 ? (\r\n                            <tr><td colSpan={7} className=\"p-8 text-center text-slate-400\">No invoices found.</td></tr>\r\n                        ) : (\r\n                            invoices.map((inv) => (\r\n                                <tr key={inv.id} className=\"hover:bg-slate-700/50 transition-colors\">\r\n                                    <td className=\"p-4 text-white font-mono\">{inv.invoice_number}</td>\r\n                                    <td className=\"p-4 text-slate-300\">\r\n                                        {inv.student ? (\r\n                                            <div>\r\n                                                <div className=\"text-white\">{inv.student.full_name}</div>\r\n                                                <div className=\"text-xs text-slate-500\">{inv.student.email}</div>\r\n                                            </div>\r\n                                        ) : (\r\n                                            <span className=\"text-slate-500 italic\">No Student</span>\r\n                                        )}\r\n                                    </td>\r\n                                    <td className=\"p-4 text-slate-300\">{inv.title}</td>\r\n                                    <td className=\"p-4 text-white font-bold\">\r\n                                        ${new Intl.NumberFormat('en-US').format(inv.amount)}\r\n                                    </td>\r\n                                    <td className=\"p-4 text-slate-400 text-sm\">\r\n                                        {new Date(inv.created_at).toLocaleDateString()}\r\n                                    </td>\r\n                                    <td className=\"p-4\">\r\n                                        <span className={`px-2 py-1 rounded text-xs font-medium ${getStatusColor(inv.status)}`}>\r\n                                            {inv.status.toUpperCase()}\r\n                                        </span>\r\n                                    </td>\r\n                                    <td className=\"p-4 text-right\">\r\n                                        <button className=\"text-slate-400 hover:text-white\">\r\n                                            <DocumentCheckIcon className=\"w-5 h-5\" />\r\n                                        </button>\r\n                                    </td>\r\n                                </tr>\r\n                            ))\r\n                        )}\r\n                    </tbody>\r\n                </table>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\shavi acadimy\\Shavierp\\app\\(dashboard)\\finance\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\shavi acadimy\\Shavierp\\app\\(dashboard)\\hr\\employees\\new\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\shavi acadimy\\Shavierp\\app\\(dashboard)\\hr\\employees\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\shavi acadimy\\Shavierp\\app\\(dashboard)\\hr\\leave\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\shavi acadimy\\Shavierp\\app\\(dashboard)\\hr\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\shavi acadimy\\Shavierp\\app\\(dashboard)\\hr\\payroll\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\shavi acadimy\\Shavierp\\app\\(dashboard)\\layout.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\shavi acadimy\\Shavierp\\app\\(dashboard)\\loading.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\shavi acadimy\\Shavierp\\app\\(dashboard)\\marketing\\leads\\[id]\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'useParams' is defined but never used.","line":4,"column":21,"nodeType":null,"messageId":"unusedVar","endLine":4,"endColumn":30},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has an unnecessary dependency: 'params.id'. Either exclude it or remove the dependency array. Outer scope values like 'params.id' aren't valid dependencies because mutating them doesn't re-render the component.","line":39,"column":8,"nodeType":"ArrayExpression","endLine":39,"endColumn":19,"suggestions":[{"desc":"Update the dependencies array to be: []","fix":{"range":[1007,1018],"text":"[]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport { useEffect, useState } from 'react';\r\nimport { useRouter, useParams } from 'next/navigation';\r\nimport { ArrowLeftIcon } from '@heroicons/react/24/outline';\r\n\r\ninterface Lead {\r\n    id: string;\r\n    first_name: string;\r\n    last_name: string;\r\n    email: string;\r\n    phone?: string;\r\n    company?: string;\r\n    status: string;\r\n    score: number;\r\n    source: string;\r\n    created_at: string;\r\n}\r\n\r\ninterface Activity {\r\n    id: string;\r\n    title: string;\r\n    description: string;\r\n    created_at: string;\r\n}\r\n\r\nexport default function LeadDetailPage() {\r\n    const router = useRouter();\r\n    const [lead, setLead] = useState<Lead | null>(null);\r\n    const [activities, setActivities] = useState<Activity[]>([]);\r\n    const [loading, setLoading] = useState(true);\r\n    const [editMode, setEditMode] = useState(false);\r\n    const [formData, setFormData] = useState<Partial<Lead>>({});\r\n\r\n    useEffect(() => {\r\n        if (params.id) {\r\n            fetchLead();\r\n        }\r\n    }, [params.id]);\r\n\r\n    async function fetchLead() {\r\n        try {\r\n            const response = await fetch(`/api/marketing/leads/${params.id}`);\r\n            const data = await response.json();\r\n            setLead(data.lead);\r\n            setActivities(data.activities || []);\r\n            setFormData(data.lead);\r\n        } catch (error) {\r\n            console.error('Failed to fetch lead:', error);\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    }\r\n\r\n    async function handleUpdate() {\r\n        try {\r\n            const response = await fetch(`/api/marketing/leads/${params.id}`, {\r\n                method: 'PATCH',\r\n                headers: { 'Content-Type': 'application/json' },\r\n                body: JSON.stringify(formData)\r\n            });\r\n\r\n            if (response.ok) {\r\n                await fetchLead();\r\n                setEditMode(false);\r\n            }\r\n        } catch (error) {\r\n            console.error('Failed to update lead:', error);\r\n        }\r\n    }\r\n\r\n    if (loading) {\r\n        return (\r\n            <div className=\"p-8\">\r\n                <div className=\"animate-pulse space-y-4\">\r\n                    <div className=\"h-8 bg-slate-700 rounded w-1/4\"></div>\r\n                    <div className=\"h-64 bg-slate-700 rounded\"></div>\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    if (!lead) {\r\n        return (\r\n            <div className=\"p-8\">\r\n                <p className=\"text-slate-400\">Lead not found</p>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    return (\r\n        <div className=\"p-8 space-y-6\">\r\n            {/* Header */}\r\n            <div className=\"flex items-center gap-4\">\r\n                <button\r\n                    onClick={() => router.back()}\r\n                    className=\"p-2 hover:bg-slate-700 rounded-lg transition-colors\"\r\n                >\r\n                    <ArrowLeftIcon className=\"w-5 h-5 text-slate-400\" />\r\n                </button>\r\n                <div className=\"flex-1\">\r\n                    <h1 className=\"text-3xl font-bold text-white\">\r\n                        {lead.first_name} {lead.last_name}\r\n                    </h1>\r\n                    <p className=\"text-slate-400 mt-1\">{lead.email}</p>\r\n                </div>\r\n                <button\r\n                    onClick={() => setEditMode(!editMode)}\r\n                    className=\"px-4 py-2 bg-purple-600 hover:bg-purple-700 text-white rounded-lg transition-colors\"\r\n                >\r\n                    {editMode ? 'Cancel' : 'Edit'}\r\n                </button>\r\n            </div>\r\n\r\n            <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-6\">\r\n                {/* Lead Details */}\r\n                <div className=\"lg:col-span-2 space-y-6\">\r\n                    <div className=\"bg-slate-800/50 border border-slate-700 rounded-lg p-6 space-y-4\">\r\n                        <h2 className=\"text-xl font-semibold text-white\">Lead Information</h2>\r\n\r\n                        {editMode ? (\r\n                            <div className=\"space-y-4\">\r\n                                <div className=\"grid grid-cols-2 gap-4\">\r\n                                    <div>\r\n                                        <label className=\"block text-sm text-slate-400 mb-2\">First Name</label>\r\n                                        <input\r\n                                            type=\"text\"\r\n                                            value={formData.first_name}\r\n                                            onChange={(e) => setFormData({ ...formData, first_name: e.target.value })}\r\n                                            className=\"w-full bg-slate-900 border border-slate-700 rounded-lg px-4 py-2 text-white\"\r\n                                        />\r\n                                    </div>\r\n                                    <div>\r\n                                        <label className=\"block text-sm text-slate-400 mb-2\">Last Name</label>\r\n                                        <input\r\n                                            type=\"text\"\r\n                                            value={formData.last_name}\r\n                                            onChange={(e) => setFormData({ ...formData, last_name: e.target.value })}\r\n                                            className=\"w-full bg-slate-900 border border-slate-700 rounded-lg px-4 py-2 text-white\"\r\n                                        />\r\n                                    </div>\r\n                                </div>\r\n\r\n                                <div>\r\n                                    <label className=\"block text-sm text-slate-400 mb-2\">Company</label>\r\n                                    <input\r\n                                        type=\"text\"\r\n                                        value={formData.company || ''}\r\n                                        onChange={(e) => setFormData({ ...formData, company: e.target.value })}\r\n                                        className=\"w-full bg-slate-900 border border-slate-700 rounded-lg px-4 py-2 text-white\"\r\n                                    />\r\n                                </div>\r\n\r\n                                <div>\r\n                                    <label className=\"block text-sm text-slate-400 mb-2\">Status</label>\r\n                                    <select\r\n                                        value={formData.status}\r\n                                        onChange={(e) => setFormData({ ...formData, status: e.target.value })}\r\n                                        className=\"w-full bg-slate-900 border border-slate-700 rounded-lg px-4 py-2 text-white\"\r\n                                    >\r\n                                        <option value=\"new\">New</option>\r\n                                        <option value=\"contacted\">Contacted</option>\r\n                                        <option value=\"qualified\">Qualified</option>\r\n                                        <option value=\"disqualified\">Disqualified</option>\r\n                                    </select>\r\n                                </div>\r\n\r\n                                <div>\r\n                                    <label className=\"block text-sm text-slate-400 mb-2\">Score (0-100)</label>\r\n                                    <input\r\n                                        type=\"number\"\r\n                                        min=\"0\"\r\n                                        max=\"100\"\r\n                                        value={formData.score}\r\n                                        onChange={(e) => setFormData({ ...formData, score: parseInt(e.target.value) })}\r\n                                        className=\"w-full bg-slate-900 border border-slate-700 rounded-lg px-4 py-2 text-white\"\r\n                                    />\r\n                                </div>\r\n\r\n                                <button\r\n                                    onClick={handleUpdate}\r\n                                    className=\"w-full bg-purple-600 hover:bg-purple-700 text-white px-4 py-2 rounded-lg transition-colors\"\r\n                                >\r\n                                    Save Changes\r\n                                </button>\r\n                            </div>\r\n                        ) : (\r\n                            <div className=\"space-y-3\">\r\n                                <div className=\"flex justify-between border-b border-slate-700 pb-2\">\r\n                                    <span className=\"text-slate-400\">Company:</span>\r\n                                    <span className=\"text-white\">{lead.company || '-'}</span>\r\n                                </div>\r\n                                <div className=\"flex justify-between border-b border-slate-700 pb-2\">\r\n                                    <span className=\"text-slate-400\">Phone:</span>\r\n                                    <span className=\"text-white\">{lead.phone || '-'}</span>\r\n                                </div>\r\n                                <div className=\"flex justify-between border-b border-slate-700 pb-2\">\r\n                                    <span className=\"text-slate-400\">Status:</span>\r\n                                    <span className=\"text-white capitalize\">{lead.status}</span>\r\n                                </div>\r\n                                <div className=\"flex justify-between border-b border-slate-700 pb-2\">\r\n                                    <span className=\"text-slate-400\">Score:</span>\r\n                                    <span className=\"text-white font-bold\">{lead.score}</span>\r\n                                </div>\r\n                                <div className=\"flex justify-between border-b border-slate-700 pb-2\">\r\n                                    <span className=\"text-slate-400\">Source:</span>\r\n                                    <span className=\"text-white capitalize\">{lead.source}</span>\r\n                                </div>\r\n                            </div>\r\n                        )}\r\n                    </div>\r\n\r\n                    {/* Activities Timeline */}\r\n                    <div className=\"bg-slate-800/50 border border-slate-700 rounded-lg p-6\">\r\n                        <h2 className=\"text-xl font-semibold text-white mb-4\">Activity Timeline</h2>\r\n                        <div className=\"space-y-4\">\r\n                            {activities.map((activity) => (\r\n                                <div key={activity.id} className=\"flex gap-4 border-l-2 border-purple-600 pl-4\">\r\n                                    <div className=\"flex-1\">\r\n                                        <p className=\"text-white font-medium\">{activity.title}</p>\r\n                                        <p className=\"text-sm text-slate-400 mt-1\">{activity.description}</p>\r\n                                        <p className=\"text-xs text-slate-500 mt-2\">\r\n                                            {new Date(activity.created_at).toLocaleString()}\r\n                                        </p>\r\n                                    </div>\r\n                                </div>\r\n                            ))}\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n\r\n                {/* Sidebar */}\r\n                <div className=\"space-y-6\">\r\n                    <div className=\"bg-slate-800/50 border border-slate-700 rounded-lg p-6\">\r\n                        <h3 className=\"text-lg font-semibold text-white mb-4\">Quick Actions</h3>\r\n                        <div className=\"space-y-2\">\r\n                            <button className=\"w-full text-left px-4 py-2 bg-slate-700 hover:bg-slate-600 rounded-lg text-white transition-colors\">\r\n                                Send Email\r\n                            </button>\r\n                            <button className=\"w-full text-left px-4 py-2 bg-slate-700 hover:bg-slate-600 rounded-lg text-white transition-colors\">\r\n                                Schedule Call\r\n                            </button>\r\n                            <button className=\"w-full text-left px-4 py-2 bg-slate-700 hover:bg-slate-600 rounded-lg text-white transition-colors\">\r\n                                Add Note\r\n                            </button>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\shavi acadimy\\Shavierp\\app\\(dashboard)\\marketing\\leads\\new\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\shavi acadimy\\Shavierp\\app\\(dashboard)\\marketing\\leads\\page.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'fetchLeads'. Either include it or remove the dependency array.","line":29,"column":8,"nodeType":"ArrayExpression","endLine":29,"endColumn":36,"suggestions":[{"desc":"Update the dependencies array to be: [statusFilter, sourceFilter, fetchLeads]","fix":{"range":[815,843],"text":"[statusFilter, sourceFilter, fetchLeads]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport { useEffect, useState } from 'react';\r\nimport { useRouter } from 'next/navigation';\r\nimport { MagnifyingGlassIcon, FunnelIcon, PlusIcon } from '@heroicons/react/24/outline';\r\n\r\ninterface Lead {\r\n    id: string;\r\n    first_name: string;\r\n    last_name: string;\r\n    email: string;\r\n    company: string;\r\n    score: number;\r\n    status: string;\r\n    source: string;\r\n    created_at: string;\r\n}\r\n\r\nexport default function LeadsPage() {\r\n    const router = useRouter();\r\n    const [leads, setLeads] = useState<Lead[]>([]);\r\n    const [loading, setLoading] = useState(true);\r\n    const [search, setSearch] = useState('');\r\n    const [statusFilter, setStatusFilter] = useState('');\r\n    const [sourceFilter, setSourceFilter] = useState('');\r\n\r\n    useEffect(() => {\r\n        fetchLeads();\r\n    }, [statusFilter, sourceFilter]);\r\n\r\n    async function fetchLeads() {\r\n        try {\r\n            setLoading(true);\r\n            const params = new URLSearchParams();\r\n            if (statusFilter) params.append('status', statusFilter);\r\n            if (sourceFilter) params.append('source', sourceFilter);\r\n            if (search) params.append('search', search);\r\n\r\n            const response = await fetch(`/api/marketing/leads?${params}`);\r\n            const data = await response.json();\r\n            setLeads(data.leads || []);\r\n        } catch (error) {\r\n            console.error('Failed to fetch leads:', error);\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    }\r\n\r\n    function getScoreColor(score: number) {\r\n        if (score >= 80) return 'text-green-500';\r\n        if (score >= 60) return 'text-yellow-500';\r\n        return 'text-red-500';\r\n    }\r\n\r\n    function getStatusBadge(status: string) {\r\n        const colors: Record<string, string> = {\r\n            new: 'bg-blue-500/20 text-blue-400',\r\n            contacted: 'bg-yellow-500/20 text-yellow-400',\r\n            qualified: 'bg-green-500/20 text-green-400',\r\n            disqualified: 'bg-red-500/20 text-red-400',\r\n            converted: 'bg-purple-500/20 text-purple-400'\r\n        };\r\n\r\n        return (\r\n            <span className={`px-2 py-1 rounded text-xs font-medium ${colors[status] || 'bg-gray-500/20 text-gray-400'}`}>\r\n                {status}\r\n            </span>\r\n        );\r\n    }\r\n\r\n    return (\r\n        <div className=\"p-8 space-y-6\">\r\n            {/* Header */}\r\n            <div className=\"flex items-center justify-between\">\r\n                <div>\r\n                    <h1 className=\"text-3xl font-bold text-white\">Leads</h1>\r\n                    <p className=\"text-slate-400 mt-1\">Manage and track all your leads</p>\r\n                </div>\r\n                <button\r\n                    onClick={() => router.push('/marketing/leads/new')}\r\n                    className=\"flex items-center gap-2 bg-purple-600 hover:bg-purple-700 text-white px-4 py-2 rounded-lg transition-colors\"\r\n                >\r\n                    <PlusIcon className=\"w-5 h-5\" />\r\n                    Add Lead\r\n                </button>\r\n            </div>\r\n\r\n            {/* Filters */}\r\n            <div className=\"bg-slate-800/50 border border-slate-700 rounded-lg p-4\">\r\n                <div className=\"grid grid-cols-1 md:grid-cols-4 gap-4\">\r\n                    {/* Search */}\r\n                    <div className=\"relative\">\r\n                        <MagnifyingGlassIcon className=\"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-slate-400\" />\r\n                        <input\r\n                            type=\"text\"\r\n                            placeholder=\"Search leads...\"\r\n                            value={search}\r\n                            onChange={(e) => setSearch(e.target.value)}\r\n                            onKeyDown={(e) => e.key === 'Enter' && fetchLeads()}\r\n                            className=\"w-full bg-slate-900 border border-slate-700 rounded-lg pl-10 pr-4 py-2 text-white placeholder-slate-400 focus:outline-none focus:border-purple-600\"\r\n                        />\r\n                    </div>\r\n\r\n                    {/* Status Filter */}\r\n                    <select\r\n                        value={statusFilter}\r\n                        onChange={(e) => setStatusFilter(e.target.value)}\r\n                        className=\"bg-slate-900 border border-slate-700 rounded-lg px-4 py-2 text-white focus:outline-none focus:border-purple-600\"\r\n                    >\r\n                        <option value=\"\">All Statuses</option>\r\n                        <option value=\"new\">New</option>\r\n                        <option value=\"contacted\">Contacted</option>\r\n                        <option value=\"qualified\">Qualified</option>\r\n                        <option value=\"disqualified\">Disqualified</option>\r\n                        <option value=\"converted\">Converted</option>\r\n                    </select>\r\n\r\n                    {/* Source Filter */}\r\n                    <select\r\n                        value={sourceFilter}\r\n                        onChange={(e) => setSourceFilter(e.target.value)}\r\n                        className=\"bg-slate-900 border border-slate-700 rounded-lg px-4 py-2 text-white focus:outline-none focus:border-purple-600\"\r\n                    >\r\n                        <option value=\"\">All Sources</option>\r\n                        <option value=\"nazmly\">Nazmly</option>\r\n                        <option value=\"website\">Website</option>\r\n                        <option value=\"referral\">Referral</option>\r\n                        <option value=\"social\">Social Media</option>\r\n                        <option value=\"manual\">Manual</option>\r\n                    </select>\r\n\r\n                    <button\r\n                        onClick={fetchLeads}\r\n                        className=\"flex items-center justify-center gap-2 bg-slate-700 hover:bg-slate-600 text-white px-4 py-2 rounded-lg transition-colors\"\r\n                    >\r\n                        <FunnelIcon className=\"w-5 h-5\" />\r\n                        Apply Filters\r\n                    </button>\r\n                </div>\r\n            </div>\r\n\r\n            {/* Leads Table */}\r\n            <div className=\"bg-slate-800/50 border border-slate-700 rounded-lg overflow-hidden\">\r\n                {loading ? (\r\n                    <div className=\"p-8 text-center\">\r\n                        <div className=\"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-purple-600\"></div>\r\n                        <p className=\"text-slate-400 mt-2\">Loading leads...</p>\r\n                    </div>\r\n                ) : leads.length === 0 ? (\r\n                    <div className=\"p-8 text-center\">\r\n                        <p className=\"text-slate-400\">No leads found</p>\r\n                    </div>\r\n                ) : (\r\n                    <table className=\"w-full\">\r\n                        <thead className=\"bg-slate-900/50 border-b border-slate-700\">\r\n                            <tr>\r\n                                <th className=\"px-6 py-3 text-left text-xs font-medium text-slate-400 uppercase tracking-wider\">\r\n                                    Name\r\n                                </th>\r\n                                <th className=\"px-6 py-3 text-left text-xs font-medium text-slate-400 uppercase tracking-wider\">\r\n                                    Company\r\n                                </th>\r\n                                <th className=\"px-6 py-3 text-left text-xs font-medium text-slate-400 uppercase tracking-wider\">\r\n                                    Score\r\n                                </th>\r\n                                <th className=\"px-6 py-3 text-left text-xs font-medium text-slate-400 uppercase tracking-wider\">\r\n                                    Status\r\n                                </th>\r\n                                <th className=\"px-6 py-3 text-left text-xs font-medium text-slate-400 uppercase tracking-wider\">\r\n                                    Source\r\n                                </th>\r\n                                <th className=\"px-6 py-3 text-left text-xs font-medium text-slate-400 uppercase tracking-wider\">\r\n                                    Created\r\n                                </th>\r\n                            </tr>\r\n                        </thead>\r\n                        <tbody className=\"divide-y divide-slate-700\">\r\n                            {leads.map((lead) => (\r\n                                <tr\r\n                                    key={lead.id}\r\n                                    onClick={() => router.push(`/marketing/leads/${lead.id}`)}\r\n                                    className=\"hover:bg-slate-700/50 cursor-pointer transition-colors\"\r\n                                >\r\n                                    <td className=\"px-6 py-4 whitespace-nowrap\">\r\n                                        <div>\r\n                                            <div className=\"text-sm font-medium text-white\">\r\n                                                {lead.first_name} {lead.last_name}\r\n                                            </div>\r\n                                            <div className=\"text-sm text-slate-400\">{lead.email}</div>\r\n                                        </div>\r\n                                    </td>\r\n                                    <td className=\"px-6 py-4 whitespace-nowrap text-sm text-white\">\r\n                                        {lead.company || '-'}\r\n                                    </td>\r\n                                    <td className=\"px-6 py-4 whitespace-nowrap\">\r\n                                        <span className={`text-sm font-bold ${getScoreColor(lead.score)}`}>\r\n                                            {lead.score}\r\n                                        </span>\r\n                                    </td>\r\n                                    <td className=\"px-6 py-4 whitespace-nowrap\">\r\n                                        {getStatusBadge(lead.status)}\r\n                                    </td>\r\n                                    <td className=\"px-6 py-4 whitespace-nowrap text-sm text-slate-300\">\r\n                                        {lead.source}\r\n                                    </td>\r\n                                    <td className=\"px-6 py-4 whitespace-nowrap text-sm text-slate-400\">\r\n                                        {new Date(lead.created_at).toLocaleDateString()}\r\n                                    </td>\r\n                                </tr>\r\n                            ))}\r\n                        </tbody>\r\n                    </table>\r\n                )}\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\shavi acadimy\\Shavierp\\app\\(dashboard)\\marketing\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\shavi acadimy\\Shavierp\\app\\(dashboard)\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'CheckCircle' is defined but never used.","line":10,"column":5,"nodeType":null,"messageId":"unusedVar","endLine":10,"endColumn":16},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'TrendingUp' is defined but never used.","line":11,"column":5,"nodeType":null,"messageId":"unusedVar","endLine":11,"endColumn":15},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'BriefcaseIcon' is defined but never used.","line":13,"column":18,"nodeType":null,"messageId":"unusedVar","endLine":13,"endColumn":31}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport { useEffect, useState } from 'react';\r\nimport { StatCard } from \"@/components/dashboard/stat-card\";\r\nimport {\r\n    Users,\r\n    UserPlus,\r\n    GraduationCap,\r\n    DollarSign,\r\n    CheckCircle,\r\n    TrendingUp,\r\n    Calendar,\r\n    Briefcase as BriefcaseIcon,\r\n    Banknote as BanknotesIcon,\r\n    UserCog as UserGroupIcon\r\n} from \"lucide-react\";\r\nimport { GlassCard, GlassCardHeader, GlassCardContent } from \"@/components/ui/glass-card\";\r\nimport { DraggableGrid, DashboardWidget } from \"@/components/dashboard/draggable-grid\";\r\nimport dynamic from \"next/dynamic\";\r\nimport { LoadingSpinner } from \"@/components/ui/loading\";\r\nimport { useRouter } from \"next/navigation\";\r\n\r\n// Lazy load DashboardCustomizer\r\nconst DashboardCustomizer = dynamic(\r\n    () => import(\"@/components/settings/dashboard-customizer\").then(mod => ({ default: mod.DashboardCustomizer })),\r\n    {\r\n        ssr: false,\r\n        loading: () => <LoadingSpinner size=\"sm\" />\r\n    }\r\n);\r\n\r\nexport default function DashboardPage() {\r\n    const router = useRouter();\r\n    const [loading, setLoading] = useState(true);\r\n    const [data, setData] = useState({\r\n        marketing: { totalLeads: 0, qualifiedLeads: 0 },\r\n        cs: { activeStudents: 0, totalStudents: 0 },\r\n        finance: { totalRevenue: 0, revenueThisMonth: 0 }, // revenueThisMonth might need a specific query or just use total for now\r\n        hr: { totalEmployees: 0 }\r\n    });\r\n\r\n    useEffect(() => {\r\n        fetchAllStats();\r\n    }, []);\r\n\r\n    async function fetchAllStats() {\r\n        try {\r\n            const [marketingRes, csRes, financeRes, hrRes] = await Promise.all([\r\n                fetch('/api/marketing/stats'),\r\n                fetch('/api/customer-success/stats'),\r\n                fetch('/api/finance/stats'),\r\n                fetch('/api/hr/stats')\r\n            ]);\r\n\r\n            const marketing = marketingRes.ok ? await marketingRes.json() : {};\r\n            const cs = csRes.ok ? await csRes.json() : {};\r\n            const finance = financeRes.ok ? await financeRes.json() : {};\r\n            const hr = hrRes.ok ? await hrRes.json() : {};\r\n\r\n            setData({\r\n                marketing: {\r\n                    totalLeads: marketing.totalLeads || 0,\r\n                    qualifiedLeads: marketing.qualifiedLeads || 0\r\n                },\r\n                cs: {\r\n                    activeStudents: cs.overview?.active_students || 0, // Mapping from CS API structure\r\n                    totalStudents: cs.overview?.total_students || 0\r\n                },\r\n                finance: {\r\n                    totalRevenue: finance.totalRevenue || 0,\r\n                    revenueThisMonth: 0 // Placeholder as API provides total\r\n                },\r\n                hr: {\r\n                    totalEmployees: hr.totalEmployees || 0\r\n                }\r\n            });\r\n        } catch (error) {\r\n            console.error('Failed to load dashboard stats', error);\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    }\r\n\r\n    if (loading) {\r\n        return (\r\n            <div className=\"flex items-center justify-center h-screen\">\r\n                <LoadingSpinner size=\"lg\" />\r\n            </div>\r\n        );\r\n    }\r\n\r\n    // Define draggable widgets\r\n    const statWidgets: DashboardWidget[] = [\r\n        {\r\n            id: \"leads-stat\",\r\n            title: \"  \",\r\n            category: \"Marketing\",\r\n            component: (\r\n                <StatCard\r\n                    title=\" \"\r\n                    value={data.marketing.totalLeads}\r\n                    icon={Users}\r\n                    description={`${data.marketing.qualifiedLeads} `}\r\n                    trend={{ value: 0, isPositive: true }}\r\n                    className=\"cursor-pointer\"\r\n                    onClick={() => router.push('/marketing')}\r\n                />\r\n            ),\r\n        },\r\n        {\r\n            id: \"students-stat\",\r\n            title: \" \",\r\n            category: \"Customer Success\",\r\n            component: (\r\n                <StatCard\r\n                    title=\" \"\r\n                    value={data.cs.activeStudents}\r\n                    icon={GraduationCap}\r\n                    description={` ${data.cs.totalStudents}  `}\r\n                    trend={{ value: 0, isPositive: true }}\r\n                    className=\"cursor-pointer\"\r\n                    onClick={() => router.push('/customer-success')}\r\n                />\r\n            ),\r\n        },\r\n        {\r\n            id: \"revenue-stat\",\r\n            title: \" \",\r\n            category: \"Finance\",\r\n            component: (\r\n                <StatCard\r\n                    title=\" \"\r\n                    value={`$${(data.finance.totalRevenue).toLocaleString()}`}\r\n                    icon={DollarSign}\r\n                    description=\" \"\r\n                    trend={{ value: 0, isPositive: true }}\r\n                    className=\"cursor-pointer\"\r\n                    onClick={() => router.push('/finance')}\r\n                />\r\n            ),\r\n        },\r\n        {\r\n            id: \"hr-stat\",\r\n            title: \"\",\r\n            category: \"HR\",\r\n            component: (\r\n                <StatCard\r\n                    title=\" \"\r\n                    value={data.hr.totalEmployees}\r\n                    icon={UserGroupIcon}\r\n                    description=\" \"\r\n                    trend={{ value: 0, isPositive: true }}\r\n                    className=\"cursor-pointer\"\r\n                    onClick={() => router.push('/hr')}\r\n                />\r\n            ),\r\n        },\r\n    ];\r\n\r\n    const contentWidgets: DashboardWidget[] = [\r\n        {\r\n            id: \"quick-actions\",\r\n            title: \" \",\r\n            category: \"\",\r\n            component: (\r\n                <GlassCard intensity=\"light\" hover className=\"h-full\">\r\n                    <GlassCardHeader>\r\n                        <h2 className=\"text-lg font-semibold\"> </h2>\r\n                    </GlassCardHeader>\r\n                    <GlassCardContent>\r\n                        <div className=\"grid gap-3 md:grid-cols-2\">\r\n                            {[\r\n                                { icon: UserPlus, label: \" \", color: \"bg-blue-500\", action: () => router.push('/marketing/leads/new') },\r\n                                { icon: GraduationCap, label: \" \", color: \"bg-green-500\", action: () => router.push('/customer-success/students/new') },\r\n                                { icon: Calendar, label: \" \", color: \"bg-purple-500\", action: () => router.push('/trainers/new') },\r\n                                { icon: BanknotesIcon, label: \" \", color: \"bg-emerald-600\", action: () => router.push('/finance/invoices/new') },\r\n                            ].map((action, index) => (\r\n                                <button\r\n                                    key={index}\r\n                                    onClick={action.action}\r\n                                    className=\"flex items-center gap-3 p-4 rounded-lg border hover:bg-accent transition-colors text-left\"\r\n                                >\r\n                                    <div className={`p-2 rounded-lg ${action.color} text-white`}>\r\n                                        <action.icon className=\"w-5 h-5\" />\r\n                                    </div>\r\n                                    <span className=\"text-sm font-medium\">{action.label}</span>\r\n                                </button>\r\n                            ))}\r\n                        </div>\r\n                    </GlassCardContent>\r\n                </GlassCard>\r\n            ),\r\n        },\r\n        // ... Keeping other widgets or simplifying for MVP\r\n    ];\r\n\r\n    // Widget configuration for customizer\r\n    const widgetConfig = [\r\n        ...statWidgets.map(w => ({ id: w.id, title: w.title, visible: true, category: w.category })),\r\n        ...contentWidgets.map(w => ({ id: w.id, title: w.title, visible: true, category: w.category })),\r\n    ];\r\n\r\n    return (\r\n        <div className=\"flex flex-col gap-6 p-6 pb-24\">\r\n            {/* Header */}\r\n            <div>\r\n                <h1 className=\"text-3xl font-bold text-foreground\">\r\n                       Shavi Academy OS \r\n                </h1>\r\n                <p className=\"text-muted-foreground mt-2\">\r\n                        -  3.0\r\n                </p>\r\n            </div>\r\n\r\n            {/* Draggable Stats Grid */}\r\n            <DraggableGrid\r\n                widgets={statWidgets}\r\n                className=\"grid gap-4 md:grid-cols-2 lg:grid-cols-4\"\r\n                storageKey=\"dashboard-stats-layout\"\r\n            />\r\n\r\n            {/* Draggable Content Grid */}\r\n            <DraggableGrid\r\n                widgets={contentWidgets}\r\n                className=\"grid gap-4 md:grid-cols-1 lg:grid-cols-2\" // Simplified layout\r\n                storageKey=\"dashboard-content-layout\"\r\n            />\r\n\r\n            {/* Dashboard Customizer */}\r\n            <DashboardCustomizer widgets={widgetConfig} />\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\shavi acadimy\\Shavierp\\app\\(dashboard)\\sales\\deals\\new\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\shavi acadimy\\Shavierp\\app\\(dashboard)\\sales\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\shavi acadimy\\Shavierp\\app\\(dashboard)\\sales\\pipeline\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":13,"column":11,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":13,"endColumn":14,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[318,321],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[318,321],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":54,"column":42,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":54,"endColumn":45,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1683,1686],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1683,1686],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport { useEffect, useState } from 'react';\r\nimport { useRouter } from 'next/navigation';\r\nimport { DragDropContext, Droppable, Draggable } from '@hello-pangea/dnd';\r\n\r\ninterface Deal {\r\n    id: string;\r\n    title: string;\r\n    value: number;\r\n    stage: string;\r\n    probability: number;\r\n    lead: any;\r\n}\r\n\r\nconst STAGES = [\r\n    { id: 'new', name: 'New', color: 'blue' },\r\n    { id: 'discovery', name: 'Discovery', color: 'yellow' },\r\n    { id: 'proposal', name: 'Proposal', color: 'purple' },\r\n    { id: 'negotiation', name: 'Negotiation', color: 'orange' },\r\n    { id: 'closed_won', name: 'Won', color: 'green' },\r\n    { id: 'closed_lost', name: 'Lost', color: 'red' }\r\n];\r\n\r\nexport default function SalesPipelinePage() {\r\n    const router = useRouter();\r\n    const [dealsByStage, setDealsByStage] = useState<Record<string, Deal[]>>({});\r\n    const [loading, setLoading] = useState(true);\r\n\r\n    useEffect(() => {\r\n        fetchDeals();\r\n    }, []);\r\n\r\n    async function fetchDeals() {\r\n        try {\r\n            setLoading(true);\r\n            const response = await fetch('/api/sales/deals');\r\n            const data = await response.json();\r\n\r\n            // Group deals by stage\r\n            const grouped = STAGES.reduce((acc, stage) => {\r\n                acc[stage.id] = data.deals?.filter((d: Deal) => d.stage === stage.id) || [];\r\n                return acc;\r\n            }, {} as Record<string, Deal[]>);\r\n\r\n            setDealsByStage(grouped);\r\n        } catch (error) {\r\n            console.error('Failed to fetch deals:', error);\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    }\r\n\r\n    async function handleDragEnd(result: any) {\r\n        if (!result.destination) return;\r\n\r\n        const { source, destination, draggableId } = result;\r\n\r\n        if (source.droppableId === destination.droppableId) return;\r\n\r\n        // Update stage\r\n        try {\r\n            await fetch(`/api/sales/deals/${draggableId}`, {\r\n                method: 'PATCH',\r\n                headers: { 'Content-Type': 'application/json' },\r\n                body: JSON.stringify({ stage: destination.droppableId })\r\n            });\r\n\r\n            // Update local state\r\n            const newDealsByStage = { ...dealsByStage };\r\n            const [movedDeal] = newDealsByStage[source.droppableId].splice(source.index, 1);\r\n            movedDeal.stage = destination.droppableId;\r\n            newDealsByStage[destination.droppableId].splice(destination.index, 0, movedDeal);\r\n            setDealsByStage(newDealsByStage);\r\n        } catch (error) {\r\n            console.error('Failed to update deal:', error);\r\n        }\r\n    }\r\n\r\n    if (loading) {\r\n        return (\r\n            <div className=\"p-8\">\r\n                <div className=\"animate-pulse\">\r\n                    <div className=\"h-8 bg-slate-700 rounded w-1/4 mb-8\"></div>\r\n                    <div className=\"grid grid-cols-6 gap-4\">\r\n                        {[1, 2, 3, 4, 5, 6].map(i => (\r\n                            <div key={i} className=\"h-96 bg-slate-700 rounded\"></div>\r\n                        ))}\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    return (\r\n        <div className=\"p-8 space-y-6\">\r\n            <div className=\"flex items-center justify-between\">\r\n                <div>\r\n                    <h1 className=\"text-3xl font-bold text-white\">Sales Pipeline</h1>\r\n                    <p className=\"text-slate-400 mt-1\">Drag and drop to move deals</p>\r\n                </div>\r\n                <button\r\n                    onClick={() => router.push('/sales/deals/new')}\r\n                    className=\"bg-purple-600 hover:bg-purple-700 text-white px-4 py-2 rounded-lg transition-colors\"\r\n                >\r\n                    + New Deal\r\n                </button>\r\n            </div>\r\n\r\n            <DragDropContext onDragEnd={handleDragEnd}>\r\n                <div className=\"grid grid-cols-6 gap-4\">\r\n                    {STAGES.map((stage) => (\r\n                        <div key={stage.id} className=\"flex flex-col\">\r\n                            <div className={`bg-${stage.color}-500/20 border border-${stage.color}-500/30 rounded-t-lg p-3`}>\r\n                                <h3 className={`font-semibold text-${stage.color}-400`}>{stage.name}</h3>\r\n                                <p className=\"text-sm text-slate-400 mt-1\">\r\n                                    {dealsByStage[stage.id]?.length || 0} deals\r\n                                </p>\r\n                            </div>\r\n\r\n                            <Droppable droppableId={stage.id}>\r\n                                {(provided, snapshot) => (\r\n                                    <div\r\n                                        ref={provided.innerRef}\r\n                                        {...provided.droppableProps}\r\n                                        className={`flex-1 bg-slate-800/50 border-x border-b border-slate-700 rounded-b-lg p-2 min-h-[500px] ${snapshot.isDraggingOver ? 'bg-slate-700/50' : ''\r\n                                            }`}\r\n                                    >\r\n                                        <div className=\"space-y-2\">\r\n                                            {dealsByStage[stage.id]?.map((deal, index) => (\r\n                                                <Draggable key={deal.id} draggableId={deal.id} index={index}>\r\n                                                    {(provided, snapshot) => (\r\n                                                        <div\r\n                                                            ref={provided.innerRef}\r\n                                                            {...provided.draggableProps}\r\n                                                            {...provided.dragHandleProps}\r\n                                                            onClick={() => router.push(`/sales/deals/${deal.id}`)}\r\n                                                            className={`bg-slate dark:bg-slate-900 border border-slate-700 rounded-lg p-3 cursor-pointer hover:border-purple-600 transition-colors ${snapshot.isDragging ? 'opacity-50' : ''\r\n                                                                }`}\r\n                                                        >\r\n                                                            <h4 className=\"text-white font-medium text-sm line-clamp-2\">\r\n                                                                {deal.title}\r\n                                                            </h4>\r\n                                                            <p className=\"text-green-500 font-bold text-lg mt-2\">\r\n                                                                ${deal.value.toLocaleString()}\r\n                                                            </p>\r\n                                                            {deal.lead && (\r\n                                                                <p className=\"text-xs text-slate-400 mt-2\">\r\n                                                                    {deal.lead.first_name} {deal.lead.last_name}\r\n                                                                </p>\r\n                                                            )}\r\n                                                            <div className=\"flex items-center justify-between mt-2\">\r\n                                                                <span className=\"text-xs text-slate-400\">\r\n                                                                    {deal.probability}%\r\n                                                                </span>\r\n                                                            </div>\r\n                                                        </div>\r\n                                                    )}\r\n                                                </Draggable>\r\n                                            ))}\r\n                                            {provided.placeholder}\r\n                                        </div>\r\n                                    </div>\r\n                                )}\r\n                            </Droppable>\r\n                        </div>\r\n                    ))}\r\n                </div>\r\n            </DragDropContext>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\shavi acadimy\\Shavierp\\app\\(dashboard)\\settings\\page.tsx","messages":[{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\nD:\\shavi acadimy\\Shavierp\\app\\(dashboard)\\settings\\page.tsx:42:17\n  40 |\n  41 |             if (savedBranding) {\n> 42 |                 setBranding(JSON.parse(savedBranding));\n     |                 ^^^^^^^^^^^ Avoid calling setState() directly within an effect\n  43 |             }\n  44 |             if (savedTheme) {\n  45 |                 setTheme(JSON.parse(savedTheme));","line":42,"column":17,"nodeType":null,"endLine":42,"endColumn":28},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":312,"column":59,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[14510,14717],"text":"\r\n                                       \r\n                              .   &quot;\"   .\r\n                        "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[14510,14717],"text":"\r\n                                       \r\n                              .   &ldquo;\"   .\r\n                        "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[14510,14717],"text":"\r\n                                       \r\n                              .   &#34;\"   .\r\n                        "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[14510,14717],"text":"\r\n                                       \r\n                              .   &rdquo;\"   .\r\n                        "},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":312,"column":65,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[14510,14717],"text":"\r\n                                       \r\n                              .   \"&quot;   .\r\n                        "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[14510,14717],"text":"\r\n                                       \r\n                              .   \"&ldquo;   .\r\n                        "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[14510,14717],"text":"\r\n                                       \r\n                              .   \"&#34;   .\r\n                        "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[14510,14717],"text":"\r\n                                       \r\n                              .   \"&rdquo;   .\r\n                        "},"desc":"Replace with `&rdquo;`."}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { useState, useEffect } from \"react\";\r\nimport { GlassCard, GlassCardHeader, GlassCardContent } from \"@/components/ui/glass-card\";\r\nimport { GlassButton } from \"@/components/ui/glass-button\";\r\nimport { Building2, Palette, Layout, Save, RotateCcw } from \"lucide-react\";\r\n\r\ninterface BrandingSettings {\r\n    companyName: string;\r\n    companyTagline: string;\r\n    logoText: string;\r\n}\r\n\r\ninterface ThemeSettings {\r\n    primaryColor: string;\r\n    accentColor: string;\r\n}\r\n\r\nconst DEFAULT_BRANDING: BrandingSettings = {\r\n    companyName: \"Shavi Academy OS\",\r\n    companyTagline: \"   \",\r\n    logoText: \"S\",\r\n};\r\n\r\nconst DEFAULT_THEME: ThemeSettings = {\r\n    primaryColor: \"#E60000\", // Vodafone Red\r\n    accentColor: \"#3f3f46\",\r\n};\r\n\r\nexport default function SettingsPage() {\r\n    const [branding, setBranding] = useState<BrandingSettings>(DEFAULT_BRANDING);\r\n    const [theme, setTheme] = useState<ThemeSettings>(DEFAULT_THEME);\r\n    const [hasChanges, setHasChanges] = useState(false);\r\n\r\n    // Load saved settings\r\n    useEffect(() => {\r\n        try {\r\n            const savedBranding = localStorage.getItem(\"app-branding\");\r\n            const savedTheme = localStorage.getItem(\"app-theme\");\r\n\r\n            if (savedBranding) {\r\n                setBranding(JSON.parse(savedBranding));\r\n            }\r\n            if (savedTheme) {\r\n                setTheme(JSON.parse(savedTheme));\r\n            }\r\n        } catch (error) {\r\n            console.error(\"Failed to load settings:\", error);\r\n        }\r\n    }, []);\r\n\r\n    // Apply theme colors\r\n    useEffect(() => {\r\n        document.documentElement.style.setProperty(\"--color-primary\", theme.primaryColor);\r\n        document.documentElement.style.setProperty(\"--color-accent\", theme.accentColor);\r\n    }, [theme]);\r\n\r\n    const handleSave = () => {\r\n        try {\r\n            localStorage.setItem(\"app-branding\", JSON.stringify(branding));\r\n            localStorage.setItem(\"app-theme\", JSON.stringify(theme));\r\n            setHasChanges(false);\r\n\r\n            // Show success message\r\n            alert(\"   ! \");\r\n        } catch (error) {\r\n            console.error(\"Failed to save settings:\", error);\r\n            alert(\"     \");\r\n        }\r\n    };\r\n\r\n    const handleReset = () => {\r\n        if (confirm(\"        \")) {\r\n            setBranding(DEFAULT_BRANDING);\r\n            setTheme(DEFAULT_THEME);\r\n            localStorage.removeItem(\"app-branding\");\r\n            localStorage.removeItem(\"app-theme\");\r\n            setHasChanges(false);\r\n        }\r\n    };\r\n\r\n    const updateBranding = (key: keyof BrandingSettings, value: string) => {\r\n        setBranding(prev => ({ ...prev, [key]: value }));\r\n        setHasChanges(true);\r\n    };\r\n\r\n    const updateTheme = (key: keyof ThemeSettings, value: string) => {\r\n        setTheme(prev => ({ ...prev, [key]: value }));\r\n        setHasChanges(true);\r\n    };\r\n\r\n    return (\r\n        <div className=\"flex flex-col gap-6 p-6 pb-20 md:pb-6\">\r\n            {/* Header */}\r\n            <div>\r\n                <h1 className=\"text-3xl font-bold text-foreground\"> </h1>\r\n                <p className=\"text-muted-foreground mt-2\">\r\n                        \r\n                </p>\r\n            </div>\r\n\r\n            {/* Branding Settings */}\r\n            <GlassCard intensity=\"medium\" hover>\r\n                <GlassCardHeader>\r\n                    <div className=\"flex items-center gap-3\">\r\n                        <div className=\"p-2 bg-primary/10 rounded-lg\">\r\n                            <Building2 className=\"w-5 h-5 text-primary\" />\r\n                        </div>\r\n                        <div>\r\n                            <h2 className=\"text-lg font-semibold\"> </h2>\r\n                            <p className=\"text-sm text-muted-foreground\">\r\n                                   \r\n                            </p>\r\n                        </div>\r\n                    </div>\r\n                </GlassCardHeader>\r\n                <GlassCardContent className=\"space-y-4\">\r\n                    {/* Company Name */}\r\n                    <div>\r\n                        <label className=\"block text-sm font-medium mb-2\">\r\n                             \r\n                        </label>\r\n                        <input\r\n                            type=\"text\"\r\n                            value={branding.companyName}\r\n                            onChange={(e) => updateBranding(\"companyName\", e.target.value)}\r\n                            className=\"w-full px-4 py-2 border rounded-lg bg-background focus:outline-none focus:ring-2 focus:ring-primary\"\r\n                            placeholder=\" \"\r\n                        />\r\n                    </div>\r\n\r\n                    {/* Company Tagline */}\r\n                    <div>\r\n                        <label className=\"block text-sm font-medium mb-2\">\r\n                            \r\n                        </label>\r\n                        <input\r\n                            type=\"text\"\r\n                            value={branding.companyTagline}\r\n                            onChange={(e) => updateBranding(\"companyTagline\", e.target.value)}\r\n                            className=\"w-full px-4 py-2 border rounded-lg bg-background focus:outline-none focus:ring-2 focus:ring-primary\"\r\n                            placeholder=\" \"\r\n                        />\r\n                    </div>\r\n\r\n                    {/* Logo Text */}\r\n                    <div>\r\n                        <label className=\"block text-sm font-medium mb-2\">\r\n                              ( )\r\n                        </label>\r\n                        <input\r\n                            type=\"text\"\r\n                            value={branding.logoText}\r\n                            onChange={(e) => updateBranding(\"logoText\", e.target.value.slice(0, 1))}\r\n                            maxLength={1}\r\n                            className=\"w-20 px-4 py-2 border rounded-lg bg-background focus:outline-none focus:ring-2 focus:ring-primary text-center text-xl font-bold\"\r\n                            placeholder=\"S\"\r\n                        />\r\n                        <p className=\"text-xs text-muted-foreground mt-1\">\r\n                               \r\n                        </p>\r\n                    </div>\r\n\r\n                    {/* Logo Preview */}\r\n                    <div className=\"p-4 bg-accent/50 rounded-lg\">\r\n                        <p className=\"text-sm font-medium mb-3\">:</p>\r\n                        <div className=\"flex items-center gap-3\">\r\n                            <div className=\"w-10 h-10 bg-primary rounded-lg flex items-center justify-center\">\r\n                                <span className=\"text-white font-bold text-xl\">\r\n                                    {branding.logoText || \"S\"}\r\n                                </span>\r\n                            </div>\r\n                            <div>\r\n                                <h3 className=\"text-lg font-bold\">{branding.companyName}</h3>\r\n                                <p className=\"text-xs text-muted-foreground\">\r\n                                    {branding.companyTagline}\r\n                                </p>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </GlassCardContent>\r\n            </GlassCard>\r\n\r\n            {/* Theme Colors */}\r\n            <GlassCard intensity=\"medium\" hover>\r\n                <GlassCardHeader>\r\n                    <div className=\"flex items-center gap-3\">\r\n                        <div className=\"p-2 bg-primary/10 rounded-lg\">\r\n                            <Palette className=\"w-5 h-5 text-primary\" />\r\n                        </div>\r\n                        <div>\r\n                            <h2 className=\"text-lg font-semibold\"> </h2>\r\n                            <p className=\"text-sm text-muted-foreground\">\r\n                                  \r\n                            </p>\r\n                        </div>\r\n                    </div>\r\n                </GlassCardHeader>\r\n                <GlassCardContent className=\"space-y-4\">\r\n                    {/* Primary Color */}\r\n                    <div>\r\n                        <label className=\"block text-sm font-medium mb-2\">\r\n                             \r\n                        </label>\r\n                        <div className=\"flex gap-3 items-center\">\r\n                            <input\r\n                                type=\"color\"\r\n                                value={theme.primaryColor}\r\n                                onChange={(e) => updateTheme(\"primaryColor\", e.target.value)}\r\n                                className=\"w-16 h-12 rounded-lg border cursor-pointer\"\r\n                            />\r\n                            <input\r\n                                type=\"text\"\r\n                                value={theme.primaryColor}\r\n                                onChange={(e) => updateTheme(\"primaryColor\", e.target.value)}\r\n                                className=\"flex-1 px-4 py-2 border rounded-lg bg-background focus:outline-none focus:ring-2 focus:ring-primary font-mono\"\r\n                                placeholder=\"#E60000\"\r\n                            />\r\n                        </div>\r\n                        <p className=\"text-xs text-muted-foreground mt-1\">\r\n                                \r\n                        </p>\r\n                    </div>\r\n\r\n                    {/* Accent Color */}\r\n                    <div>\r\n                        <label className=\"block text-sm font-medium mb-2\">\r\n                             \r\n                        </label>\r\n                        <div className=\"flex gap-3 items-center\">\r\n                            <input\r\n                                type=\"color\"\r\n                                value={theme.accentColor}\r\n                                onChange={(e) => updateTheme(\"accentColor\", e.target.value)}\r\n                                className=\"w-16 h-12 rounded-lg border cursor-pointer\"\r\n                            />\r\n                            <input\r\n                                type=\"text\"\r\n                                value={theme.accentColor}\r\n                                onChange={(e) => updateTheme(\"accentColor\", e.target.value)}\r\n                                className=\"flex-1 px-4 py-2 border rounded-lg bg-background focus:outline-none focus:ring-2 focus:ring-primary font-mono\"\r\n                                placeholder=\"#3f3f46\"\r\n                            />\r\n                        </div>\r\n                        <p className=\"text-xs text-muted-foreground mt-1\">\r\n                              \r\n                        </p>\r\n                    </div>\r\n\r\n                    {/* Color Presets */}\r\n                    <div>\r\n                        <label className=\"block text-sm font-medium mb-3\">\r\n                             \r\n                        </label>\r\n                        <div className=\"grid grid-cols-3 gap-3\">\r\n                            {[\r\n                                { name: \"Vodafone\", primary: \"#E60000\", accent: \"#3f3f46\" },\r\n                                { name: \"Blue\", primary: \"#0066CC\", accent: \"#1e3a8a\" },\r\n                                { name: \"Green\", primary: \"#059669\", accent: \"#064e3b\" },\r\n                                { name: \"Purple\", primary: \"#7c3aed\", accent: \"#4c1d95\" },\r\n                                { name: \"Orange\", primary: \"#ea580c\", accent: \"#7c2d12\" },\r\n                                { name: \"Pink\", primary: \"#db2777\", accent: \"#831843\" },\r\n                            ].map((preset) => (\r\n                                <button\r\n                                    key={preset.name}\r\n                                    onClick={() => {\r\n                                        setTheme({\r\n                                            primaryColor: preset.primary,\r\n                                            accentColor: preset.accent,\r\n                                        });\r\n                                        setHasChanges(true);\r\n                                    }}\r\n                                    className=\"flex flex-col items-center gap-2 p-3 rounded-lg border hover:bg-accent transition-colors\"\r\n                                >\r\n                                    <div className=\"flex gap-1\">\r\n                                        <div\r\n                                            className=\"w-6 h-6 rounded\"\r\n                                            style={{ backgroundColor: preset.primary }}\r\n                                        ></div>\r\n                                        <div\r\n                                            className=\"w-6 h-6 rounded\"\r\n                                            style={{ backgroundColor: preset.accent }}\r\n                                        ></div>\r\n                                    </div>\r\n                                    <span className=\"text-xs font-medium\">{preset.name}</span>\r\n                                </button>\r\n                            ))}\r\n                        </div>\r\n                    </div>\r\n                </GlassCardContent>\r\n            </GlassCard>\r\n\r\n            {/* Layout Presets */}\r\n            <GlassCard intensity=\"light\" hover>\r\n                <GlassCardHeader>\r\n                    <div className=\"flex items-center gap-3\">\r\n                        <div className=\"p-2 bg-primary/10 rounded-lg\">\r\n                            <Layout className=\"w-5 h-5 text-primary\" />\r\n                        </div>\r\n                        <div>\r\n                            <h2 className=\"text-lg font-semibold\">  </h2>\r\n                            <p className=\"text-sm text-muted-foreground\">\r\n                                     \r\n                            </p>\r\n                        </div>\r\n                    </div>\r\n                </GlassCardHeader>\r\n                <GlassCardContent>\r\n                    <div className=\"p-4 bg-accent/50 rounded-lg\">\r\n                        <p className=\"text-sm text-muted-foreground\">\r\n                                       \r\n                              .   \"\"   .\r\n                        </p>\r\n                    </div>\r\n                </GlassCardContent>\r\n            </GlassCard>\r\n\r\n            {/* Action Buttons */}\r\n            <div className=\"flex gap-3 justify-end sticky bottom-20 md:bottom-6 bg-background/80 backdrop-blur-sm p-4 rounded-lg border\">\r\n                <GlassButton\r\n                    variant=\"outline\"\r\n                    onClick={handleReset}\r\n                    className=\"gap-2\"\r\n                >\r\n                    <RotateCcw className=\"w-4 h-4\" />\r\n                     \r\n                </GlassButton>\r\n                <GlassButton\r\n                    variant=\"primary\"\r\n                    onClick={handleSave}\r\n                    disabled={!hasChanges}\r\n                    className=\"gap-2\"\r\n                >\r\n                    <Save className=\"w-4 h-4\" />\r\n                     \r\n                </GlassButton>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\shavi acadimy\\Shavierp\\app\\(dashboard)\\tech-panel\\integrations\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'CheckCircleIcon' is defined but never used.","line":5,"column":40,"nodeType":null,"messageId":"unusedVar","endLine":5,"endColumn":55},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'XCircleIcon' is defined but never used.","line":5,"column":57,"nodeType":null,"messageId":"unusedVar","endLine":5,"endColumn":68},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":8,"column":54,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":8,"endColumn":57,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[333,336],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[333,336],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport { useEffect, useState } from 'react';\r\nimport TechLayout from '@/components/tech-panel/TechLayout';\r\nimport { CubeIcon, PlusIcon, BoltIcon, CheckCircleIcon, XCircleIcon } from '@heroicons/react/24/outline';\r\n\r\nexport default function IntegrationsPage() {\r\n    const [integrations, setIntegrations] = useState<any[]>([]);\r\n    const [loading, setLoading] = useState(true);\r\n\r\n    useEffect(() => {\r\n        fetchIntegrations();\r\n    }, []);\r\n\r\n    async function fetchIntegrations() {\r\n        try {\r\n            const response = await fetch('/api/tech/integrations');\r\n            const data = await response.json();\r\n            setIntegrations(data.integrations || []);\r\n        } catch (error) {\r\n            console.error('Failed to fetch integrations:', error);\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    }\r\n\r\n    return (\r\n        <TechLayout>\r\n            <div className=\"space-y-6\">\r\n                {/* Header */}\r\n                <div className=\"flex items-center justify-between\">\r\n                    <div>\r\n                        <h1 className=\"text-2xl font-bold text-white\">Integrations</h1>\r\n                        <p className=\"text-slate-400 mt-1\">Manage external service integrations</p>\r\n                    </div>\r\n\r\n                    <button className=\"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors flex items-center gap-2\">\r\n                        <PlusIcon className=\"w-5 h-5\" />\r\n                        Add Integration\r\n                    </button>\r\n                </div>\r\n\r\n                {/* Integrations Grid */}\r\n                {loading ? (\r\n                    <div className=\"text-center py-12 text-slate-400\">Loading...</div>\r\n                ) : integrations.length === 0 ? (\r\n                    <div className=\"bg-slate-800/50 border border-slate-700 rounded-lg p-12 text-center\">\r\n                        <CubeIcon className=\"w-16 h-16 text-slate-600 mx-auto mb-4\" />\r\n                        <p className=\"text-slate-400 mb-4\">No integrations found</p>\r\n                        <button className=\"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors\">\r\n                            Add Your First Integration\r\n                        </button>\r\n                    </div>\r\n                ) : (\r\n                    <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\r\n                        {integrations.map((integration) => (\r\n                            <div\r\n                                key={integration.id}\r\n                                className=\"bg-slate-800/50 border border-slate-700 rounded-lg p-6 hover:border-purple-600 transition-colors\"\r\n                            >\r\n                                <div className=\"flex items-start justify-between mb-4\">\r\n                                    <div className=\"flex items-center gap-3\">\r\n                                        <div className=\"w-12 h-12 bg-purple-600/20 rounded-lg flex items-center justify-center\">\r\n                                            <CubeIcon className=\"w-6 h-6 text-purple-500\" />\r\n                                        </div>\r\n                                        <div>\r\n                                            <h3 className=\"font-semibold text-white\">{integration.display_name || integration.name}</h3>\r\n                                            <p className=\"text-xs text-slate-400\">{integration.type}</p>\r\n                                        </div>\r\n                                    </div>\r\n\r\n                                    <div className={`w-3 h-3 rounded-full ${integration.status === 'active' ? 'bg-green-500' :\r\n                                            integration.status === 'testing' ? 'bg-yellow-500' :\r\n                                                'bg-red-500'\r\n                                        }`} />\r\n                                </div>\r\n\r\n                                <div className=\"space-y-2 mb-4\">\r\n                                    <div className=\"flex items-center justify-between text-sm\">\r\n                                        <span className=\"text-slate-400\">Endpoints:</span>\r\n                                        <span className=\"text-white\">{integration.endpoint_count || 0}</span>\r\n                                    </div>\r\n                                    <div className=\"flex items-center justify-between text-sm\">\r\n                                        <span className=\"text-slate-400\">Success:</span>\r\n                                        <span className=\"text-green-400\">{integration.success_count || 0}</span>\r\n                                    </div>\r\n                                    <div className=\"flex items-center justify-between text-sm\">\r\n                                        <span className=\"text-slate-400\">Failed:</span>\r\n                                        <span className=\"text-red-400\">{integration.failed_count || 0}</span>\r\n                                    </div>\r\n                                </div>\r\n\r\n                                <div className=\"pt-4 border-t border-slate-700 flex gap-2\">\r\n                                    <button className=\"flex-1 px-3 py-2 bg-slate-700 text-white text-sm rounded hover:bg-slate-600 transition-colors\">\r\n                                        Configure\r\n                                    </button>\r\n                                    <button className=\"flex-1 px-3 py-2 bg-purple-600 text-white text-sm rounded hover:bg-purple-700 transition-colors flex items-center justify-center gap-1\">\r\n                                        <BoltIcon className=\"w-4 h-4\" />\r\n                                        Test\r\n                                    </button>\r\n                                </div>\r\n                            </div>\r\n                        ))}\r\n                    </div>\r\n                )}\r\n            </div>\r\n        </TechLayout>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\shavi acadimy\\Shavierp\\app\\(dashboard)\\tech-panel\\logs\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":29,"column":40,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":29,"endColumn":43,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[807,810],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[807,810],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'fetchLogs'. Either include it or remove the dependency array.","line":38,"column":8,"nodeType":"ArrayExpression","endLine":38,"endColumn":17,"suggestions":[{"desc":"Update the dependencies array to be: [fetchLogs, filters]","fix":{"range":[1004,1013],"text":"[fetchLogs, filters]"}}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport { useEffect, useState } from 'react';\r\nimport TechLayout from '@/components/tech-panel/TechLayout';\r\nimport {\r\n    FunnelIcon,\r\n    ArrowPathIcon,\r\n    CheckCircleIcon,\r\n    XCircleIcon,\r\n    ClockIcon,\r\n    DocumentArrowDownIcon\r\n} from '@heroicons/react/24/outline';\r\n\r\ninterface LogEntry {\r\n    id: string;\r\n    created_at: string;\r\n    event_type: string;\r\n    status: string;\r\n    duration_ms: number;\r\n    response_status?: number;\r\n    error_message?: string;\r\n    integrations?: { name: string; display_name: string };\r\n    integration_endpoints?: { name: string; event_type: string };\r\n}\r\n\r\nexport default function LogsPage() {\r\n    const [logs, setLogs] = useState<LogEntry[]>([]);\r\n    const [loading, setLoading] = useState(true);\r\n    const [stats, setStats] = useState<any>(null);\r\n    const [filters, setFilters] = useState({\r\n        status: 'all',\r\n        integration_id: 'all',\r\n        limit: 50\r\n    });\r\n\r\n    useEffect(() => {\r\n        fetchLogs();\r\n    }, [filters]);\r\n\r\n    async function fetchLogs() {\r\n        setLoading(true);\r\n        try {\r\n            const params = new URLSearchParams();\r\n            if (filters.status !== 'all') params.set('status', filters.status);\r\n            if (filters.integration_id !== 'all') params.set('integration_id', filters.integration_id);\r\n            params.set('limit', filters.limit.toString());\r\n\r\n            const response = await fetch(`/api/tech/logs?${params}`);\r\n            const data = await response.json();\r\n\r\n            setLogs(data.logs || []);\r\n            setStats(data.stats);\r\n        } catch (error) {\r\n            console.error('Failed to fetch logs:', error);\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    }\r\n\r\n    function getStatusIcon(status: string) {\r\n        switch (status) {\r\n            case 'success':\r\n                return <CheckCircleIcon className=\"w-5 h-5 text-green-500\" />;\r\n            case 'failed':\r\n                return <XCircleIcon className=\"w-5 h-5 text-red-500\" />;\r\n            case 'pending':\r\n                return <ClockIcon className=\"w-5 h-5 text-yellow-500\" />;\r\n            default:\r\n                return <ClockIcon className=\"w-5 h-5 text-slate-500\" />;\r\n        }\r\n    }\r\n\r\n    function formatDuration(ms?: number) {\r\n        if (!ms) return 'N/A';\r\n        if (ms < 1000) return `${ms}ms`;\r\n        return `${(ms / 1000).toFixed(2)}s`;\r\n    }\r\n\r\n    return (\r\n        <TechLayout>\r\n            <div className=\"space-y-6\">\r\n                {/* Header */}\r\n                <div className=\"flex items-center justify-between\">\r\n                    <div>\r\n                        <h1 className=\"text-2xl font-bold text-white\">Logs</h1>\r\n                        <p className=\"text-slate-400 mt-1\">Monitor webhook events and system activity</p>\r\n                    </div>\r\n\r\n                    <div className=\"flex items-center gap-3\">\r\n                        <button\r\n                            onClick={fetchLogs}\r\n                            className=\"px-4 py-2 bg-slate-800 text-white rounded-lg hover:bg-slate-700 transition-colors flex items-center gap-2\"\r\n                        >\r\n                            <ArrowPathIcon className=\"w-4 h-4\" />\r\n                            Refresh\r\n                        </button>\r\n\r\n                        <button className=\"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors flex items-center gap-2\">\r\n                            <DocumentArrowDownIcon className=\"w-4 h-4\" />\r\n                            Export\r\n                        </button>\r\n                    </div>\r\n                </div>\r\n\r\n                {/* Stats Cards */}\r\n                {stats && (\r\n                    <div className=\"grid grid-cols-1 md:grid-cols-5 gap-4\">\r\n                        <div className=\"bg-slate-800/50 border border-slate-700 rounded-lg p-4\">\r\n                            <p className=\"text-sm text-slate-400\">Total</p>\r\n                            <p className=\"text-2xl font-bold text-white mt-1\">{stats.total}</p>\r\n                        </div>\r\n\r\n                        <div className=\"bg-slate-800/50 border border-slate-700 rounded-lg p-4\">\r\n                            <p className=\"text-sm text-slate-400\">Success</p>\r\n                            <p className=\"text-2xl font-bold text-green-400 mt-1\">{stats.success}</p>\r\n                        </div>\r\n\r\n                        <div className=\"bg-slate-800/50 border border-slate-700 rounded-lg p-4\">\r\n                            <p className=\"text-sm text-slate-400\">Failed</p>\r\n                            <p className=\"text-2xl font-bold text-red-400 mt-1\">{stats.failed}</p>\r\n                        </div>\r\n\r\n                        <div className=\"bg-slate-800/50 border border-slate-700 rounded-lg p-4\">\r\n                            <p className=\"text-sm text-slate-400\">Avg Duration</p>\r\n                            <p className=\"text-2xl font-bold text-white mt-1\">{Math.round(stats.avgDuration)}ms</p>\r\n                        </div>\r\n\r\n                        <div className=\"bg-slate-800/50 border border-slate-700 rounded-lg p-4\">\r\n                            <p className=\"text-sm text-slate-400\">Last 24h</p>\r\n                            <p className=\"text-2xl font-bold text-white mt-1\">{stats.last24h}</p>\r\n                        </div>\r\n                    </div>\r\n                )}\r\n\r\n                {/* Filters */}\r\n                <div className=\"bg-slate-800/50 border border-slate-700 rounded-lg p-4\">\r\n                    <div className=\"flex items-center gap-4\">\r\n                        <FunnelIcon className=\"w-5 h-5 text-slate-400\" />\r\n\r\n                        <select\r\n                            value={filters.status}\r\n                            onChange={(e) => setFilters({ ...filters, status: e.target.value })}\r\n                            className=\"px-3 py-2 bg-slate-900 border border-slate-700 rounded-lg text-white text-sm focus:outline-none focus:ring-2 focus:ring-purple-600\"\r\n                        >\r\n                            <option value=\"all\">All Status</option>\r\n                            <option value=\"success\">Success</option>\r\n                            <option value=\"failed\">Failed</option>\r\n                            <option value=\"pending\">Pending</option>\r\n                        </select>\r\n\r\n                        <select\r\n                            value={filters.limit}\r\n                            onChange={(e) => setFilters({ ...filters, limit: parseInt(e.target.value) })}\r\n                            className=\"px-3 py-2 bg-slate-900 border border-slate-700 rounded-lg text-white text-sm focus:outline-none focus:ring-2 focus:ring-purple-600\"\r\n                        >\r\n                            <option value=\"25\">25 logs</option>\r\n                            <option value=\"50\">50 logs</option>\r\n                            <option value=\"100\">100 logs</option>\r\n                            <option value=\"200\">200 logs</option>\r\n                        </select>\r\n                    </div>\r\n                </div>\r\n\r\n                {/* Logs Table */}\r\n                <div className=\"bg-slate-800/50 border border-slate-700 rounded-lg overflow-hidden\">\r\n                    {loading ? (\r\n                        <div className=\"p-12 text-center text-slate-400\">\r\n                            Loading logs...\r\n                        </div>\r\n                    ) : logs.length === 0 ? (\r\n                        <div className=\"p-12 text-center text-slate-400\">\r\n                            No logs found\r\n                        </div>\r\n                    ) : (\r\n                        <div className=\"overflow-x-auto\">\r\n                            <table className=\"w-full\">\r\n                                <thead className=\"bg-slate-900 border-b border-slate-700\">\r\n                                    <tr>\r\n                                        <th className=\"px-4 py-3 text-left text-sm font-medium text-slate-300\">Status</th>\r\n                                        <th className=\"px-4 py-3 text-left text-sm font-medium text-slate-300\">Event Type</th>\r\n                                        <th className=\"px-4 py-3 text-left text-sm font-medium text-slate-300\">Integration</th>\r\n                                        <th className=\"px-4 py-3 text-left text-sm font-medium text-slate-300\">Duration</th>\r\n                                        <th className=\"px-4 py-3 text-left text-sm font-medium text-slate-300\">Response</th>\r\n                                        <th className=\"px-4 py-3 text-left text-sm font-medium text-slate-300\">Time</th>\r\n                                    </tr>\r\n                                </thead>\r\n                                <tbody className=\"divide-y divide-slate-700\">\r\n                                    {logs.map((log) => (\r\n                                        <tr key={log.id} className=\"hover:bg-slate-800/50\">\r\n                                            <td className=\"px-4 py-3\">\r\n                                                <div className=\"flex items-center gap-2\">\r\n                                                    {getStatusIcon(log.status)}\r\n                                                    <span className=\"text-sm text-white capitalize\">{log.status}</span>\r\n                                                </div>\r\n                                            </td>\r\n                                            <td className=\"px-4 py-3\">\r\n                                                <span className=\"text-sm text-white font-mono\">{log.event_type}</span>\r\n                                            </td>\r\n                                            <td className=\"px-4 py-3\">\r\n                                                <span className=\"text-sm text-slate-300\">\r\n                                                    {log.integrations?.display_name || log.integrations?.name || 'N/A'}\r\n                                                </span>\r\n                                            </td>\r\n                                            <td className=\"px-4 py-3\">\r\n                                                <span className=\"text-sm text-slate-300\">{formatDuration(log.duration_ms)}</span>\r\n                                            </td>\r\n                                            <td className=\"px-4 py-3\">\r\n                                                {log.response_status ? (\r\n                                                    <span className={`text-sm ${log.response_status < 400 ? 'text-green-400' : 'text-red-400'}`}>\r\n                                                        {log.response_status}\r\n                                                    </span>\r\n                                                ) : (\r\n                                                    <span className=\"text-sm text-slate-500\">-</span>\r\n                                                )}\r\n                                            </td>\r\n                                            <td className=\"px-4 py-3\">\r\n                                                <span className=\"text-sm text-slate-400\">\r\n                                                    {new Date(log.created_at).toLocaleString()}\r\n                                                </span>\r\n                                            </td>\r\n                                        </tr>\r\n                                    ))}\r\n                                </tbody>\r\n                            </table>\r\n                        </div>\r\n                    )}\r\n                </div>\r\n            </div>\r\n        </TechLayout>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\shavi acadimy\\Shavierp\\app\\(dashboard)\\tech-panel\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\shavi acadimy\\Shavierp\\app\\(dashboard)\\tech-panel\\secrets\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":8,"column":44,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":8,"endColumn":47,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[300,303],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[300,303],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport { useEffect, useState } from 'react';\r\nimport TechLayout from '@/components/tech-panel/TechLayout';\r\nimport { KeyIcon, PlusIcon, EyeIcon, EyeSlashIcon } from '@heroicons/react/24/outline';\r\n\r\nexport default function SecretsPage() {\r\n    const [secrets, setSecrets] = useState<any[]>([]);\r\n    const [loading, setLoading] = useState(true);\r\n    const [revealedSecrets, setRevealedSecrets] = useState<Set<string>>(new Set());\r\n\r\n    useEffect(() => {\r\n        fetchSecrets();\r\n    }, []);\r\n\r\n    async function fetchSecrets() {\r\n        try {\r\n            const response = await fetch('/api/tech/secrets');\r\n            const data = await response.json();\r\n            setSecrets(data.secrets || []);\r\n        } catch (error) {\r\n            console.error('Failed to fetch secrets:', error);\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    }\r\n\r\n    async function toggleReveal(secretId: string) {\r\n        if (revealedSecrets.has(secretId)) {\r\n            // Hide\r\n            setRevealedSecrets(prev => {\r\n                const newSet = new Set(prev);\r\n                newSet.delete(secretId);\r\n                return newSet;\r\n            });\r\n        } else {\r\n            // Reveal - fetch decrypted value\r\n            try {\r\n                const response = await fetch(`/api/tech/secrets/${secretId}/decrypt`, {\r\n                    method: 'POST'\r\n                });\r\n                const data = await response.json();\r\n\r\n                if (data.decrypted_value) {\r\n                    // Store temporarily\r\n                    setRevealedSecrets(prev => new Set(prev).add(secretId));\r\n                    // Auto-hide after 30 seconds\r\n                    setTimeout(() => {\r\n                        setRevealedSecrets(prev => {\r\n                            const newSet = new Set(prev);\r\n                            newSet.delete(secretId);\r\n                            return newSet;\r\n                        });\r\n                    }, 30000);\r\n                }\r\n            } catch (error) {\r\n                console.error('Failed to decrypt secret:', error);\r\n            }\r\n        }\r\n    }\r\n\r\n    return (\r\n        <TechLayout>\r\n            <div className=\"space-y-6\">\r\n                {/* Header */}\r\n                <div className=\"flex items-center justify-between\">\r\n                    <div>\r\n                        <h1 className=\"text-2xl font-bold text-white\">Secrets</h1>\r\n                        <p className=\"text-slate-400 mt-1\">Manage encrypted API keys and secrets</p>\r\n                    </div>\r\n\r\n                    <button className=\"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors flex items-center gap-2\">\r\n                        <PlusIcon className=\"w-5 h-5\" />\r\n                        Add Secret\r\n                    </button>\r\n                </div>\r\n\r\n                {/* Warning */}\r\n                <div className=\"bg-yellow-900/20 border border-yellow-600/30 rounded-lg p-4\">\r\n                    <div className=\"flex gap-3\">\r\n                        <KeyIcon className=\"w-5 h-5 text-yellow-500 flex-shrink-0 mt-0.5\" />\r\n                        <div>\r\n                            <h3 className=\"text-sm font-medium text-yellow-500\">Security Notice</h3>\r\n                            <p className=\"text-sm text-yellow-200/80 mt-1\">\r\n                                All secrets are encrypted using AES-256. Decryption requires special permissions and is logged for audit.\r\n                            </p>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n\r\n                {/* Secrets List */}\r\n                {loading ? (\r\n                    <div className=\"text-center py-12 text-slate-400\">Loading...</div>\r\n                ) : secrets.length === 0 ? (\r\n                    <div className=\"bg-slate-800/50 border border-slate-700 rounded-lg p-12 text-center\">\r\n                        <KeyIcon className=\"w-16 h-16 text-slate-600 mx-auto mb-4\" />\r\n                        <p className=\"text-slate-400 mb-4\">No secrets configured</p>\r\n                        <button className=\"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors\">\r\n                            Add Your First Secret\r\n                        </button>\r\n                    </div>\r\n                ) : (\r\n                    <div className=\"bg-slate-800/50 border border-slate-700 rounded-lg overflow-hidden\">\r\n                        <table className=\"w-full\">\r\n                            <thead className=\"bg-slate-900 border-b border-slate-700\">\r\n                                <tr>\r\n                                    <th className=\"px-4 py-3 text-left text-sm font-medium text-slate-300\">Key Name</th>\r\n                                    <th className=\"px-4 py-3 text-left text-sm font-medium text-slate-300\">Integration</th>\r\n                                    <th className=\"px-4 py-3 text-left text-sm font-medium text-slate-300\">Value</th>\r\n                                    <th className=\"px-4 py-3 text-left text-sm font-medium text-slate-300\">Rotation</th>\r\n                                    <th className=\"px-4 py-3 text-left text-sm font-medium text-slate-300\">Actions</th>\r\n                                </tr>\r\n                            </thead>\r\n                            <tbody className=\"divide-y divide-slate-700\">\r\n                                {secrets.map((secret) => (\r\n                                    <tr key={secret.id} className=\"hover:bg-slate-800/50\">\r\n                                        <td className=\"px-4 py-3\">\r\n                                            <span className=\"text-sm font-mono text-white\">{secret.key_name}</span>\r\n                                        </td>\r\n                                        <td className=\"px-4 py-3\">\r\n                                            <span className=\"text-sm text-slate-300\">\r\n                                                {secret.integrations?.display_name || 'N/A'}\r\n                                            </span>\r\n                                        </td>\r\n                                        <td className=\"px-4 py-3\">\r\n                                            <span className=\"text-sm font-mono text-slate-400\">\r\n                                                {secret.value_masked || '****'}\r\n                                            </span>\r\n                                        </td>\r\n                                        <td className=\"px-4 py-3\">\r\n                                            {secret.rotation_enabled ? (\r\n                                                <span className=\"text-xs bg-green-900/30 text-green-400 px-2 py-1 rounded\">\r\n                                                    Enabled\r\n                                                </span>\r\n                                            ) : (\r\n                                                <span className=\"text-xs bg-slate-700 text-slate-400 px-2 py-1 rounded\">\r\n                                                    Disabled\r\n                                                </span>\r\n                                            )}\r\n                                        </td>\r\n                                        <td className=\"px-4 py-3\">\r\n                                            <button\r\n                                                onClick={() => toggleReveal(secret.id)}\r\n                                                className=\"text-sm text-purple-400 hover:text-purple-300 flex items-center gap-1\"\r\n                                            >\r\n                                                {revealedSecrets.has(secret.id) ? (\r\n                                                    <>\r\n                                                        <EyeSlashIcon className=\"w-4 h-4\" />\r\n                                                        Hide\r\n                                                    </>\r\n                                                ) : (\r\n                                                    <>\r\n                                                        <EyeIcon className=\"w-4 h-4\" />\r\n                                                        Reveal\r\n                                                    </>\r\n                                                )}\r\n                                            </button>\r\n                                        </td>\r\n                                    </tr>\r\n                                ))}\r\n                            </tbody>\r\n                        </table>\r\n                    </div>\r\n                )}\r\n            </div>\r\n        </TechLayout>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\shavi acadimy\\Shavierp\\app\\(dashboard)\\tech-panel\\webhooks\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":9,"column":48,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":9,"endColumn":51,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[351,354],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[351,354],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":11,"column":62,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":11,"endColumn":65,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[476,479],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[476,479],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'result' is defined but never used.","line":29,"column":33,"nodeType":null,"messageId":"unusedVar","endLine":29,"endColumn":39},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":29,"column":41,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":29,"endColumn":44,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[979,982],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[979,982],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport { useEffect, useState } from 'react';\r\nimport TechLayout from '@/components/tech-panel/TechLayout';\r\nimport WebhookTester from '@/components/tech-panel/WebhookTester';\r\nimport { BoltIcon, PlusIcon } from '@heroicons/react/24/outline';\r\n\r\nexport default function WebhooksPage() {\r\n    const [endpoints, setEndpoints] = useState<any[]>([]);\r\n    const [loading, setLoading] = useState(true);\r\n    const [selectedEndpoint, setSelectedEndpoint] = useState<any>(null);\r\n\r\n    useEffect(() => {\r\n        fetchEndpoints();\r\n    }, []);\r\n\r\n    async function fetchEndpoints() {\r\n        try {\r\n            const response = await fetch('/api/tech/endpoints');\r\n            const data = await response.json();\r\n            setEndpoints(data.endpoints || []);\r\n        } catch (error) {\r\n            console.error('Failed to fetch endpoints:', error);\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    }\r\n\r\n    function handleTestComplete(result: any) {\r\n        // Refresh endpoints to get updated test status\r\n        fetchEndpoints();\r\n    }\r\n\r\n    return (\r\n        <TechLayout>\r\n            <div className=\"space-y-6\">\r\n                {/* Header */}\r\n                <div className=\"flex items-center justify-between\">\r\n                    <div>\r\n                        <h1 className=\"text-2xl font-bold text-white\">Webhooks</h1>\r\n                        <p className=\"text-slate-400 mt-1\">\r\n                            Test and manage webhook endpoints\r\n                        </p>\r\n                    </div>\r\n\r\n                    <button className=\"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors flex items-center gap-2\">\r\n                        <PlusIcon className=\"w-5 h-5\" />\r\n                        Add Endpoint\r\n                    </button>\r\n                </div>\r\n\r\n                {/* Content */}\r\n                <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-6\">\r\n                    {/* Endpoints List */}\r\n                    <div className=\"space-y-4\">\r\n                        <h2 className=\"text-lg font-semibold text-white\">Endpoints</h2>\r\n\r\n                        {loading ? (\r\n                            <div className=\"text-center py-8 text-slate-400\">\r\n                                Loading...\r\n                            </div>\r\n                        ) : endpoints.length === 0 ? (\r\n                            <div className=\"bg-slate-800/50 border border-slate-700 rounded-lg p-6 text-center\">\r\n                                <BoltIcon className=\"w-12 h-12 text-slate-600 mx-auto mb-3\" />\r\n                                <p className=\"text-slate-400\">No endpoints found</p>\r\n                                <button className=\"mt-4 text-sm text-purple-400 hover:text-purple-300\">\r\n                                    Add your first endpoint\r\n                                </button>\r\n                            </div>\r\n                        ) : (\r\n                            <div className=\"space-y-2\">\r\n                                {endpoints.map((endpoint) => (\r\n                                    <button\r\n                                        key={endpoint.id}\r\n                                        onClick={() => setSelectedEndpoint(endpoint)}\r\n                                        className={`\r\n                                            w-full text-left p-4 rounded-lg border transition-colors\r\n                                            ${selectedEndpoint?.id === endpoint.id\r\n                                                ? 'bg-purple-600/20 border-purple-600'\r\n                                                : 'bg-slate-800/50 border-slate-700 hover:border-slate-600'\r\n                                            }\r\n                                        `}\r\n                                    >\r\n                                        <div className=\"flex items-start justify-between\">\r\n                                            <div className=\"flex-1\">\r\n                                                <p className=\"font-medium text-white\">{endpoint.name}</p>\r\n                                                <p className=\"text-xs text-slate-400 mt-1 font-mono\">\r\n                                                    {endpoint.event_type}\r\n                                                </p>\r\n                                            </div>\r\n\r\n                                            <div>\r\n                                                {endpoint.last_test_status === 'success' ? (\r\n                                                    <div className=\"w-2 h-2 bg-green-500 rounded-full\" />\r\n                                                ) : endpoint.last_test_status === 'failed' ? (\r\n                                                    <div className=\"w-2 h-2 bg-red-500 rounded-full\" />\r\n                                                ) : (\r\n                                                    <div className=\"w-2 h-2 bg-slate-600 rounded-full\" />\r\n                                                )}\r\n                                            </div>\r\n                                        </div>\r\n\r\n                                        {endpoint.last_tested_at && (\r\n                                            <p className=\"text-xs text-slate-500 mt-2\">\r\n                                                Last tested: {new Date(endpoint.last_tested_at).toLocaleString()}\r\n                                            </p>\r\n                                        )}\r\n                                    </button>\r\n                                ))}\r\n                            </div>\r\n                        )}\r\n                    </div>\r\n\r\n                    {/* Tester Panel */}\r\n                    <div className=\"lg:col-span-2\">\r\n                        {selectedEndpoint ? (\r\n                            <div className=\"bg-slate-800/50 border border-slate-700 rounded-lg p-6\">\r\n                                <WebhookTester\r\n                                    endpoint={selectedEndpoint}\r\n                                    onTestComplete={handleTestComplete}\r\n                                />\r\n                            </div>\r\n                        ) : (\r\n                            <div className=\"bg-slate-800/50 border border-slate-700 rounded-lg p-12 text-center\">\r\n                                <BoltIcon className=\"w-16 h-16 text-slate-600 mx-auto mb-4\" />\r\n                                <p className=\"text-slate-400\">\r\n                                    Select an endpoint to start testing\r\n                                </p>\r\n                            </div>\r\n                        )}\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </TechLayout>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\shavi acadimy\\Shavierp\\app\\(dashboard)\\trainers\\courses\\new\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\shavi acadimy\\Shavierp\\app\\(dashboard)\\trainers\\courses\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":9,"column":44,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":9,"endColumn":47,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[334,337],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[334,337],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport { useEffect, useState } from 'react';\r\nimport { useRouter } from 'next/navigation';\r\nimport { PlusIcon, BookOpenIcon, ClockIcon, CurrencyDollarIcon } from '@heroicons/react/24/outline';\r\n\r\nexport default function CoursesListPage() {\r\n    const router = useRouter();\r\n    const [courses, setCourses] = useState<any[]>([]);\r\n    const [loading, setLoading] = useState(true);\r\n\r\n    useEffect(() => {\r\n        fetchCourses();\r\n    }, []);\r\n\r\n    async function fetchCourses() {\r\n        try {\r\n            const response = await fetch('/api/courses');\r\n            const data = await response.json();\r\n            setCourses(data.courses || []);\r\n        } catch (error) {\r\n            console.error('Failed to fetch courses:', error);\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    }\r\n\r\n    return (\r\n        <div className=\"p-8 space-y-6\">\r\n            <div className=\"flex items-center justify-between\">\r\n                <div>\r\n                    <h1 className=\"text-3xl font-bold text-white\">Course Catalog</h1>\r\n                    <p className=\"text-slate-400 mt-1\">Manage academic programs and curriculum</p>\r\n                </div>\r\n                <button\r\n                    onClick={() => router.push('/trainers/courses/new')}\r\n                    className=\"flex items-center gap-2 px-4 py-2 bg-purple-600 hover:bg-purple-700 text-white rounded-lg transition-colors\"\r\n                >\r\n                    <PlusIcon className=\"w-5 h-5\" />\r\n                    New Course\r\n                </button>\r\n            </div>\r\n\r\n            <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\r\n                {loading ? (\r\n                    <div className=\"col-span-full text-center text-slate-400 py-12\">Loading catalog...</div>\r\n                ) : courses.length === 0 ? (\r\n                    <div className=\"col-span-full text-center text-slate-400 py-12 bg-slate-800/30 rounded-lg border border-slate-700 border-dashed\">\r\n                        No courses found. Create your first one!\r\n                    </div>\r\n                ) : (\r\n                    courses.map((course) => (\r\n                        <div key={course.id} className=\"bg-slate-800/50 border border-slate-700 rounded-lg p-6 hover:border-purple-500/50 transition-colors group\">\r\n                            <div className=\"flex justify-between items-start mb-4\">\r\n                                <div className=\"p-2 bg-purple-500/10 rounded-lg\">\r\n                                    <BookOpenIcon className=\"w-6 h-6 text-purple-400\" />\r\n                                </div>\r\n                                <span className={`px-2 py-1 rounded text-xs font-medium ${course.status === 'active' ? 'bg-green-500/10 text-green-400' : 'bg-slate-500/10 text-slate-400'\r\n                                    }`}>\r\n                                    {course.status.toUpperCase()}\r\n                                </span>\r\n                            </div>\r\n\r\n                            <h3 className=\"text-xl font-bold text-white mb-2\">{course.title}</h3>\r\n                            <p className=\"text-sm text-slate-400 mb-4 line-clamp-2\">{course.description}</p>\r\n\r\n                            <div className=\"space-y-2 border-t border-slate-700 pt-4\">\r\n                                <div className=\"flex items-center justify-between text-sm\">\r\n                                    <span className=\"text-slate-400 flex items-center gap-2\">\r\n                                        <ClockIcon className=\"w-4 h-4\" /> Duration\r\n                                    </span>\r\n                                    <span className=\"text-white\">{course.duration_weeks} Weeks</span>\r\n                                </div>\r\n                                <div className=\"flex items-center justify-between text-sm\">\r\n                                    <span className=\"text-slate-400 flex items-center gap-2\">\r\n                                        <CurrencyDollarIcon className=\"w-4 h-4\" /> Price\r\n                                    </span>\r\n                                    <span className=\"text-white\">${course.price}</span>\r\n                                </div>\r\n                                <div className=\"flex items-center justify-between text-sm\">\r\n                                    <span className=\"text-slate-400\">Level</span>\r\n                                    <span className=\"text-white capitalize\">{course.level}</span>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    ))\r\n                )}\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\shavi acadimy\\Shavierp\\app\\(dashboard)\\trainers\\list\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":9,"column":46,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":9,"endColumn":49,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[313,316],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[313,316],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport { useEffect, useState } from 'react';\r\nimport { useRouter } from 'next/navigation';\r\nimport { PlusIcon, MagnifyingGlassIcon } from '@heroicons/react/24/outline';\r\n\r\nexport default function TrainersListPage() {\r\n    const router = useRouter();\r\n    const [trainers, setTrainers] = useState<any[]>([]);\r\n    const [loading, setLoading] = useState(true);\r\n    const [searchTerm, setSearchTerm] = useState('');\r\n\r\n    useEffect(() => {\r\n        fetchTrainers();\r\n    }, []);\r\n\r\n    async function fetchTrainers() {\r\n        try {\r\n            const response = await fetch('/api/trainers');\r\n            if (response.ok) {\r\n                const data = await response.json();\r\n                setTrainers(data.trainers || []);\r\n            }\r\n        } catch (error) {\r\n            console.error('Failed to fetch trainers:', error);\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    }\r\n\r\n    const filteredTrainers = trainers.filter(t =>\r\n        t.full_name?.toLowerCase().includes(searchTerm.toLowerCase()) ||\r\n        t.email?.toLowerCase().includes(searchTerm.toLowerCase())\r\n    );\r\n\r\n    return (\r\n        <div className=\"p-8 space-y-6\">\r\n            <div className=\"flex items-center justify-between\">\r\n                <div>\r\n                    <h1 className=\"text-3xl font-bold text-white\">Trainers Directory</h1>\r\n                    <p className=\"text-slate-400 mt-1\">Manage all academic staff</p>\r\n                </div>\r\n                <button\r\n                    onClick={() => router.push('/trainers/new')}\r\n                    className=\"flex items-center gap-2 px-4 py-2 bg-purple-600 hover:bg-purple-700 text-white rounded-lg transition-colors\"\r\n                >\r\n                    <PlusIcon className=\"w-5 h-5\" />\r\n                    Add Trainer\r\n                </button>\r\n            </div>\r\n\r\n            {/* Search */}\r\n            <div className=\"relative max-w-md\">\r\n                <MagnifyingGlassIcon className=\"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-slate-400\" />\r\n                <input\r\n                    type=\"text\"\r\n                    placeholder=\"Search by name or email...\"\r\n                    value={searchTerm}\r\n                    onChange={(e) => setSearchTerm(e.target.value)}\r\n                    className=\"w-full pl-10 pr-4 py-2 bg-slate-800 border border-slate-700 rounded-lg text-white focus:outline-none focus:border-purple-600 transition-colors\"\r\n                />\r\n            </div>\r\n\r\n            {/* List */}\r\n            <div className=\"bg-slate-800/50 border border-slate-700 rounded-lg overflow-hidden\">\r\n                <table className=\"w-full text-left\">\r\n                    <thead className=\"bg-slate-800\">\r\n                        <tr>\r\n                            <th className=\"p-4 text-sm font-medium text-slate-300\">Name</th>\r\n                            <th className=\"p-4 text-sm font-medium text-slate-300\">Email</th>\r\n                            <th className=\"p-4 text-sm font-medium text-slate-300\">Specialties</th>\r\n                            <th className=\"p-4 text-sm font-medium text-slate-300\">Status</th>\r\n                            <th className=\"p-4 text-sm font-medium text-slate-300\">Rating</th>\r\n                        </tr>\r\n                    </thead>\r\n                    <tbody className=\"divide-y divide-slate-700\">\r\n                        {loading ? (\r\n                            <tr><td colSpan={5} className=\"p-8 text-center text-slate-400\">Loading...</td></tr>\r\n                        ) : filteredTrainers.length === 0 ? (\r\n                            <tr><td colSpan={5} className=\"p-8 text-center text-slate-400\">No trainers found.</td></tr>\r\n                        ) : (\r\n                            filteredTrainers.map((trainer) => (\r\n                                <tr\r\n                                    key={trainer.id}\r\n                                    onClick={() => router.push(`/trainers/${trainer.id}`)}\r\n                                    className=\"hover:bg-slate-700/50 cursor-pointer transition-colors\"\r\n                                >\r\n                                    <td className=\"p-4\">\r\n                                        <div className=\"font-medium text-white\">{trainer.full_name}</div>\r\n                                    </td>\r\n                                    <td className=\"p-4 text-slate-300\">{trainer.email}</td>\r\n                                    <td className=\"p-4\">\r\n                                        <div className=\"flex flex-wrap gap-1\">\r\n                                            {trainer.specialties?.map((tag: string, i: number) => (\r\n                                                <span key={i} className=\"px-2 py-0.5 bg-slate-700 rounded text-xs text-slate-300\">\r\n                                                    {tag}\r\n                                                </span>\r\n                                            ))}\r\n                                        </div>\r\n                                    </td>\r\n                                    <td className=\"p-4\">\r\n                                        <span className={`px-2 py-1 rounded-full text-xs font-medium ${trainer.status === 'active' ? 'bg-green-500/10 text-green-500' :\r\n                                                'bg-slate-500/10 text-slate-500'\r\n                                            }`}>\r\n                                            {trainer.status.toUpperCase()}\r\n                                        </span>\r\n                                    </td>\r\n                                    <td className=\"p-4 text-slate-300\">\r\n                                        {trainer.rating ? ` ${trainer.rating}` : '-'}\r\n                                    </td>\r\n                                </tr>\r\n                            ))\r\n                        )}\r\n                    </tbody>\r\n                </table>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\shavi acadimy\\Shavierp\\app\\(dashboard)\\trainers\\new\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\shavi acadimy\\Shavierp\\app\\(dashboard)\\trainers\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":14,"column":40,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":14,"endColumn":43,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[354,357],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[354,357],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport { useEffect, useState } from 'react';\r\nimport { useRouter } from 'next/navigation';\r\nimport {\r\n    UsersIcon,\r\n    BookOpenIcon,\r\n    CalendarIcon,\r\n    AcademicCapIcon\r\n} from '@heroicons/react/24/outline';\r\n\r\nexport default function TrainersDashboard() {\r\n    const router = useRouter();\r\n    const [stats, setStats] = useState<any>(null);\r\n    const [loading, setLoading] = useState(true);\r\n\r\n    useEffect(() => {\r\n        fetchStats();\r\n    }, []);\r\n\r\n    async function fetchStats() {\r\n        try {\r\n            const response = await fetch('/api/trainers/stats');\r\n            if (response.ok) {\r\n                const data = await response.json();\r\n                setStats(data);\r\n            }\r\n        } catch (error) {\r\n            console.error('Failed to fetch stats:', error);\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    }\r\n\r\n    if (loading) {\r\n        return <div className=\"p-8 text-white\">Loading dashboard...</div>;\r\n    }\r\n\r\n    const cards = [\r\n        { title: 'Active Trainers', value: stats?.activeTrainers || 0, icon: UsersIcon, color: 'text-blue-500', link: '/trainers/list' },\r\n        { title: 'Active Courses', value: stats?.activeCourses || 0, icon: BookOpenIcon, color: 'text-purple-500', link: '/trainers/courses' },\r\n        { title: 'Active Cohorts', value: stats?.activeBatches || 0, icon: AcademicCapIcon, color: 'text-green-500', link: '/trainers/batches' },\r\n        { title: 'Scheduled Sessions', value: stats?.scheduledSessions || 0, icon: CalendarIcon, color: 'text-yellow-500', link: '/trainers/schedule' },\r\n    ];\r\n\r\n    return (\r\n        <div className=\"p-8 space-y-8\">\r\n            <div>\r\n                <h1 className=\"text-3xl font-bold text-white\">Trainers Dashboard</h1>\r\n                <p className=\"text-slate-400 mt-2\">Manage academic staff and schedules</p>\r\n            </div>\r\n\r\n            {/* Stats Grid */}\r\n            <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6\">\r\n                {cards.map((card, index) => (\r\n                    <div\r\n                        key={index}\r\n                        onClick={() => router.push(card.link)}\r\n                        className=\"bg-slate-800/50 border border-slate-700 rounded-lg p-6 cursor-pointer hover:border-purple-600 transition-colors\"\r\n                    >\r\n                        <div className=\"flex items-center justify-between\">\r\n                            <div>\r\n                                <p className=\"text-sm text-slate-400\">{card.title}</p>\r\n                                <p className=\"text-3xl font-bold text-white mt-2\">{card.value}</p>\r\n                            </div>\r\n                            <card.icon className={`w-12 h-12 ${card.color}`} />\r\n                        </div>\r\n                    </div>\r\n                ))}\r\n            </div>\r\n\r\n            {/* Quick Actions */}\r\n            <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6\">\r\n                <button\r\n                    onClick={() => router.push('/trainers/new')}\r\n                    className=\"p-4 bg-purple-600/20 border border-purple-600/50 rounded-lg text-purple-200 hover:bg-purple-600 hover:text-white transition-colors text-left\"\r\n                >\r\n                    + Add New Trainer\r\n                </button>\r\n                <button\r\n                    onClick={() => router.push('/trainers/courses/new')}\r\n                    className=\"p-4 bg-slate-800 border border-slate-700 rounded-lg text-slate-300 hover:bg-slate-700 transition-colors text-left\"\r\n                >\r\n                    + Create Course\r\n                </button>\r\n                <button\r\n                    onClick={() => router.push('/trainers/schedule/new')}\r\n                    className=\"p-4 bg-slate-800 border border-slate-700 rounded-lg text-slate-300 hover:bg-slate-700 transition-colors text-left\"\r\n                >\r\n                    + Schedule Session\r\n                </button>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\shavi acadimy\\Shavierp\\app\\(dashboard)\\trainers\\schedule\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'setDate' is assigned a value but never used.","line":14,"column":18,"nodeType":null,"messageId":"unusedVar","endLine":14,"endColumn":25},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":62,"column":46,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":62,"endColumn":49,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2968,2971],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2968,2971],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/ban-ts-comment","severity":2,"message":"Use \"@ts-expect-error\" instead of \"@ts-ignore\", as \"@ts-ignore\" will do nothing if the following line is error-free.","line":69,"column":5,"nodeType":"Line","messageId":"tsIgnoreInsteadOfExpectError","endLine":69,"endColumn":18,"suggestions":[{"messageId":"replaceTsIgnoreWithTsExpectError","fix":{"range":[3172,3185],"text":"// @ts-expect-error"},"desc":"Replace \"@ts-ignore\" with \"@ts-expect-error\"."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport { useState } from 'react';\r\nimport { ChevronLeftIcon, ChevronRightIcon } from '@heroicons/react/24/solid';\r\n\r\n// Mock schedule data for MVP visualization\r\nconst MOCK_SESSIONS = [\r\n    { id: 1, title: 'React Basics', time: '10:00 AM', duration: '2h', trainer: 'Sarah Wilson', type: 'lecture' },\r\n    { id: 2, title: 'UI Design Workshop', time: '02:00 PM', duration: '2h', trainer: 'Mike Chen', type: 'workshop' },\r\n    { id: 3, title: 'Project Review', time: '04:30 PM', duration: '1h', trainer: 'Alex Johnson', type: 'review' }\r\n];\r\n\r\nexport default function SchedulePage() {\r\n    const [date, setDate] = useState(new Date());\r\n\r\n    return (\r\n        <div className=\"p-8 space-y-8\">\r\n            <div className=\"flex items-center justify-between\">\r\n                <div>\r\n                    <h1 className=\"text-3xl font-bold text-white\">Class Schedule</h1>\r\n                    <p className=\"text-slate-400 mt-1\">Daily academic calendar</p>\r\n                </div>\r\n                <div className=\"flex gap-2\">\r\n                    <button className=\"p-2 hover:bg-slate-700 rounded-lg text-slate-400 hover:text-white\">\r\n                        <ChevronLeftIcon className=\"w-5 h-5\" />\r\n                    </button>\r\n                    <div className=\"px-4 py-2 bg-slate-800 rounded-lg text-white font-medium\">\r\n                        {date.toLocaleDateString('en-US', { weekday: 'long', month: 'long', day: 'numeric' })}\r\n                    </div>\r\n                    <button className=\"p-2 hover:bg-slate-700 rounded-lg text-slate-400 hover:text-white\">\r\n                        <ChevronRightIcon className=\"w-5 h-5\" />\r\n                    </button>\r\n                </div>\r\n            </div>\r\n\r\n            {/* Time Grid (MVP) */}\r\n            <div className=\"bg-slate-800/50 border border-slate-700 rounded-lg divide-y divide-slate-700\">\r\n                {/* Morning Block */}\r\n                <div className=\"p-4\">\r\n                    <h3 className=\"text-sm font-semibold text-slate-500 uppercase tracking-wider mb-4\">Morning</h3>\r\n                    <div className=\"space-y-4\">\r\n                        {MOCK_SESSIONS.filter(s => s.time.includes('AM')).map(session => (\r\n                            <SessionCard key={session.id} session={session} />\r\n                        ))}\r\n                    </div>\r\n                </div>\r\n\r\n                {/* Afternoon Block */}\r\n                <div className=\"p-4\">\r\n                    <h3 className=\"text-sm font-semibold text-slate-500 uppercase tracking-wider mb-4\">Afternoon</h3>\r\n                    <div className=\"space-y-4\">\r\n                        {MOCK_SESSIONS.filter(s => s.time.includes('PM')).map(session => (\r\n                            <SessionCard key={session.id} session={session} />\r\n                        ))}\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n\r\nfunction SessionCard({ session }: { session: any }) {\r\n    const colors = {\r\n        lecture: 'border-blue-500 text-blue-400',\r\n        workshop: 'border-purple-500 text-purple-400',\r\n        review: 'border-green-500 text-green-400'\r\n    };\r\n\r\n    // @ts-ignore\r\n    const accent = colors[session.type] || 'border-slate-500';\r\n\r\n    return (\r\n        <div className={`p-4 bg-slate-800 rounded-lg border-l-4 ${accent} flex justify-between items-center`}>\r\n            <div>\r\n                <h4 className=\"text-white font-medium\">{session.title}</h4>\r\n                <p className=\"text-sm text-slate-400\">with {session.trainer}</p>\r\n            </div>\r\n            <div className=\"text-right\">\r\n                <div className=\"text-white font-bold\">{session.time}</div>\r\n                <div className=\"text-xs text-slate-500\">{session.duration}</div>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\shavi acadimy\\Shavierp\\app\\api\\auth\\login\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\shavi acadimy\\Shavierp\\app\\api\\auth\\logout\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\shavi acadimy\\Shavierp\\app\\api\\courses\\route.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":51,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":51,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1549,1552],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1549,1552],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { NextResponse } from 'next/server';\r\nimport { createClient } from '@supabase/supabase-js';\r\nimport { getSession } from '@/lib/auth';\r\n\r\nconst supabase = createClient(\r\n    process.env.NEXT_PUBLIC_SUPABASE_URL!,\r\n    process.env.SUPABASE_SERVICE_ROLE_KEY!\r\n);\r\n\r\nexport async function GET(request: Request) {\r\n    const session = await getSession();\r\n    if (!session) return NextResponse.json({ error: 'Unauthorized' }, { status: 401 });\r\n\r\n    const { searchParams } = new URL(request.url);\r\n    const status = searchParams.get('status');\r\n\r\n    let query = supabase.from('courses').select('*').order('title', { ascending: true });\r\n\r\n    if (status && status !== 'all') {\r\n        query = query.eq('status', status);\r\n    }\r\n\r\n    const { data, error } = await query;\r\n\r\n    if (error) {\r\n        return NextResponse.json({ error: error.message }, { status: 500 });\r\n    }\r\n\r\n    return NextResponse.json({ courses: data });\r\n}\r\n\r\nexport async function POST(request: Request) {\r\n    const session = await getSession();\r\n    if (!session) return NextResponse.json({ error: 'Unauthorized' }, { status: 401 });\r\n\r\n    try {\r\n        const body = await request.json();\r\n\r\n        const { data, error } = await supabase\r\n            .from('courses')\r\n            .insert({\r\n                ...body,\r\n                updated_at: new Date().toISOString()\r\n            })\r\n            .select()\r\n            .single();\r\n\r\n        if (error) throw error;\r\n\r\n        return NextResponse.json({ course: data }, { status: 201 });\r\n    } catch (error: any) {\r\n        console.error('Error creating course:', error);\r\n        return NextResponse.json({ error: error.message }, { status: 500 });\r\n    }\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\shavi acadimy\\Shavierp\\app\\api\\customer-success\\stats\\route.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'request' is defined but never used.","line":8,"column":27,"nodeType":null,"messageId":"unusedVar","endLine":8,"endColumn":34}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { NextRequest, NextResponse } from 'next/server';\r\nimport { createClient } from '@/lib/supabase/server';\r\n\r\n/**\r\n * GET /api/customer-success/stats\r\n * Customer Success statistics\r\n */\r\nexport async function GET(request: NextRequest) {\r\n    try {\r\n        const supabase = createClient();\r\n\r\n        const { data: { user } } = await supabase.auth.getUser();\r\n        if (!user) {\r\n            return NextResponse.json({ error: 'Unauthorized' }, { status: 401 });\r\n        }\r\n\r\n        // Get overview stats\r\n        const { data: overview } = await supabase\r\n            .from('cs_overview')\r\n            .select('*')\r\n            .single();\r\n\r\n        // Get support metrics\r\n        const { data: support } = await supabase\r\n            .from('support_metrics')\r\n            .select('*')\r\n            .single();\r\n\r\n        // Get NPS\r\n        const { data: nps } = await supabase\r\n            .from('nps_score')\r\n            .select('*')\r\n            .single();\r\n\r\n        return NextResponse.json({\r\n            overview: overview || {},\r\n            support: support || {},\r\n            nps: nps || { nps_score: 0 }\r\n        });\r\n\r\n    } catch (error) {\r\n        console.error('[CS Stats API] Error:', error);\r\n        return NextResponse.json({ error: 'Failed to fetch stats' }, { status: 500 });\r\n    }\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\shavi acadimy\\Shavierp\\app\\api\\customer-success\\students\\route.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":40,"column":65,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":40,"endColumn":68,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1542,1545],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1542,1545],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":100,"column":26,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":100,"endColumn":29,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3402,3405],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3402,3405],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { NextRequest, NextResponse } from 'next/server';\r\nimport { createClient } from '@/lib/supabase/server';\r\n\r\n/**\r\n * GET /api/customer-success/students\r\n * List all students with filtering\r\n */\r\nexport async function GET(request: NextRequest) {\r\n    try {\r\n        const supabase = createClient();\r\n\r\n        const { data: { user } } = await supabase.auth.getUser();\r\n        if (!user) {\r\n            return NextResponse.json({ error: 'Unauthorized' }, { status: 401 });\r\n        }\r\n\r\n        const { searchParams } = new URL(request.url);\r\n        const status = searchParams.get('status');\r\n        const specialist_id = searchParams.get('specialist_id');\r\n        const search = searchParams.get('search');\r\n        const limit = parseInt(searchParams.get('limit') || '50');\r\n        const offset = parseInt(searchParams.get('offset') || '0');\r\n\r\n        let query = supabase\r\n            .from('students')\r\n            .select(`\r\n                *,\r\n                specialist:auth.users!students_success_specialist_id_fkey (id, email)\r\n            `, { count: 'exact' });\r\n\r\n        if (status) query = query.eq('status', status);\r\n        if (specialist_id) query = query.eq('success_specialist_id', specialist_id);\r\n        if (search) {\r\n            query = query.or(`full_name.ilike.%${search}%,email.ilike.%${search}%`);\r\n        }\r\n\r\n        query = query.order('created_at', { ascending: false });\r\n        query = query.range(offset, offset + limit - 1);\r\n\r\n        const { data: students, error, count } = await query as any;\r\n\r\n        if (error) throw error;\r\n\r\n        return NextResponse.json({\r\n            students,\r\n            pagination: {\r\n                total: count || 0,\r\n                limit,\r\n                offset,\r\n                hasMore: (count || 0) > offset + limit\r\n            }\r\n        });\r\n\r\n    } catch (error) {\r\n        console.error('[CS Students API] Error:', error);\r\n        return NextResponse.json({ error: 'Failed to fetch students' }, { status: 500 });\r\n    }\r\n}\r\n\r\n/**\r\n * POST /api/customer-success/students\r\n * Create new student\r\n */\r\nexport async function POST(request: NextRequest) {\r\n    try {\r\n        const supabase = createClient();\r\n\r\n        const { data: { user } } = await supabase.auth.getUser();\r\n        if (!user) {\r\n            return NextResponse.json({ error: 'Unauthorized' }, { status: 401 });\r\n        }\r\n\r\n        const body = await request.json();\r\n        const { full_name, email, phone, program, cohort, nazmly_student_id } = body;\r\n\r\n        if (!full_name || !email) {\r\n            return NextResponse.json(\r\n                { error: 'full_name and email are required' },\r\n                { status: 400 }\r\n            );\r\n        }\r\n\r\n        const { data: student, error } = await supabase\r\n            .from('students')\r\n            .insert({\r\n                full_name,\r\n                email,\r\n                phone: phone || null,\r\n                program: program || null,\r\n                cohort: cohort || null,\r\n                nazmly_student_id: nazmly_student_id || null,\r\n                status: 'active',\r\n                success_specialist_id: user.id,\r\n                assigned_at: new Date().toISOString()\r\n            })\r\n            .select(`\r\n                *,\r\n                specialist:auth.users!students_success_specialist_id_fkey (id, email)\r\n            `)\r\n            .single() as any;\r\n\r\n        if (error) throw error;\r\n\r\n        // Create interaction\r\n        await supabase.from('student_interactions').insert({\r\n            student_id: student.id,\r\n            interaction_type: 'enrollment',\r\n            title: 'Student enrolled',\r\n            description: `Student enrolled by ${user.email}`,\r\n            created_by: user.id\r\n        });\r\n\r\n        return NextResponse.json({ student }, { status: 201 });\r\n\r\n    } catch (error) {\r\n        console.error('[CS Students API] Error creating:', error);\r\n        return NextResponse.json({ error: 'Failed to create student' }, { status: 500 });\r\n    }\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\shavi acadimy\\Shavierp\\app\\api\\customer-success\\tickets\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\shavi acadimy\\Shavierp\\app\\api\\finance\\expenses\\route.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'request' is defined but never used.","line":10,"column":27,"nodeType":null,"messageId":"unusedVar","endLine":10,"endColumn":34},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":43,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":43,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1417,1420],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1417,1420],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { NextResponse } from 'next/server';\r\nimport { createClient } from '@supabase/supabase-js';\r\nimport { getSession } from '@/lib/auth';\r\n\r\nconst supabase = createClient(\r\n    process.env.NEXT_PUBLIC_SUPABASE_URL!,\r\n    process.env.SUPABASE_SERVICE_ROLE_KEY!\r\n);\r\n\r\nexport async function GET(request: Request) {\r\n    const session = await getSession();\r\n    if (!session) return NextResponse.json({ error: 'Unauthorized' }, { status: 401 });\r\n\r\n    const { data, error } = await supabase\r\n        .from('expenses')\r\n        .select('*')\r\n        .order('expense_date', { ascending: false });\r\n\r\n    if (error) return NextResponse.json({ error: error.message }, { status: 500 });\r\n    return NextResponse.json({ expenses: data });\r\n}\r\n\r\nexport async function POST(request: Request) {\r\n    const session = await getSession();\r\n    if (!session) return NextResponse.json({ error: 'Unauthorized' }, { status: 401 });\r\n\r\n    try {\r\n        const body = await request.json();\r\n\r\n        const { data, error } = await supabase\r\n            .from('expenses')\r\n            .insert({\r\n                ...body,\r\n                status: 'pending', // Default to pending approval\r\n                updated_at: new Date().toISOString()\r\n            })\r\n            .select()\r\n            .single();\r\n\r\n        if (error) throw error;\r\n\r\n        return NextResponse.json({ expense: data }, { status: 201 });\r\n    } catch (error: any) {\r\n        return NextResponse.json({ error: error.message }, { status: 500 });\r\n    }\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\shavi acadimy\\Shavierp\\app\\api\\finance\\invoices\\route.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":55,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":55,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1829,1832],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1829,1832],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { NextResponse } from 'next/server';\r\nimport { createClient } from '@supabase/supabase-js';\r\nimport { getSession } from '@/lib/auth';\r\n\r\nconst supabase = createClient(\r\n    process.env.NEXT_PUBLIC_SUPABASE_URL!,\r\n    process.env.SUPABASE_SERVICE_ROLE_KEY!\r\n);\r\n\r\nexport async function GET(request: Request) {\r\n    const session = await getSession();\r\n    if (!session) return NextResponse.json({ error: 'Unauthorized' }, { status: 401 });\r\n\r\n    const { searchParams } = new URL(request.url);\r\n    const status = searchParams.get('status');\r\n\r\n    let query = supabase.from('invoices').select('*, student:students(full_name, email)').order('created_at', { ascending: false });\r\n\r\n    if (status && status !== 'all') {\r\n        query = query.eq('status', status);\r\n    }\r\n\r\n    const { data, error } = await query;\r\n\r\n    if (error) {\r\n        return NextResponse.json({ error: error.message }, { status: 500 });\r\n    }\r\n\r\n    return NextResponse.json({ invoices: data });\r\n}\r\n\r\nexport async function POST(request: Request) {\r\n    const session = await getSession();\r\n    if (!session) return NextResponse.json({ error: 'Unauthorized' }, { status: 401 });\r\n\r\n    try {\r\n        const body = await request.json();\r\n\r\n        // Auto-generate invoice number if not provided (simple logic)\r\n        const invoice_number = body.invoice_number || `INV-${new Date().getFullYear()}-${Math.floor(Math.random() * 10000)}`;\r\n\r\n        const { data, error } = await supabase\r\n            .from('invoices')\r\n            .insert({\r\n                ...body,\r\n                invoice_number,\r\n                updated_at: new Date().toISOString()\r\n            })\r\n            .select()\r\n            .single();\r\n\r\n        if (error) throw error;\r\n\r\n        return NextResponse.json({ invoice: data }, { status: 201 });\r\n    } catch (error: any) {\r\n        console.error('Error creating invoice:', error);\r\n        return NextResponse.json({ error: error.message }, { status: 500 });\r\n    }\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\shavi acadimy\\Shavierp\\app\\api\\finance\\stats\\route.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":50,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":50,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1687,1690],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1687,1690],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { NextResponse } from 'next/server';\r\nimport { createClient } from '@supabase/supabase-js';\r\nimport { getSession } from '@/lib/auth';\r\n\r\nconst supabase = createClient(\r\n    process.env.NEXT_PUBLIC_SUPABASE_URL!,\r\n    process.env.SUPABASE_SERVICE_ROLE_KEY!\r\n);\r\n\r\nexport async function GET() {\r\n    const session = await getSession();\r\n    if (!session) return NextResponse.json({ error: 'Unauthorized' }, { status: 401 });\r\n\r\n    try {\r\n        // Fetch financial data (basic aggregation)\r\n        // In a real app with large data, we'd use a View or RPC function\r\n\r\n        const { data: invoices } = await supabase.from('invoices').select('amount, status');\r\n        const { data: expenses } = await supabase.from('expenses').select('amount, status').eq('status', 'paid'); // Only count paid expenses for cash flow\r\n\r\n        let totalRevenue = 0;\r\n        let pendingInvoices = 0;\r\n        let totalExpenses = 0;\r\n\r\n        if (invoices) {\r\n            invoices.forEach(inv => {\r\n                const amt = Number(inv.amount || 0);\r\n                if (inv.status === 'paid') {\r\n                    totalRevenue += amt;\r\n                } else if (['sent', 'overdue'].includes(inv.status)) {\r\n                    pendingInvoices += amt;\r\n                }\r\n            });\r\n        }\r\n\r\n        if (expenses) {\r\n            expenses.forEach(exp => {\r\n                totalExpenses += Number(exp.amount || 0);\r\n            });\r\n        }\r\n\r\n        const netProfit = totalRevenue - totalExpenses;\r\n\r\n        return NextResponse.json({\r\n            totalRevenue,\r\n            pendingInvoices,\r\n            totalExpenses,\r\n            netProfit\r\n        });\r\n    } catch (error: any) {\r\n        return NextResponse.json({ error: error.message }, { status: 500 });\r\n    }\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\shavi acadimy\\Shavierp\\app\\api\\hr\\employees\\route.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":55,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":55,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1717,1720],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1717,1720],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { NextResponse } from 'next/server';\r\nimport { createClient } from '@supabase/supabase-js';\r\nimport { getSession } from '@/lib/auth';\r\n\r\nconst supabase = createClient(\r\n    process.env.NEXT_PUBLIC_SUPABASE_URL!,\r\n    process.env.SUPABASE_SERVICE_ROLE_KEY!\r\n);\r\n\r\nexport async function GET(request: Request) {\r\n    const session = await getSession();\r\n    if (!session) return NextResponse.json({ error: 'Unauthorized' }, { status: 401 });\r\n\r\n    const { searchParams } = new URL(request.url);\r\n    const dept = searchParams.get('department');\r\n    const search = searchParams.get('search');\r\n\r\n    let query = supabase.from('employees').select('*').order('full_name', { ascending: true });\r\n\r\n    if (dept && dept !== 'all') {\r\n        query = query.eq('department', dept);\r\n    }\r\n    if (search) {\r\n        query = query.or(`full_name.ilike.%${search}%,email.ilike.%${search}%`);\r\n    }\r\n\r\n    const { data, error } = await query;\r\n\r\n    if (error) {\r\n        return NextResponse.json({ error: error.message }, { status: 500 });\r\n    }\r\n\r\n    return NextResponse.json({ employees: data });\r\n}\r\n\r\nexport async function POST(request: Request) {\r\n    const session = await getSession();\r\n    if (!session) return NextResponse.json({ error: 'Unauthorized' }, { status: 401 });\r\n\r\n    try {\r\n        const body = await request.json();\r\n\r\n        const { data, error } = await supabase\r\n            .from('employees')\r\n            .insert({\r\n                ...body,\r\n                updated_at: new Date().toISOString()\r\n            })\r\n            .select()\r\n            .single();\r\n\r\n        if (error) throw error;\r\n\r\n        return NextResponse.json({ employee: data }, { status: 201 });\r\n    } catch (error: any) {\r\n        console.error('Error creating employee:', error);\r\n        return NextResponse.json({ error: error.message }, { status: 500 });\r\n    }\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\shavi acadimy\\Shavierp\\app\\api\\hr\\leave\\route.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'request' is defined but never used.","line":10,"column":27,"nodeType":null,"messageId":"unusedVar","endLine":10,"endColumn":34},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":38,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":38,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1408,1411],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1408,1411],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { NextResponse } from 'next/server';\r\nimport { createClient } from '@supabase/supabase-js';\r\nimport { getSession } from '@/lib/auth';\r\n\r\nconst supabase = createClient(\r\n    process.env.NEXT_PUBLIC_SUPABASE_URL!,\r\n    process.env.SUPABASE_SERVICE_ROLE_KEY!\r\n);\r\n\r\nexport async function GET(request: Request) {\r\n    const session = await getSession();\r\n    if (!session) return NextResponse.json({ error: 'Unauthorized' }, { status: 401 });\r\n\r\n    const { data, error } = await supabase\r\n        .from('leave_requests')\r\n        .select(`*, employee:employees(full_name, email)`)\r\n        .order('created_at', { ascending: false });\r\n\r\n    if (error) return NextResponse.json({ error: error.message }, { status: 500 });\r\n    return NextResponse.json({ requests: data });\r\n}\r\n\r\nexport async function POST(request: Request) {\r\n    const session = await getSession();\r\n    if (!session) return NextResponse.json({ error: 'Unauthorized' }, { status: 401 });\r\n\r\n    try {\r\n        const body = await request.json();\r\n        // MVP: Auto-approve for demo purposes if not specified\r\n        const { data, error } = await supabase\r\n            .from('leave_requests')\r\n            .insert({ ...body, status: body.status || 'pending' })\r\n            .select()\r\n            .single();\r\n\r\n        if (error) throw error;\r\n        return NextResponse.json({ request: data }, { status: 201 });\r\n    } catch (error: any) {\r\n        return NextResponse.json({ error: error.message }, { status: 500 });\r\n    }\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\shavi acadimy\\Shavierp\\app\\api\\hr\\payroll\\route.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'request' is defined but never used.","line":10,"column":27,"nodeType":null,"messageId":"unusedVar","endLine":10,"endColumn":34},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'request' is defined but never used.","line":23,"column":28,"nodeType":null,"messageId":"unusedVar","endLine":23,"endColumn":35},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":45,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":45,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1849,1852],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1849,1852],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { NextResponse } from 'next/server';\r\nimport { createClient } from '@supabase/supabase-js';\r\nimport { getSession } from '@/lib/auth';\r\n\r\nconst supabase = createClient(\r\n    process.env.NEXT_PUBLIC_SUPABASE_URL!,\r\n    process.env.SUPABASE_SERVICE_ROLE_KEY!\r\n);\r\n\r\nexport async function GET(request: Request) {\r\n    const session = await getSession();\r\n    if (!session) return NextResponse.json({ error: 'Unauthorized' }, { status: 401 });\r\n\r\n    const { data, error } = await supabase\r\n        .from('payroll_records')\r\n        .select(`*, employee:employees(full_name, department)`)\r\n        .order('pay_period_end', { ascending: false });\r\n\r\n    if (error) return NextResponse.json({ error: error.message }, { status: 500 });\r\n    return NextResponse.json({ payroll: data });\r\n}\r\n\r\nexport async function POST(request: Request) {\r\n    const session = await getSession();\r\n    if (!session) return NextResponse.json({ error: 'Unauthorized' }, { status: 401 });\r\n\r\n    // MVP: \"Run Payroll\" - Auto-generate records for all active employees\r\n    try {\r\n        const { data: employees } = await supabase.from('employees').select('*').eq('status', 'active');\r\n\r\n        if (!employees?.length) return NextResponse.json({ message: 'No active employees' });\r\n\r\n        const records = employees.map(emp => ({\r\n            employee_id: emp.id,\r\n            pay_period_start: new Date().toISOString().slice(0, 8) + '01', // First of month\r\n            pay_period_end: new Date().toISOString().slice(0, 10), // Today\r\n            base_salary: emp.salary_amount || 0,\r\n            status: 'processed'\r\n        }));\r\n\r\n        const { data, error } = await supabase.from('payroll_records').insert(records).select();\r\n\r\n        if (error) throw error;\r\n        return NextResponse.json({ processed: data.length }, { status: 201 });\r\n    } catch (error: any) {\r\n        return NextResponse.json({ error: error.message }, { status: 500 });\r\n    }\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\shavi acadimy\\Shavierp\\app\\api\\hr\\stats\\route.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":30,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":30,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1150,1153],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1150,1153],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { NextResponse } from 'next/server';\r\nimport { createClient } from '@supabase/supabase-js';\r\nimport { getSession } from '@/lib/auth';\r\n\r\nconst supabase = createClient(\r\n    process.env.NEXT_PUBLIC_SUPABASE_URL!,\r\n    process.env.SUPABASE_SERVICE_ROLE_KEY!\r\n);\r\n\r\nexport async function GET() {\r\n    const session = await getSession();\r\n    if (!session) return NextResponse.json({ error: 'Unauthorized' }, { status: 401 });\r\n\r\n    try {\r\n        const [\r\n            { count: totalEmployees },\r\n            { count: onLeave },\r\n            { count: pendingLeave }\r\n        ] = await Promise.all([\r\n            supabase.from('employees').select('*', { count: 'exact', head: true }).eq('status', 'active'),\r\n            supabase.from('employees').select('*', { count: 'exact', head: true }).eq('status', 'on_leave'),\r\n            supabase.from('leave_requests').select('*', { count: 'exact', head: true }).eq('status', 'pending')\r\n        ]);\r\n\r\n        return NextResponse.json({\r\n            totalEmployees: totalEmployees || 0,\r\n            onLeave: onLeave || 0,\r\n            pendingLeave: pendingLeave || 0\r\n        });\r\n    } catch (error: any) {\r\n        return NextResponse.json({ error: error.message }, { status: 500 });\r\n    }\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\shavi acadimy\\Shavierp\\app\\api\\intelligence\\dashboard\\route.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'hasPermission' is defined but never used.","line":3,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":3,"endColumn":23},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'PERMISSIONS' is defined but never used.","line":3,"column":25,"nodeType":null,"messageId":"unusedVar","endLine":3,"endColumn":36},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'request' is defined but never used.","line":10,"column":27,"nodeType":null,"messageId":"unusedVar","endLine":10,"endColumn":34}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { NextRequest, NextResponse } from 'next/server';\r\nimport { createClient } from '@/lib/supabase/server';\r\nimport { hasPermission, PERMISSIONS } from '@/lib/permissions';\r\nimport { getRevenueForecast, detectChurnRisks } from '@/lib/intelligence/analytics';\r\n\r\n/**\r\n * GET /api/intelligence/dashboard\r\n * Aggregates AI insights for the dashboard\r\n */\r\nexport async function GET(request: NextRequest) {\r\n    try {\r\n        const supabase = createClient();\r\n        const { data: { user } } = await supabase.auth.getUser();\r\n\r\n        if (!user) {\r\n            return NextResponse.json({ error: 'Unauthorized' }, { status: 401 });\r\n        }\r\n\r\n        // Technically should add a specific permission for this module\r\n        // For now, allow admins and marketing\r\n\r\n        // 1. Get Forecast\r\n        const forecast = await getRevenueForecast();\r\n\r\n        // 2. Get Churn Risks\r\n        const churnRisks = await detectChurnRisks();\r\n\r\n        // 3. Get recent AI Logs\r\n        const { data: recentScoring } = await supabase\r\n            .from('ai_score_logs')\r\n            .select('*')\r\n            .order('created_at', { ascending: false })\r\n            .limit(10);\r\n\r\n        return NextResponse.json({\r\n            forecast,\r\n            churnRisks,\r\n            recentScoring,\r\n            timestamp: new Date().toISOString()\r\n        });\r\n\r\n    } catch (error) {\r\n        console.error('[Intelligence API] Error:', error);\r\n        return NextResponse.json({ error: 'Failed to fetch intelligence data' }, { status: 500 });\r\n    }\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\shavi acadimy\\Shavierp\\app\\api\\marketing\\leads\\[id]\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\shavi acadimy\\Shavierp\\app\\api\\marketing\\leads\\route.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":149,"column":31,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":149,"endColumn":34,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5084,5087],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5084,5087],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":161,"column":51,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":161,"endColumn":54,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5563,5566],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5563,5566],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":164,"column":42,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":164,"endColumn":45,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5700,5703],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5700,5703],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":173,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":173,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5995,5998],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5995,5998],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { NextRequest, NextResponse } from 'next/server';\r\nimport { createClient } from '@/lib/supabase/server';\r\n\r\n/**\r\n * GET /api/marketing/leads\r\n * List all leads with filtering and sorting\r\n */\r\nexport async function GET(request: NextRequest) {\r\n    try {\r\n        const supabase = createClient();\r\n\r\n        // Auth check\r\n        const { data: { user } } = await supabase.auth.getUser();\r\n        if (!user) {\r\n            return NextResponse.json({ error: 'Unauthorized' }, { status: 401 });\r\n        }\r\n\r\n        // Parse query params\r\n        const { searchParams } = new URL(request.url);\r\n        const status = searchParams.get('status');\r\n        const source = searchParams.get('source');\r\n        const campaign_id = searchParams.get('campaign_id');\r\n        const assigned_to = searchParams.get('assigned_to');\r\n        const minScore = searchParams.get('min_score');\r\n        const search = searchParams.get('search');\r\n        const sortBy = searchParams.get('sort_by') || 'created_at';\r\n        const order = searchParams.get('order') || 'desc';\r\n        const limit = parseInt(searchParams.get('limit') || '50');\r\n        const offset = parseInt(searchParams.get('offset') || '0');\r\n\r\n        // Build query\r\n        let query = supabase\r\n            .from('leads')\r\n            .select(`\r\n                *,\r\n                campaigns (id, name, type),\r\n                assigned_user:auth.users!leads_assigned_to_fkey (id, email)\r\n            `, { count: 'exact' });\r\n\r\n        // Apply filters\r\n        if (status) query = query.eq('status', status);\r\n        if (source) query = query.eq('source', source);\r\n        if (campaign_id) query = query.eq('campaign_id', campaign_id);\r\n        if (assigned_to) query = query.eq('assigned_to', assigned_to);\r\n        if (minScore) query = query.gte('score', parseInt(minScore));\r\n        if (search) {\r\n            query = query.or(`first_name.ilike.%${search}%,last_name.ilike.%${search}%,email.ilike.%${search}%,company.ilike.%${search}%`);\r\n        }\r\n\r\n        // Sorting\r\n        query = query.order(sortBy, { ascending: order === 'asc' });\r\n\r\n        // Pagination\r\n        query = query.range(offset, offset + limit - 1);\r\n\r\n        const { data: leads, error, count } = await query;\r\n\r\n        if (error) throw error;\r\n\r\n        return NextResponse.json({\r\n            leads,\r\n            pagination: {\r\n                total: count || 0,\r\n                limit,\r\n                offset,\r\n                hasMore: (count || 0) > offset + limit\r\n            }\r\n        });\r\n\r\n    } catch (error) {\r\n        console.error('[Marketing Leads API] Error:', error);\r\n        return NextResponse.json(\r\n            { error: 'Failed to fetch leads' },\r\n            { status: 500 }\r\n        );\r\n    }\r\n}\r\n\r\n/**\r\n * POST /api/marketing/leads\r\n * Create a new lead\r\n */\r\nexport async function POST(request: NextRequest) {\r\n    try {\r\n        const supabase = createClient();\r\n\r\n        // Auth check\r\n        const { data: { user } } = await supabase.auth.getUser();\r\n        if (!user) {\r\n            return NextResponse.json({ error: 'Unauthorized' }, { status: 401 });\r\n        }\r\n\r\n        const body = await request.json();\r\n        const {\r\n            campaign_id,\r\n            first_name,\r\n            last_name,\r\n            email,\r\n            phone,\r\n            company,\r\n            job_title,\r\n            source,\r\n            source_details,\r\n            interests,\r\n            notes,\r\n            estimated_value,\r\n            assigned_to\r\n        } = body;\r\n\r\n        // Validation\r\n        if (!first_name || !last_name || !email) {\r\n            return NextResponse.json(\r\n                { error: 'first_name, last_name, and email are required' },\r\n                { status: 400 }\r\n            );\r\n        }\r\n\r\n        // Create lead\r\n        const { data: lead, error } = await supabase\r\n            .from('leads')\r\n            .insert({\r\n                campaign_id: campaign_id || null,\r\n                first_name,\r\n                last_name,\r\n                email,\r\n                phone: phone || null,\r\n                company: company || null,\r\n                job_title: job_title || null,\r\n                source: source || 'manual',\r\n                source_details: source_details || (['linkedin', 'phone'].includes(source) ? { original_source: source } : null),\r\n                interests: interests || null,\r\n                notes: notes || null,\r\n                estimated_value: estimated_value || null,\r\n                assigned_to: assigned_to || null,\r\n                assigned_at: assigned_to ? new Date().toISOString() : null,\r\n                status: 'new'\r\n            })\r\n            .select(`\r\n                *,\r\n                campaigns (id, name, type),\r\n                assigned_user:auth.users!leads_assigned_to_fkey (id, email)\r\n            `)\r\n            .single();\r\n\r\n        if (error || !lead) throw error || new Error('Failed to create lead');\r\n\r\n        // Create activity\r\n        await supabase.from('lead_activities').insert({\r\n            lead_id: (lead as any).id,\r\n            activity_type: 'created',\r\n            title: 'Lead created',\r\n            description: `Lead created by ${user.email}`,\r\n            created_by: user.id\r\n        });\r\n\r\n        // --- Intelligence Layer Integration ---\r\n        // Asynchronously run scoring and routing\r\n        (async () => {\r\n            try {\r\n                const { calculateLeadScore } = await import('@/lib/intelligence/scoring');\r\n                await calculateLeadScore((lead as any).id);\r\n\r\n                const { routeLead } = await import('@/lib/intelligence/routing');\r\n                await routeLead((lead as any).id);\r\n            } catch (error) {\r\n                console.error('[Intelligence Layer] Error processing lead:', error);\r\n            }\r\n        })();\r\n        // --------------------------------------\r\n\r\n        return NextResponse.json({ lead }, { status: 201 });\r\n\r\n    } catch (error: any) {\r\n        console.error('[Marketing Leads API] Error creating lead:', error);\r\n        return NextResponse.json(\r\n            { error: error?.message || 'Failed to create lead', details: error },\r\n            { status: 500 }\r\n        );\r\n    }\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\shavi acadimy\\Shavierp\\app\\api\\marketing\\stats\\route.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'request' is defined but never used.","line":8,"column":27,"nodeType":null,"messageId":"unusedVar","endLine":8,"endColumn":34}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { NextRequest, NextResponse } from 'next/server';\r\nimport { createClient } from '@/lib/supabase/server';\r\n\r\n/**\r\n * GET /api/marketing/stats\r\n * Get marketing statistics\r\n */\r\nexport async function GET(request: NextRequest) {\r\n    try {\r\n        const supabase = createClient();\r\n\r\n        const { data: { user } } = await supabase.auth.getUser();\r\n        if (!user) {\r\n            return NextResponse.json({ error: 'Unauthorized' }, { status: 401 });\r\n        }\r\n\r\n        // Total leads\r\n        const { count: totalLeads } = await supabase\r\n            .from('leads')\r\n            .select('*', { count: 'exact', head: true });\r\n\r\n        // Qualified leads\r\n        const { count: qualifiedLeads } = await supabase\r\n            .from('leads')\r\n            .select('*', { count: 'exact', head: true })\r\n            .eq('status', 'qualified');\r\n\r\n        // Active campaigns\r\n        const { count: activeCampaigns } = await supabase\r\n            .from('campaigns')\r\n            .select('*', { count: 'exact', head: true })\r\n            .eq('status', 'active');\r\n\r\n        // Conversion rate\r\n        const conversionRate = totalLeads && totalLeads > 0\r\n            ? Math.round((qualifiedLeads || 0) / totalLeads * 100)\r\n            : 0;\r\n\r\n        return NextResponse.json({\r\n            totalLeads: totalLeads || 0,\r\n            qualifiedLeads: qualifiedLeads || 0,\r\n            activeCampaigns: activeCampaigns || 0,\r\n            conversionRate\r\n        });\r\n\r\n    } catch (error) {\r\n        console.error('[Marketing Stats API] Error:', error);\r\n        return NextResponse.json({ error: 'Failed to fetch stats' }, { status: 500 });\r\n    }\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\shavi acadimy\\Shavierp\\app\\api\\sales\\deals\\[id]\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\shavi acadimy\\Shavierp\\app\\api\\sales\\deals\\route.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":95,"column":31,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":95,"endColumn":34,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3138,3141],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3138,3141],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { NextRequest, NextResponse } from 'next/server';\r\nimport { createClient } from '@/lib/supabase/server';\r\n\r\n/**\r\n * GET /api/sales/deals\r\n * List all deals with filtering\r\n */\r\nexport async function GET(request: NextRequest) {\r\n    try {\r\n        const supabase = createClient();\r\n\r\n        const { data: { user } } = await supabase.auth.getUser();\r\n        if (!user) {\r\n            return NextResponse.json({ error: 'Unauthorized' }, { status: 401 });\r\n        }\r\n\r\n        const { searchParams } = new URL(request.url);\r\n        const stage = searchParams.get('stage');\r\n        const assigned_to = searchParams.get('assigned_to');\r\n        const limit = parseInt(searchParams.get('limit') || '100');\r\n\r\n        let query = supabase\r\n            .from('deals')\r\n            .select(`\r\n                *,\r\n                lead:leads (id, first_name, last_name, email, company),\r\n                assigned_user:auth.users!deals_assigned_to_fkey (id, email)\r\n            `)\r\n            .order('created_at', { ascending: false });\r\n\r\n        if (stage) query = query.eq('stage', stage);\r\n        if (assigned_to) query = query.eq('assigned_to', assigned_to);\r\n\r\n        query = query.limit(limit);\r\n\r\n        const { data: deals, error } = await query;\r\n\r\n        if (error) throw error;\r\n\r\n        return NextResponse.json({ deals });\r\n\r\n    } catch (error) {\r\n        console.error('[Sales Deals API] Error:', error);\r\n        return NextResponse.json({ error: 'Failed to fetch deals' }, { status: 500 });\r\n    }\r\n}\r\n\r\n/**\r\n * POST /api/sales/deals\r\n * Create new deal\r\n */\r\nexport async function POST(request: NextRequest) {\r\n    try {\r\n        const supabase = createClient();\r\n\r\n        const { data: { user } } = await supabase.auth.getUser();\r\n        if (!user) {\r\n            return NextResponse.json({ error: 'Unauthorized' }, { status: 401 });\r\n        }\r\n\r\n        const body = await request.json();\r\n        const { lead_id, title, value, description, assigned_to, expected_close_date } = body;\r\n\r\n        if (!title || value === undefined) {\r\n            return NextResponse.json(\r\n                { error: 'title and value are required' },\r\n                { status: 400 }\r\n            );\r\n        }\r\n\r\n        const { data: deal, error } = await supabase\r\n            .from('deals')\r\n            .insert({\r\n                lead_id: lead_id || null,\r\n                title,\r\n                value,\r\n                description: description || null,\r\n                stage: 'new',\r\n                probability: 25,\r\n                assigned_to: assigned_to || user.id,\r\n                assigned_at: new Date().toISOString(),\r\n                expected_close_date: expected_close_date || null\r\n            })\r\n            .select(`\r\n                *,\r\n                lead:leads (id, first_name, last_name, email),\r\n                assigned_user:auth.users!deals_assigned_to_fkey (id, email)\r\n            `)\r\n            .single();\r\n\r\n        if (error) throw error;\r\n        if (!deal) throw new Error('Failed to create deal');\r\n\r\n        await supabase.from('deal_activities').insert({\r\n            deal_id: (deal as any).id,\r\n            activity_type: 'created',\r\n            title: 'Deal created',\r\n            description: `Deal created by ${user.email}`,\r\n            created_by: user.id\r\n        });\r\n\r\n        return NextResponse.json({ deal }, { status: 201 });\r\n\r\n    } catch (error) {\r\n        console.error('[Sales Deals API] Error creating:', error);\r\n        return NextResponse.json({ error: 'Failed to create deal' }, { status: 500 });\r\n    }\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\shavi acadimy\\Shavierp\\app\\api\\sales\\stats\\route.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'request' is defined but never used.","line":8,"column":27,"nodeType":null,"messageId":"unusedVar","endLine":8,"endColumn":34}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { NextRequest, NextResponse } from 'next/server';\r\nimport { createClient } from '@/lib/supabase/server';\r\n\r\n/**\r\n * GET /api/sales/stats\r\n * Get sales statistics\r\n */\r\nexport async function GET(request: NextRequest) {\r\n    try {\r\n        const supabase = createClient();\r\n\r\n        const { data: { user } } = await supabase.auth.getUser();\r\n        if (!user) {\r\n            return NextResponse.json({ error: 'Unauthorized' }, { status: 401 });\r\n        }\r\n\r\n        // Pipeline value (all active deals)\r\n        const { data: activeDealsData } = await supabase\r\n            .from('deals')\r\n            .select('value')\r\n            .not('stage', 'in', '(closed_won,closed_lost)');\r\n\r\n        const pipelineValue = activeDealsData?.reduce((sum, deal) => sum + (deal.value || 0), 0) || 0;\r\n        const activeDeals = activeDealsData?.length || 0;\r\n\r\n        // Won deals this month\r\n        const startOfMonth = new Date();\r\n        startOfMonth.setDate(1);\r\n        startOfMonth.setHours(0, 0, 0, 0);\r\n\r\n        const { count: wonDeals } = await supabase\r\n            .from('deals')\r\n            .select('*', { count: 'exact', head: true })\r\n            .eq('stage', 'closed_won')\r\n            .gte('actual_close_date', startOfMonth.toISOString());\r\n\r\n        // Win rate\r\n        const { count: totalClosed } = await supabase\r\n            .from('deals')\r\n            .select('*', { count: 'exact', head: true })\r\n            .in('stage', ['closed_won', 'closed_lost']);\r\n\r\n        const winRate = totalClosed && totalClosed > 0\r\n            ? Math.round((wonDeals || 0) / totalClosed * 100)\r\n            : 0;\r\n\r\n        return NextResponse.json({\r\n            pipelineValue,\r\n            activeDeals,\r\n            wonDeals: wonDeals || 0,\r\n            winRate\r\n        });\r\n\r\n    } catch (error) {\r\n        console.error('[Sales Stats API] Error:', error);\r\n        return NextResponse.json({ error: 'Failed to fetch stats' }, { status: 500 });\r\n    }\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\shavi acadimy\\Shavierp\\app\\api\\tech\\auth\\check\\route.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'request' is defined but never used.","line":10,"column":27,"nodeType":null,"messageId":"unusedVar","endLine":10,"endColumn":34}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { NextRequest, NextResponse } from 'next/server';\r\nimport { createClient } from '@/lib/supabase/server';\r\n\r\n/**\r\n * GET /api/tech/auth/check\r\n * \r\n * Verify if current user is a tech user with proper permissions\r\n * Returns user info and permissions\r\n */\r\nexport async function GET(request: NextRequest) {\r\n    try {\r\n        const supabase = createClient();\r\n\r\n        // Get current user\r\n        const { data: { user }, error: userError } = await supabase.auth.getUser();\r\n\r\n        if (userError || !user) {\r\n            return NextResponse.json(\r\n                { error: 'Unauthorized', isTechUser: false },\r\n                { status: 401 }\r\n            );\r\n        }\r\n\r\n        // Check if user is a tech user\r\n        const { data: techUser, error: techError } = await supabase\r\n            .from('tech_users')\r\n            .select('*')\r\n            .eq('user_id', user.id)\r\n            .eq('is_active', true)\r\n            .single();\r\n\r\n        if (techError || !techUser) {\r\n            return NextResponse.json(\r\n                {\r\n                    error: 'Access denied. Tech panel access required.',\r\n                    isTechUser: false\r\n                },\r\n                { status: 403 }\r\n            );\r\n        }\r\n\r\n        // Update last login\r\n        await supabase\r\n            .from('tech_users')\r\n            .update({ last_login_at: new Date().toISOString() })\r\n            .eq('id', techUser.id);\r\n\r\n        return NextResponse.json({\r\n            isTechUser: true,\r\n            user: {\r\n                id: user.id,\r\n                email: user.email,\r\n                role: techUser.role,\r\n                permissions: techUser.permissions,\r\n                isActive: techUser.is_active,\r\n            }\r\n        });\r\n\r\n    } catch (error) {\r\n        console.error('[Tech Auth] Error checking auth:', error);\r\n        return NextResponse.json(\r\n            { error: 'Internal server error', isTechUser: false },\r\n            { status: 500 }\r\n        );\r\n    }\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\shavi acadimy\\Shavierp\\app\\api\\tech\\endpoints\\[id]\\test\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\shavi acadimy\\Shavierp\\app\\api\\tech\\endpoints\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\shavi acadimy\\Shavierp\\app\\api\\tech\\integrations\\[id]\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\shavi acadimy\\Shavierp\\app\\api\\tech\\integrations\\route.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'request' is defined but never used.","line":9,"column":27,"nodeType":null,"messageId":"unusedVar","endLine":9,"endColumn":34}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { NextRequest, NextResponse } from 'next/server';\r\nimport { createClient } from '@/lib/supabase/server';\r\nimport { hasPermission, PERMISSIONS } from '@/lib/permissions';\r\n\r\n/**\r\n * GET /api/tech/integrations\r\n * List all integrations with stats\r\n */\r\nexport async function GET(request: NextRequest) {\r\n    try {\r\n        const supabase = createClient();\r\n\r\n        // Verify tech user\r\n        const { data: { user } } = await supabase.auth.getUser();\r\n        if (!user) {\r\n            return NextResponse.json({ error: 'Unauthorized' }, { status: 401 });\r\n        }\r\n\r\n        const { data: techUser } = await supabase\r\n            .from('tech_users')\r\n            .select('permissions')\r\n            .eq('user_id', user.id)\r\n            .single();\r\n\r\n        if (!techUser || !hasPermission(techUser.permissions, PERMISSIONS.INTEGRATIONS_VIEW)) {\r\n            return NextResponse.json({ error: 'Insufficient permissions' }, { status: 403 });\r\n        }\r\n\r\n        // Get integrations with stats\r\n        const { data: integrations, error } = await supabase\r\n            .rpc('get_integration_overview');\r\n\r\n        if (error) {\r\n            throw error;\r\n        }\r\n\r\n        return NextResponse.json({ integrations });\r\n\r\n    } catch (error) {\r\n        console.error('[Integrations API] Error fetching integrations:', error);\r\n        return NextResponse.json(\r\n            { error: 'Failed to fetch integrations' },\r\n            { status: 500 }\r\n        );\r\n    }\r\n}\r\n\r\n/**\r\n * POST /api/tech/integrations\r\n * Create a new integration\r\n */\r\nexport async function POST(request: NextRequest) {\r\n    try {\r\n        const supabase = createClient();\r\n\r\n        // Verify tech user\r\n        const { data: { user } } = await supabase.auth.getUser();\r\n        if (!user) {\r\n            return NextResponse.json({ error: 'Unauthorized' }, { status: 401 });\r\n        }\r\n\r\n        const { data: techUser } = await supabase\r\n            .from('tech_users')\r\n            .select('permissions')\r\n            .eq('user_id', user.id)\r\n            .single();\r\n\r\n        if (!techUser || !hasPermission(techUser.permissions, PERMISSIONS.INTEGRATIONS_MANAGE)) {\r\n            return NextResponse.json({ error: 'Insufficient permissions' }, { status: 403 });\r\n        }\r\n\r\n        // Parse request body\r\n        const body = await request.json();\r\n        const { name, display_name, type, config, webhook_url } = body;\r\n\r\n        // Validate required fields\r\n        if (!name || !type) {\r\n            return NextResponse.json(\r\n                { error: 'Name and type are required' },\r\n                { status: 400 }\r\n            );\r\n        }\r\n\r\n        // Create integration\r\n        const { data: integration, error } = await supabase\r\n            .from('integrations')\r\n            .insert({\r\n                name,\r\n                display_name: display_name || name,\r\n                type,\r\n                config: config || {},\r\n                webhook_url,\r\n                created_by: user.id,\r\n                status: 'active'\r\n            })\r\n            .select()\r\n            .single();\r\n\r\n        if (error) {\r\n            if (error.code === '23505') { // Unique violation\r\n                return NextResponse.json(\r\n                    { error: 'Integration with this name already exists' },\r\n                    { status: 409 }\r\n                );\r\n            }\r\n            throw error;\r\n        }\r\n\r\n        // Log to audit trail\r\n        await supabase.from('audit_log').insert({\r\n            user_id: user.id,\r\n            action: 'created',\r\n            resource_type: 'integration',\r\n            resource_id: integration.id,\r\n            resource_name: integration.name,\r\n            changes: { after: integration }\r\n        });\r\n\r\n        return NextResponse.json({ integration }, { status: 201 });\r\n\r\n    } catch (error) {\r\n        console.error('[Integrations API] Error creating integration:', error);\r\n        return NextResponse.json(\r\n            { error: 'Failed to create integration' },\r\n            { status: 500 }\r\n        );\r\n    }\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\shavi acadimy\\Shavierp\\app\\api\\tech\\logs\\route.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":77,"column":53,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":77,"endColumn":56,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3147,3150],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3147,3150],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { NextRequest, NextResponse } from 'next/server';\r\nimport { createClient } from '@/lib/supabase/server';\r\nimport { hasPermission, PERMISSIONS } from '@/lib/permissions';\r\n\r\n/**\r\n * GET /api/tech/logs\r\n * Get integration logs with advanced filtering\r\n */\r\nexport async function GET(request: NextRequest) {\r\n    try {\r\n        const supabase = createClient();\r\n\r\n        // Verify tech user\r\n        const { data: { user } } = await supabase.auth.getUser();\r\n        if (!user) {\r\n            return NextResponse.json({ error: 'Unauthorized' }, { status: 401 });\r\n        }\r\n\r\n        const { data: techUser } = await supabase\r\n            .from('tech_users')\r\n            .select('permissions')\r\n            .eq('user_id', user.id)\r\n            .single();\r\n\r\n        if (!techUser || !hasPermission(techUser.permissions, PERMISSIONS.LOGS_VIEW)) {\r\n            return NextResponse.json({ error: 'Insufficient permissions' }, { status: 403 });\r\n        }\r\n\r\n        // Parse query params\r\n        const { searchParams } = new URL(request.url);\r\n        const integrationId = searchParams.get('integration_id');\r\n        const endpointId = searchParams.get('endpoint_id');\r\n        const status = searchParams.get('status');\r\n        const eventType = searchParams.get('event_type');\r\n        const limit = parseInt(searchParams.get('limit') || '50');\r\n        const offset = parseInt(searchParams.get('offset') || '0');\r\n        const dateFrom = searchParams.get('date_from');\r\n        const dateTo = searchParams.get('date_to');\r\n\r\n        // Build query\r\n        let query = supabase\r\n            .from('integration_logs')\r\n            .select(`\r\n                *,\r\n                integrations (name, display_name),\r\n                integration_endpoints (name, event_type)\r\n            `, { count: 'exact' })\r\n            .order('created_at', { ascending: false })\r\n            .range(offset, offset + limit - 1);\r\n\r\n        // Apply filters\r\n        if (integrationId) query = query.eq('integration_id', integrationId);\r\n        if (endpointId) query = query.eq('endpoint_id', endpointId);\r\n        if (status) query = query.eq('status', status);\r\n        if (eventType) query = query.eq('event_type', eventType);\r\n        if (dateFrom) query = query.gte('created_at', dateFrom);\r\n        if (dateTo) query = query.lte('created_at', dateTo);\r\n\r\n        const { data: logs, error, count } = await query;\r\n\r\n        if (error) {\r\n            throw error;\r\n        }\r\n\r\n        // Get aggregate stats\r\n        const { data: statsData } = await supabase\r\n            .from('integration_logs')\r\n            .select('status, duration_ms')\r\n            .gte('created_at', new Date(Date.now() - 24 * 60 * 60 * 1000).toISOString()); // Last 24h\r\n\r\n        const stats = {\r\n            total: count || 0,\r\n            success: logs?.filter(l => l.status === 'success').length || 0,\r\n            failed: logs?.filter(l => l.status === 'failed').length || 0,\r\n            pending: logs?.filter(l => l.status === 'pending').length || 0,\r\n            avgDuration: statsData && statsData.length > 0\r\n                ? statsData.reduce((acc: number, l: any) => acc + (Number(l.duration_ms) || 0), 0) / statsData.length\r\n                : 0,\r\n            last24h: statsData?.length || 0\r\n        };\r\n\r\n        return NextResponse.json({\r\n            logs,\r\n            pagination: {\r\n                total: count || 0,\r\n                limit,\r\n                offset,\r\n                hasMore: (count || 0) > offset + limit\r\n            },\r\n            stats\r\n        });\r\n\r\n    } catch (error) {\r\n        console.error('[Logs API] Error fetching logs:', error);\r\n        return NextResponse.json(\r\n            { error: 'Failed to fetch logs' },\r\n            { status: 500 }\r\n        );\r\n    }\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\shavi acadimy\\Shavierp\\app\\api\\tech\\retry\\[id]\\retry\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\shavi acadimy\\Shavierp\\app\\api\\tech\\retry\\route.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'stats' is assigned a value but never used.","line":59,"column":23,"nodeType":null,"messageId":"unusedVar","endLine":59,"endColumn":28}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { NextRequest, NextResponse } from 'next/server';\r\nimport { createClient } from '@/lib/supabase/server';\r\nimport { hasPermission, PERMISSIONS } from '@/lib/permissions';\r\n\r\n/**\r\n * GET /api/tech/retry\r\n * List failed webhooks in retry queue\r\n */\r\nexport async function GET(request: NextRequest) {\r\n    try {\r\n        const supabase = createClient();\r\n\r\n        // Verify tech user\r\n        const { data: { user } } = await supabase.auth.getUser();\r\n        if (!user) {\r\n            return NextResponse.json({ error: 'Unauthorized' }, { status: 401 });\r\n        }\r\n\r\n        const { data: techUser } = await supabase\r\n            .from('tech_users')\r\n            .select('permissions')\r\n            .eq('user_id', user.id)\r\n            .single();\r\n\r\n        if (!techUser || !hasPermission(techUser.permissions, PERMISSIONS.RETRY_VIEW)) {\r\n            return NextResponse.json({ error: 'Insufficient permissions' }, { status: 403 });\r\n        }\r\n\r\n        // Get URL params\r\n        const { searchParams } = new URL(request.url);\r\n        const status = searchParams.get('status') || 'all';\r\n        const integrationId = searchParams.get('integration_id');\r\n\r\n        // Build query\r\n        let query = supabase\r\n            .from('failed_webhooks')\r\n            .select(`\r\n                *,\r\n                integrations (name, display_name),\r\n                integration_endpoints (name, event_type)\r\n            `)\r\n            .order('created_at', { ascending: false });\r\n\r\n        if (status !== 'all') {\r\n            query = query.eq('status', status);\r\n        }\r\n\r\n        if (integrationId) {\r\n            query = query.eq('integration_id', integrationId);\r\n        }\r\n\r\n        const { data: failedWebhooks, error } = await query;\r\n\r\n        if (error) {\r\n            throw error;\r\n        }\r\n\r\n        // Get summary stats\r\n        const { data: stats } = await supabase\r\n            .from('failed_webhooks')\r\n            .select('status', { count: 'exact', head: true });\r\n\r\n        return NextResponse.json({\r\n            failed_webhooks: failedWebhooks,\r\n            stats: {\r\n                total: failedWebhooks?.length || 0,\r\n                pending: failedWebhooks?.filter(w => w.status === 'pending').length || 0,\r\n                retrying: failedWebhooks?.filter(w => w.status === 'retrying').length || 0,\r\n                dead: failedWebhooks?.filter(w => w.status === 'dead').length || 0,\r\n                resolved: failedWebhooks?.filter(w => w.status === 'resolved').length || 0,\r\n            }\r\n        });\r\n\r\n    } catch (error) {\r\n        console.error('[Retry API] Error fetching failed webhooks:', error);\r\n        return NextResponse.json(\r\n            { error: 'Failed to fetch retry queue' },\r\n            { status: 500 }\r\n        );\r\n    }\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\shavi acadimy\\Shavierp\\app\\api\\tech\\secrets\\[id]\\decrypt\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\shavi acadimy\\Shavierp\\app\\api\\tech\\secrets\\route.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'decryptSecret' is defined but never used.","line":4,"column":25,"nodeType":null,"messageId":"unusedVar","endLine":4,"endColumn":38}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { NextRequest, NextResponse } from 'next/server';\r\nimport { createClient } from '@/lib/supabase/server';\r\nimport { hasPermission, PERMISSIONS } from '@/lib/permissions';\r\nimport { encryptSecret, decryptSecret } from '@/lib/encryption/secrets';\r\n\r\n/**\r\n * GET /api/tech/secrets\r\n * List all secrets (encrypted values not exposed)\r\n */\r\nexport async function GET(request: NextRequest) {\r\n    try {\r\n        const supabase = createClient();\r\n\r\n        // Verify tech user\r\n        const { data: { user } } = await supabase.auth.getUser();\r\n        if (!user) {\r\n            return NextResponse.json({ error: 'Unauthorized' }, { status: 401 });\r\n        }\r\n\r\n        const { data: techUser } = await supabase\r\n            .from('tech_users')\r\n            .select('permissions')\r\n            .eq('user_id', user.id)\r\n            .single();\r\n\r\n        if (!techUser || !hasPermission(techUser.permissions, PERMISSIONS.SECRETS_VIEW)) {\r\n            return NextResponse.json({ error: 'Insufficient permissions' }, { status: 403 });\r\n        }\r\n\r\n        // Get URL params\r\n        const { searchParams } = new URL(request.url);\r\n        const integrationId = searchParams.get('integration_id');\r\n\r\n        // Build query\r\n        let query = supabase\r\n            .from('secrets')\r\n            .select(`\r\n                id,\r\n                integration_id,\r\n                key_name,\r\n                description,\r\n                rotation_enabled,\r\n                last_rotated_at,\r\n                expires_at,\r\n                created_at,\r\n                integrations (name, display_name)\r\n            `);\r\n\r\n        if (integrationId) {\r\n            query = query.eq('integration_id', integrationId);\r\n        }\r\n\r\n        const { data: secrets, error } = await query;\r\n\r\n        if (error) {\r\n            throw error;\r\n        }\r\n\r\n        // Don't expose encrypted values\r\n        const sanitizedSecrets = secrets?.map(secret => ({\r\n            ...secret,\r\n            value_masked: '****' + secret.key_name.slice(-4),\r\n            value_encrypted: undefined, // Remove from response\r\n        }));\r\n\r\n        return NextResponse.json({ secrets: sanitizedSecrets });\r\n\r\n    } catch (error) {\r\n        console.error('[Secrets API] Error fetching secrets:', error);\r\n        return NextResponse.json(\r\n            { error: 'Failed to fetch secrets' },\r\n            { status: 500 }\r\n        );\r\n    }\r\n}\r\n\r\n/**\r\n * POST /api/tech/secrets\r\n * Create a new secret (encrypts value)\r\n */\r\nexport async function POST(request: NextRequest) {\r\n    try {\r\n        const supabase = createClient();\r\n\r\n        // Verify tech user\r\n        const { data: { user } } = await supabase.auth.getUser();\r\n        if (!user) {\r\n            return NextResponse.json({ error: 'Unauthorized' }, { status: 401 });\r\n        }\r\n\r\n        const { data: techUser } = await supabase\r\n            .from('tech_users')\r\n            .select('permissions')\r\n            .eq('user_id', user.id)\r\n            .single();\r\n\r\n        if (!techUser || !hasPermission(techUser.permissions, PERMISSIONS.SECRETS_MANAGE)) {\r\n            return NextResponse.json({ error: 'Insufficient permissions' }, { status: 403 });\r\n        }\r\n\r\n        // Parse request body\r\n        const body = await request.json();\r\n        const { integration_id, key_name, value, description, rotation_enabled, expires_at } = body;\r\n\r\n        // Validate required fields\r\n        if (!integration_id || !key_name || !value) {\r\n            return NextResponse.json(\r\n                { error: 'integration_id, key_name, and value are required' },\r\n                { status: 400 }\r\n            );\r\n        }\r\n\r\n        // Encrypt the secret value\r\n        let value_encrypted: string;\r\n        try {\r\n            value_encrypted = encryptSecret(value);\r\n        } catch (encryptError) {\r\n            console.error('[Secrets API] Encryption error:', encryptError);\r\n            return NextResponse.json(\r\n                { error: 'Failed to encrypt secret. Check SECRET_ENCRYPTION_KEY environment variable.' },\r\n                { status: 500 }\r\n            );\r\n        }\r\n\r\n        // Create secret\r\n        const { data: secret, error } = await supabase\r\n            .from('secrets')\r\n            .insert({\r\n                integration_id,\r\n                key_name,\r\n                value_encrypted,\r\n                description,\r\n                rotation_enabled: rotation_enabled || false,\r\n                expires_at,\r\n                created_by: user.id\r\n            })\r\n            .select()\r\n            .single();\r\n\r\n        if (error) {\r\n            if (error.code === '23505') { // Unique violation\r\n                return NextResponse.json(\r\n                    { error: 'Secret with this key name already exists for this integration' },\r\n                    { status: 409 }\r\n                );\r\n            }\r\n            throw error;\r\n        }\r\n\r\n        // Log to audit trail\r\n        await supabase.from('audit_log').insert({\r\n            user_id: user.id,\r\n            action: 'created',\r\n            resource_type: 'secret',\r\n            resource_id: secret.id,\r\n            resource_name: `${integration_id}:${key_name}`,\r\n            changes: { after: { ...secret, value_encrypted: '[REDACTED]' } }\r\n        });\r\n\r\n        // Don't return encrypted value\r\n        return NextResponse.json({\r\n            secret: {\r\n                ...secret,\r\n                value_encrypted: undefined,\r\n                value_masked: '****' + key_name.slice(-4)\r\n            }\r\n        }, { status: 201 });\r\n\r\n    } catch (error) {\r\n        console.error('[Secrets API] Error creating secret:', error);\r\n        return NextResponse.json(\r\n            { error: 'Failed to create secret' },\r\n            { status: 500 }\r\n        );\r\n    }\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\shavi acadimy\\Shavierp\\app\\api\\trainers\\route.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":60,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":60,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1902,1905],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1902,1905],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { NextResponse } from 'next/server';\r\nimport { createClient } from '@supabase/supabase-js';\r\nimport { getSession } from '@/lib/auth';\r\n\r\nconst supabase = createClient(\r\n    process.env.NEXT_PUBLIC_SUPABASE_URL!,\r\n    process.env.SUPABASE_SERVICE_ROLE_KEY!\r\n);\r\n\r\nexport async function GET(request: Request) {\r\n    const session = await getSession();\r\n    if (!session) return NextResponse.json({ error: 'Unauthorized' }, { status: 401 });\r\n\r\n    const { searchParams } = new URL(request.url);\r\n    const status = searchParams.get('status');\r\n    const search = searchParams.get('search');\r\n\r\n    let query = supabase.from('trainers').select('*').order('created_at', { ascending: false });\r\n\r\n    if (status && status !== 'all') {\r\n        query = query.eq('status', status);\r\n    }\r\n\r\n    if (search) {\r\n        query = query.or(`full_name.ilike.%${search}%,email.ilike.%${search}%`);\r\n    }\r\n\r\n    const { data, error } = await query;\r\n\r\n    if (error) {\r\n        return NextResponse.json({ error: error.message }, { status: 500 });\r\n    }\r\n\r\n    return NextResponse.json({ trainers: data });\r\n}\r\n\r\nexport async function POST(request: Request) {\r\n    const session = await getSession();\r\n    if (!session) return NextResponse.json({ error: 'Unauthorized' }, { status: 401 });\r\n\r\n    try {\r\n        const body = await request.json();\r\n        // Basic validation\r\n        if (!body.full_name || !body.email) {\r\n            return NextResponse.json({ error: 'Name and Email are required' }, { status: 400 });\r\n        }\r\n\r\n        const { data, error } = await supabase\r\n            .from('trainers')\r\n            .insert({\r\n                ...body,\r\n                updated_at: new Date().toISOString()\r\n            })\r\n            .select()\r\n            .single();\r\n\r\n        if (error) throw error;\r\n\r\n        return NextResponse.json({ trainer: data }, { status: 201 });\r\n    } catch (error: any) {\r\n        console.error('Error creating trainer:', error);\r\n        return NextResponse.json({ error: error.message }, { status: 500 });\r\n    }\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\shavi acadimy\\Shavierp\\app\\api\\trainers\\stats\\route.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":33,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":33,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1383,1386],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1383,1386],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { NextResponse } from 'next/server';\r\nimport { createClient } from '@supabase/supabase-js';\r\nimport { getSession } from '@/lib/auth';\r\n\r\nconst supabase = createClient(\r\n    process.env.NEXT_PUBLIC_SUPABASE_URL!,\r\n    process.env.SUPABASE_SERVICE_ROLE_KEY!\r\n);\r\n\r\nexport async function GET() {\r\n    const session = await getSession();\r\n    if (!session) return NextResponse.json({ error: 'Unauthorized' }, { status: 401 });\r\n\r\n    try {\r\n        const [\r\n            { count: activeTrainers },\r\n            { count: activeCourses },\r\n            { count: activeBatches },\r\n            { count: scheduledSessions }\r\n        ] = await Promise.all([\r\n            supabase.from('trainers').select('*', { count: 'exact', head: true }).eq('status', 'active'),\r\n            supabase.from('courses').select('*', { count: 'exact', head: true }).eq('status', 'active'),\r\n            supabase.from('course_batches').select('*', { count: 'exact', head: true }).eq('status', 'active'),\r\n            supabase.from('academic_sessions').select('*', { count: 'exact', head: true }).eq('status', 'scheduled')\r\n        ]);\r\n\r\n        return NextResponse.json({\r\n            activeTrainers: activeTrainers || 0,\r\n            activeCourses: activeCourses || 0,\r\n            activeBatches: activeBatches || 0,\r\n            scheduledSessions: scheduledSessions || 0\r\n        });\r\n    } catch (error: any) {\r\n        return NextResponse.json({ error: error.message }, { status: 500 });\r\n    }\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\shavi acadimy\\Shavierp\\app\\api\\webhooks\\nazmly\\enrollments\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\shavi acadimy\\Shavierp\\app\\api\\webhooks\\nazmly\\leads\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\shavi acadimy\\Shavierp\\app\\api\\webhooks\\nazmly\\payments\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\shavi acadimy\\Shavierp\\app\\api\\webhooks\\nazmly\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\shavi acadimy\\Shavierp\\app\\api\\webhooks\\nazmly\\sessions\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\shavi acadimy\\Shavierp\\app\\layout.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\shavi acadimy\\Shavierp\\app\\login\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'err' is defined but never used.","line":42,"column":18,"nodeType":null,"messageId":"unusedVar","endLine":42,"endColumn":21}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { useState } from \"react\";\r\nimport { useRouter } from \"next/navigation\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { Input } from \"@/components/ui/input\";\r\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\r\nimport { LogIn, AlertCircle } from \"lucide-react\";\r\n\r\nexport default function LoginPage() {\r\n    const router = useRouter();\r\n    const [email, setEmail] = useState(\"\");\r\n    const [password, setPassword] = useState(\"\");\r\n    const [error, setError] = useState(\"\");\r\n    const [isLoading, setIsLoading] = useState(false);\r\n\r\n    const handleSubmit = async (e: React.FormEvent) => {\r\n        e.preventDefault();\r\n        setError(\"\");\r\n        setIsLoading(true);\r\n\r\n        try {\r\n            const response = await fetch(\"/api/auth/login\", {\r\n                method: \"POST\",\r\n                headers: {\r\n                    \"Content-Type\": \"application/json\",\r\n                },\r\n                body: JSON.stringify({ email, password }),\r\n            });\r\n\r\n            const data = await response.json();\r\n\r\n            if (!response.ok) {\r\n                setError(data.error || \"  \");\r\n                setIsLoading(false);\r\n                return;\r\n            }\r\n\r\n            // Redirect to dashboard\r\n            router.push(\"/\");\r\n            router.refresh();\r\n        } catch (err) {\r\n            setError(\"    \");\r\n            setIsLoading(false);\r\n        }\r\n    };\r\n\r\n    const demoAccounts = [\r\n        { email: \"admin@shavi.com\", password: \"admin123\", role: \" \" },\r\n        { email: \"sales@shavi.com\", password: \"sales123\", role: \" \" },\r\n        { email: \"marketing@shavi.com\", password: \"marketing123\", role: \" \" },\r\n    ];\r\n\r\n    return (\r\n        <div className=\"min-h-screen flex items-center justify-center bg-background p-4\">\r\n            <Card className=\"w-full max-w-md shadow-lg\">\r\n                <CardHeader className=\"space-y-3 text-center\">\r\n                    <div className=\"mx-auto w-16 h-16 bg-primary rounded-full flex items-center justify-center\">\r\n                        <LogIn className=\"w-8 h-8 text-white\" />\r\n                    </div>\r\n                    <CardTitle className=\"text-3xl font-bold\">Shavi Academy OS</CardTitle>\r\n                    <CardDescription className=\"text-base\">\r\n                           \r\n                    </CardDescription>\r\n                </CardHeader>\r\n                <CardContent>\r\n                    <form onSubmit={handleSubmit} className=\"space-y-4\">\r\n                        {error && (\r\n                            <div className=\"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg flex items-center gap-2\">\r\n                                <AlertCircle className=\"w-5 h-5 flex-shrink-0\" />\r\n                                <p className=\"text-sm\">{error}</p>\r\n                            </div>\r\n                        )}\r\n\r\n                        <div className=\"space-y-2\">\r\n                            <label htmlFor=\"email\" className=\"text-sm font-medium\">\r\n                                 \r\n                            </label>\r\n                            <Input\r\n                                id=\"email\"\r\n                                type=\"email\"\r\n                                placeholder=\"example@shavi.com\"\r\n                                value={email}\r\n                                onChange={(e) => setEmail(e.target.value)}\r\n                                required\r\n                                disabled={isLoading}\r\n                            />\r\n                        </div>\r\n\r\n                        <div className=\"space-y-2\">\r\n                            <label htmlFor=\"password\" className=\"text-sm font-medium\">\r\n                                 \r\n                            </label>\r\n                            <Input\r\n                                id=\"password\"\r\n                                type=\"password\"\r\n                                placeholder=\"\"\r\n                                value={password}\r\n                                onChange={(e) => setPassword(e.target.value)}\r\n                                required\r\n                                disabled={isLoading}\r\n                            />\r\n                        </div>\r\n\r\n                        <Button\r\n                            type=\"submit\"\r\n                            className=\"w-full\"\r\n                            disabled={isLoading}\r\n                        >\r\n                            {isLoading ? \"  ...\" : \" \"}\r\n                        </Button>\r\n                    </form>\r\n\r\n                    {/* Demo Accounts */}\r\n                    <div className=\"mt-6 pt-6 border-t\">\r\n                        <p className=\"text-sm text-muted-foreground text-center mb-3\">\r\n                              :\r\n                        </p>\r\n                        <div className=\"space-y-2\">\r\n                            {demoAccounts.map((account, index) => (\r\n                                <button\r\n                                    key={index}\r\n                                    type=\"button\"\r\n                                    onClick={() => {\r\n                                        setEmail(account.email);\r\n                                        setPassword(account.password);\r\n                                    }}\r\n                                    className=\"w-full text-left p-3 rounded-lg border hover:bg-accent transition-colors text-sm\"\r\n                                >\r\n                                    <div className=\"font-medium\">{account.role}</div>\r\n                                    <div className=\"text-xs text-muted-foreground\">\r\n                                        {account.email}\r\n                                    </div>\r\n                                </button>\r\n                            ))}\r\n                        </div>\r\n                    </div>\r\n                </CardContent>\r\n            </Card>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\shavi acadimy\\Shavierp\\app\\web-vitals.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\shavi acadimy\\Shavierp\\components\\dashboard\\draggable-grid.tsx","messages":[{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\nD:\\shavi acadimy\\Shavierp\\components\\dashboard\\draggable-grid.tsx:75:9\n  73 |     // Wait for client-side mount to fix hydration mismatch\n  74 |     useEffect(() => {\n> 75 |         setIsMounted(true);\n     |         ^^^^^^^^^^^^ Avoid calling setState() directly within an effect\n  76 |     }, []);\n  77 |\n  78 |     // Load saved order from localStorage on mount","line":75,"column":9,"nodeType":null,"endLine":75,"endColumn":21},{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\nD:\\shavi acadimy\\Shavierp\\components\\dashboard\\draggable-grid.tsx:97:17\n   95 |                 );\n   96 |\n>  97 |                 setItems([...orderedWidgets, ...newWidgets]);\n      |                 ^^^^^^^^ Avoid calling setState() directly within an effect\n   98 |             }\n   99 |         } catch (error) {\n  100 |             console.error(\"Failed to load dashboard layout:\", error);","line":97,"column":17,"nodeType":null,"endLine":97,"endColumn":25},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":104,"column":37,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":104,"endColumn":40,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3518,3521],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3518,3521],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { DndContext, DragEndEvent, closestCenter, PointerSensor, useSensor, useSensors } from \"@dnd-kit/core\";\r\nimport { SortableContext, arrayMove, rectSortingStrategy } from \"@dnd-kit/sortable\";\r\nimport { useSortable } from \"@dnd-kit/sortable\";\r\nimport { CSS } from \"@dnd-kit/utilities\";\r\nimport { useState, useEffect, ReactNode } from \"react\";\r\nimport { GripVertical } from \"lucide-react\";\r\n\r\nexport interface DashboardWidget {\r\n    id: string;\r\n    component: ReactNode;\r\n    title: string;\r\n    category?: string;\r\n    defaultVisible?: boolean;\r\n}\r\n\r\ninterface SortableWidgetProps {\r\n    id: string;\r\n    children: ReactNode;\r\n    isDragging?: boolean;\r\n}\r\n\r\nfunction SortableWidget({ id, children, isDragging }: SortableWidgetProps) {\r\n    const { attributes, listeners, setNodeRef, transform, transition } = useSortable({ id });\r\n\r\n    const style = {\r\n        transform: CSS.Transform.toString(transform),\r\n        transition,\r\n        opacity: isDragging ? 0.5 : 1,\r\n    };\r\n\r\n    return (\r\n        <div ref={setNodeRef} style={style} className=\"relative group\">\r\n            {/* Drag Handle */}\r\n            <div\r\n                {...attributes}\r\n                {...listeners}\r\n                className=\"absolute top-2 left-2 p-2 bg-surface-elevated/90 backdrop-blur-sm rounded-lg opacity-0 group-hover:opacity-100 transition-opacity cursor-grab active:cursor-grabbing z-10 shadow-md\"\r\n                title=\"  \"\r\n            >\r\n                <GripVertical className=\"w-4 h-4 text-muted-foreground\" />\r\n            </div>\r\n            {children}\r\n        </div>\r\n    );\r\n}\r\n\r\ninterface DraggableGridProps {\r\n    widgets: DashboardWidget[];\r\n    storageKey?: string;\r\n    className?: string;\r\n}\r\n\r\nexport function DraggableGrid({\r\n    widgets,\r\n    storageKey = \"dashboard-layout\",\r\n    className = \"grid gap-4 md:grid-cols-2 lg:grid-cols-4\"\r\n}: DraggableGridProps) {\r\n    const [items, setItems] = useState<DashboardWidget[]>(widgets);\r\n    const [activeId, setActiveId] = useState<string | null>(null);\r\n    const [isMounted, setIsMounted] = useState(false);\r\n\r\n    // Configure sensors for better drag experience\r\n    const sensors = useSensors(\r\n        useSensor(PointerSensor, {\r\n            activationConstraint: {\r\n                distance: 8, // 8px of movement required before drag starts\r\n            },\r\n        })\r\n    );\r\n\r\n    // Wait for client-side mount to fix hydration mismatch\r\n    useEffect(() => {\r\n        setIsMounted(true);\r\n    }, []);\r\n\r\n    // Load saved order from localStorage on mount\r\n    useEffect(() => {\r\n        if (typeof window === \"undefined\") return;\r\n\r\n        try {\r\n            const saved = localStorage.getItem(storageKey);\r\n            if (saved) {\r\n                const savedOrder: string[] = JSON.parse(saved);\r\n\r\n                // Reorder widgets based on saved order\r\n                const orderedWidgets = savedOrder\r\n                    .map((id) => widgets.find((w) => w.id === id))\r\n                    .filter((w): w is DashboardWidget => w !== undefined);\r\n\r\n                // Add any new widgets that aren't in saved order\r\n                const newWidgets = widgets.filter(\r\n                    (w) => !savedOrder.includes(w.id)\r\n                );\r\n\r\n                setItems([...orderedWidgets, ...newWidgets]);\r\n            }\r\n        } catch (error) {\r\n            console.error(\"Failed to load dashboard layout:\", error);\r\n        }\r\n    }, [widgets, storageKey]);\r\n\r\n    function handleDragStart(event: any) {\r\n        setActiveId(event.active.id);\r\n    }\r\n\r\n    function handleDragEnd(event: DragEndEvent) {\r\n        const { active, over } = event;\r\n        setActiveId(null);\r\n\r\n        if (over && active.id !== over.id) {\r\n            setItems((items) => {\r\n                const oldIndex = items.findIndex((i) => i.id === active.id);\r\n                const newIndex = items.findIndex((i) => i.id === over.id);\r\n                const newOrder = arrayMove(items, oldIndex, newIndex);\r\n\r\n                // Save to localStorage\r\n                try {\r\n                    localStorage.setItem(\r\n                        storageKey,\r\n                        JSON.stringify(newOrder.map((i) => i.id))\r\n                    );\r\n                } catch (error) {\r\n                    console.error(\"Failed to save dashboard layout:\", error);\r\n                }\r\n\r\n                return newOrder;\r\n            });\r\n        }\r\n    }\r\n\r\n    // Render static grid during SSR, draggable grid after mount\r\n    if (!isMounted) {\r\n        return (\r\n            <div className={className}>\r\n                {items.map((widget) => (\r\n                    <div key={widget.id}>\r\n                        {widget.component}\r\n                    </div>\r\n                ))}\r\n            </div>\r\n        );\r\n    }\r\n\r\n    return (\r\n        <DndContext\r\n            sensors={sensors}\r\n            collisionDetection={closestCenter}\r\n            onDragStart={handleDragStart}\r\n            onDragEnd={handleDragEnd}\r\n        >\r\n            <SortableContext items={items.map((i) => i.id)} strategy={rectSortingStrategy}>\r\n                <div className={className}>\r\n                    {items.map((widget) => (\r\n                        <SortableWidget\r\n                            key={widget.id}\r\n                            id={widget.id}\r\n                            isDragging={activeId === widget.id}\r\n                        >\r\n                            {widget.component}\r\n                        </SortableWidget>\r\n                    ))}\r\n                </div>\r\n            </SortableContext>\r\n        </DndContext>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\shavi acadimy\\Shavierp\\components\\dashboard\\stat-card.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\shavi acadimy\\Shavierp\\components\\error-boundary.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":35,"column":37,"nodeType":null,"messageId":"unusedVar","endLine":35,"endColumn":42}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport React, { Component, ReactNode } from 'react';\r\nimport { GlassCard, GlassCardContent, GlassCardHeader } from '@/components/ui/glass-card';\r\nimport { GlassButton } from '@/components/ui/glass-button';\r\nimport { AlertCircle, RefreshCw } from 'lucide-react';\r\n\r\ninterface Props {\r\n    children: ReactNode;\r\n    fallback?: ReactNode;\r\n}\r\n\r\ninterface State {\r\n    hasError: boolean;\r\n    error: Error | null;\r\n    errorInfo: React.ErrorInfo | null;\r\n}\r\n\r\n/**\r\n * Error Boundary Component\r\n * \r\n * Catches JavaScript errors anywhere in the component tree\r\n * and displays a fallback UI instead of crashing the app.\r\n */\r\nexport class ErrorBoundary extends Component<Props, State> {\r\n    constructor(props: Props) {\r\n        super(props);\r\n        this.state = {\r\n            hasError: false,\r\n            error: null,\r\n            errorInfo: null,\r\n        };\r\n    }\r\n\r\n    static getDerivedStateFromError(error: Error): Partial<State> {\r\n        return { hasError: true };\r\n    }\r\n\r\n    componentDidCatch(error: Error, errorInfo: React.ErrorInfo) {\r\n        // Log error to console in development\r\n        if (process.env.NODE_ENV === 'development') {\r\n            console.error('ErrorBoundary caught an error:', error, errorInfo);\r\n        }\r\n\r\n        // TODO: Log to error tracking service (Sentry, LogRocket, etc.)\r\n        // logErrorToService(error, errorInfo);\r\n\r\n        this.setState({\r\n            error,\r\n            errorInfo,\r\n        });\r\n    }\r\n\r\n    handleReset = () => {\r\n        this.setState({\r\n            hasError: false,\r\n            error: null,\r\n            errorInfo: null,\r\n        });\r\n    };\r\n\r\n    render() {\r\n        if (this.state.hasError) {\r\n            // Custom fallback UI\r\n            if (this.props.fallback) {\r\n                return this.props.fallback;\r\n            }\r\n\r\n            // Default fallback UI\r\n            return (\r\n                <div className=\"min-h-screen flex items-center justify-center p-4 bg-background\">\r\n                    <GlassCard intensity=\"medium\" className=\"max-w-2xl w-full\">\r\n                        <GlassCardHeader>\r\n                            <div className=\"flex items-center gap-3 text-destructive\">\r\n                                <AlertCircle className=\"w-8 h-8\" />\r\n                                <div>\r\n                                    <h1 className=\"text-2xl font-bold\">   </h1>\r\n                                    <p className=\"text-sm text-muted-foreground mt-1\">\r\n                                              \r\n                                    </p>\r\n                                </div>\r\n                            </div>\r\n                        </GlassCardHeader>\r\n\r\n                        <GlassCardContent className=\"space-y-4\">\r\n                            {process.env.NODE_ENV === 'development' && this.state.error && (\r\n                                <div className=\"space-y-2\">\r\n                                    <div className=\"p-4 bg-destructive/10 rounded-lg border border-destructive/20\">\r\n                                        <p className=\"font-mono text-sm text-destructive\">\r\n                                            {this.state.error.toString()}\r\n                                        </p>\r\n                                    </div>\r\n\r\n                                    {this.state.errorInfo && (\r\n                                        <details className=\"p-4 bg-muted rounded-lg\">\r\n                                            <summary className=\"cursor-pointer font-semibold mb-2\">\r\n                                                Stack Trace\r\n                                            </summary>\r\n                                            <pre className=\"text-xs overflow-auto p-2 bg-background rounded\">\r\n                                                {this.state.errorInfo.componentStack}\r\n                                            </pre>\r\n                                        </details>\r\n                                    )}\r\n                                </div>\r\n                            )}\r\n\r\n                            <div className=\"flex gap-3\">\r\n                                <GlassButton\r\n                                    variant=\"primary\"\r\n                                    onClick={this.handleReset}\r\n                                    className=\"gap-2\"\r\n                                >\r\n                                    <RefreshCw className=\"w-4 h-4\" />\r\n                                     \r\n                                </GlassButton>\r\n\r\n                                <GlassButton\r\n                                    variant=\"outline\"\r\n                                    onClick={() => window.location.href = '/'}\r\n                                >\r\n                                     \r\n                                </GlassButton>\r\n                            </div>\r\n\r\n                            <p className=\"text-sm text-muted-foreground\">\r\n                                       .\r\n                            </p>\r\n                        </GlassCardContent>\r\n                    </GlassCard>\r\n                </div>\r\n            );\r\n        }\r\n\r\n        return this.props.children;\r\n    }\r\n}\r\n\r\n/**\r\n * Error Fallback Component\r\n * \r\n * Simple fallback UI that can be used as a prop\r\n */\r\nexport function ErrorFallback({ error, reset }: { error?: Error; reset?: () => void }) {\r\n    return (\r\n        <div className=\"flex flex-col items-center justify-center min-h-[400px] p-6 text-center\">\r\n            <AlertCircle className=\"w-16 h-16 text-destructive mb-4\" />\r\n            <h2 className=\"text-xl font-bold mb-2\"> </h2>\r\n            <p className=\"text-muted-foreground mb-4\">\r\n                {error?.message || '    '}\r\n            </p>\r\n            {reset && (\r\n                <GlassButton variant=\"primary\" onClick={reset}>\r\n                     \r\n                </GlassButton>\r\n            )}\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\shavi acadimy\\Shavierp\\components\\layout\\bottom-navigation.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\shavi acadimy\\Shavierp\\components\\layout\\dashboard-layout-client.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\shavi acadimy\\Shavierp\\components\\layout\\header.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\shavi acadimy\\Shavierp\\components\\layout\\sidebar.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'BarChart3' is defined but never used.","line":15,"column":5,"nodeType":null,"messageId":"unusedVar","endLine":15,"endColumn":14}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport Link from \"next/link\";\r\nimport { usePathname } from \"next/navigation\";\r\nimport { cn } from \"@/lib/utils\";\r\nimport {\r\n    LayoutDashboard,\r\n    Users,\r\n    TrendingUp,\r\n    UserCheck,\r\n    GraduationCap,\r\n    Settings,\r\n    DollarSign,\r\n    UserCog,\r\n    BarChart3,\r\n    X,\r\n} from \"lucide-react\";\r\nimport { UserRole } from \"@/lib/types\";\r\nimport { useAppSettings } from \"@/components/settings/app-settings-provider\";\r\n\r\ninterface SidebarProps {\r\n    userRole: UserRole;\r\n    isOpen: boolean;\r\n    onClose: () => void;\r\n}\r\n\r\nexport function Sidebar({ userRole, isOpen, onClose }: SidebarProps) {\r\n    const pathname = usePathname();\r\n    const { branding } = useAppSettings();\r\n\r\n    const menuItems = [\r\n        {\r\n            label: \" \",\r\n            icon: LayoutDashboard,\r\n            href: \"/\",\r\n            roles: [\"admin\", \"marketing\", \"sales\", \"customer_success\", \"trainer\", \"operations\", \"finance\", \"hr\"],\r\n        },\r\n        {\r\n            label: \"\",\r\n            icon: TrendingUp,\r\n            href: \"/marketing\",\r\n            roles: [\"admin\", \"marketing\"],\r\n        },\r\n        {\r\n            label: \"\",\r\n            icon: Users,\r\n            href: \"/sales\",\r\n            roles: [\"admin\", \"sales\"],\r\n        },\r\n        {\r\n            label: \" \",\r\n            icon: UserCheck,\r\n            href: \"/customer-success\",\r\n            roles: [\"admin\", \"customer_success\"],\r\n        },\r\n        {\r\n            label: \"\",\r\n            icon: GraduationCap,\r\n            href: \"/trainers\",\r\n            roles: [\"admin\", \"trainer\"],\r\n        },\r\n        {\r\n            label: \"\",\r\n            icon: Settings,\r\n            href: \"/operations\",\r\n            roles: [\"admin\", \"operations\"],\r\n        },\r\n        {\r\n            label: \"\",\r\n            icon: DollarSign,\r\n            href: \"/finance\",\r\n            roles: [\"admin\", \"finance\"],\r\n        },\r\n        {\r\n            label: \" \",\r\n            icon: UserCog,\r\n            href: \"/hr\",\r\n            roles: [\"admin\", \"hr\"],\r\n        },\r\n        {\r\n            label: \"\",\r\n            icon: Settings,\r\n            href: \"/settings\",\r\n            roles: [\"admin\"],\r\n        },\r\n    ];\r\n\r\n    const visibleItems = menuItems.filter((item) => item.roles.includes(userRole));\r\n\r\n    return (\r\n        <>\r\n            {/* Overlay (Mobile Only) */}\r\n            {isOpen && (\r\n                <div\r\n                    className=\"fixed inset-0 bg-black/50 backdrop-blur-sm z-40 lg:hidden\"\r\n                    onClick={onClose}\r\n                    aria-label=\" \"\r\n                />\r\n            )}\r\n\r\n            {/* Sidebar */}\r\n            <aside\r\n                className={cn(\r\n                    \"fixed top-0 right-0 z-50 h-screen bg-surface-elevated border-l transition-transform duration-300 w-64\",\r\n                    // Mobile: slide in/out\r\n                    isOpen ? \"translate-x-0\" : \"translate-x-full lg:translate-x-0\"\r\n                )}\r\n            >\r\n                <div className=\"flex flex-col h-full\">\r\n                    {/* Header with Close Button (Mobile Only) */}\r\n                    <div className=\"p-6 border-b flex items-center justify-between\">\r\n                        <div className=\"flex items-center gap-3\">\r\n                            <div className=\"w-10 h-10 bg-primary rounded-lg flex items-center justify-center\">\r\n                                <span className=\"text-white font-bold text-xl\">\r\n                                    {branding.logoText || \"S\"}\r\n                                </span>\r\n                            </div>\r\n                            <div>\r\n                                <h1 className=\"text-lg font-bold text-foreground\">\r\n                                    {branding.companyName}\r\n                                </h1>\r\n                                <p className=\"text-xs text-muted-foreground\">\r\n                                    {branding.companyTagline}\r\n                                </p>\r\n                            </div>\r\n                        </div>\r\n\r\n                        {/* Close Button (Mobile Only) */}\r\n                        <button\r\n                            onClick={onClose}\r\n                            className=\"lg:hidden p-2 hover:bg-accent rounded-lg transition-colors\"\r\n                            aria-label=\" \"\r\n                        >\r\n                            <X className=\"w-5 h-5\" />\r\n                        </button>\r\n                    </div>\r\n\r\n                    {/* Navigation */}\r\n                    <nav className=\"flex-1 overflow-y-auto p-4\">\r\n                        <ul className=\"space-y-1\">\r\n                            {visibleItems.map((item) => {\r\n                                const Icon = item.icon;\r\n                                const isActive = pathname === item.href;\r\n\r\n                                return (\r\n                                    <li key={item.href}>\r\n                                        <Link\r\n                                            href={item.href}\r\n                                            className={cn(\r\n                                                \"flex items-center gap-3 px-4 py-3 rounded-lg transition-colors text-sm font-medium\",\r\n                                                isActive\r\n                                                    ? \"bg-primary text-white\"\r\n                                                    : \"text-muted-foreground hover:bg-accent hover:text-foreground\"\r\n                                            )}\r\n                                            onClick={() => {\r\n                                                // Close sidebar on mobile after clicking a link\r\n                                                if (window.innerWidth < 1024) {\r\n                                                    onClose();\r\n                                                }\r\n                                            }}\r\n                                        >\r\n                                            <Icon className=\"w-5 h-5 flex-shrink-0\" />\r\n                                            <span>{item.label}</span>\r\n                                        </Link>\r\n                                    </li>\r\n                                );\r\n                            })}\r\n                        </ul>\r\n                    </nav>\r\n\r\n                    {/* Footer */}\r\n                    <div className=\"p-4 border-t text-center text-xs text-muted-foreground\">\r\n                         2025 Shavi Academy\r\n                    </div>\r\n                </div>\r\n            </aside>\r\n        </>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\shavi acadimy\\Shavierp\\components\\notifications\\notification-item.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\shavi acadimy\\Shavierp\\components\\settings\\app-settings-provider.tsx","messages":[{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\nD:\\shavi acadimy\\Shavierp\\components\\settings\\app-settings-provider.tsx:59:17\n  57 |\n  58 |             if (savedBranding) {\n> 59 |                 setBranding(JSON.parse(savedBranding));\n     |                 ^^^^^^^^^^^ Avoid calling setState() directly within an effect\n  60 |             }\n  61 |             if (savedTheme) {\n  62 |                 setTheme(JSON.parse(savedTheme));","line":59,"column":17,"nodeType":null,"endLine":59,"endColumn":28}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { createContext, useContext, useState, useEffect, ReactNode } from \"react\";\r\n\r\ninterface BrandingSettings {\r\n    companyName: string;\r\n    companyTagline: string;\r\n    logoText: string;\r\n}\r\n\r\ninterface ThemeSettings {\r\n    primaryColor: string;\r\n    accentColor: string;\r\n}\r\n\r\ninterface AppSettings {\r\n    branding: BrandingSettings;\r\n    theme: ThemeSettings;\r\n    updateBranding: (branding: BrandingSettings) => void;\r\n    updateTheme: (theme: ThemeSettings) => void;\r\n}\r\n\r\nconst DEFAULT_BRANDING: BrandingSettings = {\r\n    companyName: \"Shavi Academy OS\",\r\n    companyTagline: \"   \",\r\n    logoText: \"S\",\r\n};\r\n\r\nconst DEFAULT_THEME: ThemeSettings = {\r\n    primaryColor: \"#E60000\",\r\n    accentColor: \"#3f3f46\",\r\n};\r\n\r\nconst AppSettingsContext = createContext<AppSettings | undefined>(undefined);\r\n\r\nexport function useAppSettings() {\r\n    const context = useContext(AppSettingsContext);\r\n    if (!context) {\r\n        throw new Error(\"useAppSettings must be used within AppSettingsProvider\");\r\n    }\r\n    return context;\r\n}\r\n\r\ninterface AppSettingsProviderProps {\r\n    children: ReactNode;\r\n}\r\n\r\nexport function AppSettingsProvider({ children }: AppSettingsProviderProps) {\r\n    const [branding, setBranding] = useState<BrandingSettings>(DEFAULT_BRANDING);\r\n    const [theme, setTheme] = useState<ThemeSettings>(DEFAULT_THEME);\r\n\r\n    // Load settings on mount\r\n    useEffect(() => {\r\n        try {\r\n            const savedBranding = localStorage.getItem(\"app-branding\");\r\n            const savedTheme = localStorage.getItem(\"app-theme\");\r\n\r\n            if (savedBranding) {\r\n                setBranding(JSON.parse(savedBranding));\r\n            }\r\n            if (savedTheme) {\r\n                setTheme(JSON.parse(savedTheme));\r\n            }\r\n        } catch (error) {\r\n            console.error(\"Failed to load app settings:\", error);\r\n        }\r\n    }, []);\r\n\r\n    // Apply theme colors whenever they change\r\n    useEffect(() => {\r\n        document.documentElement.style.setProperty(\"--color-primary\", theme.primaryColor);\r\n        document.documentElement.style.setProperty(\"--color-accent\", theme.accentColor);\r\n    }, [theme]);\r\n\r\n    const updateBranding = (newBranding: BrandingSettings) => {\r\n        setBranding(newBranding);\r\n    };\r\n\r\n    const updateTheme = (newTheme: ThemeSettings) => {\r\n        setTheme(newTheme);\r\n    };\r\n\r\n    return (\r\n        <AppSettingsContext.Provider\r\n            value={{\r\n                branding,\r\n                theme,\r\n                updateBranding,\r\n                updateTheme,\r\n            }}\r\n        >\r\n            {children}\r\n        </AppSettingsContext.Provider>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\shavi acadimy\\Shavierp\\components\\settings\\dashboard-customizer.tsx","messages":[{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\nD:\\shavi acadimy\\Shavierp\\components\\settings\\dashboard-customizer.tsx:41:17\n  39 |             if (saved) {\n  40 |                 const savedConfig: Record<string, boolean> = JSON.parse(saved);\n> 41 |                 setWidgets((prev) =>\n     |                 ^^^^^^^^^^ Avoid calling setState() directly within an effect\n  42 |                     prev.map((w) => ({\n  43 |                         ...w,\n  44 |                         visible: savedConfig[w.id] ?? w.visible,","line":41,"column":17,"nodeType":null,"endLine":41,"endColumn":27}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { useState, useEffect } from \"react\";\r\nimport { Settings, RotateCcw, Eye, EyeOff, Layout, Save } from \"lucide-react\";\r\nimport { GlassCard, GlassCardHeader, GlassCardContent } from \"@/components/ui/glass-card\";\r\nimport { GlassButton } from \"@/components/ui/glass-button\";\r\nimport { cn } from \"@/lib/utils\";\r\n\r\ninterface WidgetConfig {\r\n    id: string;\r\n    title: string;\r\n    visible: boolean;\r\n    category?: string;\r\n}\r\n\r\ninterface DashboardCustomizerProps {\r\n    widgets: WidgetConfig[];\r\n    onVisibilityChange?: (widgetId: string, visible: boolean) => void;\r\n    onReset?: () => void;\r\n    storageKey?: string;\r\n}\r\n\r\nexport function DashboardCustomizer({\r\n    widgets: initialWidgets,\r\n    onVisibilityChange,\r\n    onReset,\r\n    storageKey = \"dashboard-widgets-config\",\r\n}: DashboardCustomizerProps) {\r\n    const [isOpen, setIsOpen] = useState(false);\r\n    const [widgets, setWidgets] = useState<WidgetConfig[]>(initialWidgets);\r\n    const [hasChanges, setHasChanges] = useState(false);\r\n\r\n    // Load saved configuration\r\n    useEffect(() => {\r\n        if (typeof window === \"undefined\") return;\r\n\r\n        try {\r\n            const saved = localStorage.getItem(storageKey);\r\n            if (saved) {\r\n                const savedConfig: Record<string, boolean> = JSON.parse(saved);\r\n                setWidgets((prev) =>\r\n                    prev.map((w) => ({\r\n                        ...w,\r\n                        visible: savedConfig[w.id] ?? w.visible,\r\n                    }))\r\n                );\r\n            }\r\n        } catch (error) {\r\n            console.error(\"Failed to load widget configuration:\", error);\r\n        }\r\n    }, [storageKey]);\r\n\r\n    const toggleVisibility = (id: string) => {\r\n        setWidgets((prev) =>\r\n            prev.map((w) => {\r\n                if (w.id === id) {\r\n                    const newVisible = !w.visible;\r\n                    onVisibilityChange?.(id, newVisible);\r\n                    return { ...w, visible: newVisible };\r\n                }\r\n                return w;\r\n            })\r\n        );\r\n        setHasChanges(true);\r\n    };\r\n\r\n    const saveChanges = () => {\r\n        try {\r\n            const config = widgets.reduce(\r\n                (acc, w) => ({ ...acc, [w.id]: w.visible }),\r\n                {} as Record<string, boolean>\r\n            );\r\n            localStorage.setItem(storageKey, JSON.stringify(config));\r\n            setHasChanges(false);\r\n\r\n            // Show success feedback\r\n            const btn = document.activeElement as HTMLButtonElement;\r\n            if (btn) {\r\n                btn.textContent = \"  \";\r\n                setTimeout(() => {\r\n                    btn.textContent = \" \";\r\n                }, 2000);\r\n            }\r\n        } catch (error) {\r\n            console.error(\"Failed to save widget configuration:\", error);\r\n        }\r\n    };\r\n\r\n    const resetToDefault = () => {\r\n        if (confirm(\"        \")) {\r\n            try {\r\n                localStorage.removeItem(storageKey);\r\n                localStorage.removeItem(\"dashboard-layout\");\r\n                setWidgets(initialWidgets);\r\n                setHasChanges(false);\r\n                onReset?.();\r\n\r\n                // Reload page to apply changes\r\n                window.location.reload();\r\n            } catch (error) {\r\n                console.error(\"Failed to reset configuration:\", error);\r\n            }\r\n        }\r\n    };\r\n\r\n    // Group widgets by category\r\n    const groupedWidgets = widgets.reduce((acc, widget) => {\r\n        const category = widget.category || \"\";\r\n        if (!acc[category]) {\r\n            acc[category] = [];\r\n        }\r\n        acc[category].push(widget);\r\n        return acc;\r\n    }, {} as Record<string, WidgetConfig[]>);\r\n\r\n    return (\r\n        <>\r\n            {/* Floating Action Button */}\r\n            <button\r\n                onClick={() => setIsOpen(!isOpen)}\r\n                className={cn(\r\n                    \"fixed bottom-6 left-6 z-50 p-4 rounded-full shadow-xl transition-all duration-300\",\r\n                    \"bg-primary text-white hover:bg-primary-hover\",\r\n                    \"flex items-center gap-2\",\r\n                    isOpen && \"scale-95\"\r\n                )}\r\n                title=\"  \"\r\n            >\r\n                <Settings className=\"w-5 h-5\" />\r\n                <span className=\"hidden sm:inline text-sm font-medium\"></span>\r\n            </button>\r\n\r\n            {/* Customization Panel */}\r\n            {isOpen && (\r\n                <>\r\n                    {/* Backdrop */}\r\n                    <div\r\n                        className=\"fixed inset-0 bg-black/50 backdrop-blur-sm z-40 transition-opacity\"\r\n                        onClick={() => setIsOpen(false)}\r\n                    />\r\n\r\n                    {/* Panel */}\r\n                    <GlassCard\r\n                        intensity=\"heavy\"\r\n                        className=\"fixed bottom-24 left-6 z-50 w-96 max-h-[600px] overflow-hidden flex flex-col shadow-2xl\"\r\n                    >\r\n                        <GlassCardHeader className=\"border-b\">\r\n                            <div className=\"flex items-center justify-between\">\r\n                                <div className=\"flex items-center gap-2\">\r\n                                    <Layout className=\"w-5 h-5 text-primary\" />\r\n                                    <h3 className=\"text-lg font-bold\">  </h3>\r\n                                </div>\r\n                                <button\r\n                                    onClick={() => setIsOpen(false)}\r\n                                    className=\"p-2 hover:bg-accent rounded-lg transition-colors\"\r\n                                >\r\n                                    \r\n                                </button>\r\n                            </div>\r\n                        </GlassCardHeader>\r\n\r\n                        <GlassCardContent className=\"flex-1 overflow-y-auto\">\r\n                            <div className=\"space-y-4\">\r\n                                {/* Instructions */}\r\n                                <div className=\"p-3 bg-accent/50 rounded-lg text-sm\">\r\n                                    <p className=\"font-medium mb-1\"> :</p>\r\n                                    <p className=\"text-muted-foreground\">\r\n                                               \r\n                                    </p>\r\n                                </div>\r\n\r\n                                {/* Widget List */}\r\n                                {Object.entries(groupedWidgets).map(([category, categoryWidgets]) => (\r\n                                    <div key={category}>\r\n                                        <h4 className=\"text-sm font-semibold text-muted-foreground mb-2\">\r\n                                            {category}\r\n                                        </h4>\r\n                                        <div className=\"space-y-2\">\r\n                                            {categoryWidgets.map((widget) => (\r\n                                                <div\r\n                                                    key={widget.id}\r\n                                                    className=\"flex items-center justify-between p-3 border rounded-lg hover:bg-accent/50 transition-colors\"\r\n                                                >\r\n                                                    <span className=\"text-sm font-medium\">{widget.title}</span>\r\n                                                    <button\r\n                                                        onClick={() => toggleVisibility(widget.id)}\r\n                                                        className={cn(\r\n                                                            \"p-2 rounded-lg transition-all\",\r\n                                                            widget.visible\r\n                                                                ? \"bg-primary/10 text-primary hover:bg-primary/20\"\r\n                                                                : \"bg-muted text-muted-foreground hover:bg-muted/80\"\r\n                                                        )}\r\n                                                        title={widget.visible ? \"\" : \"\"}\r\n                                                    >\r\n                                                        {widget.visible ? (\r\n                                                            <Eye className=\"w-4 h-4\" />\r\n                                                        ) : (\r\n                                                            <EyeOff className=\"w-4 h-4\" />\r\n                                                        )}\r\n                                                    </button>\r\n                                                </div>\r\n                                            ))}\r\n                                        </div>\r\n                                    </div>\r\n                                ))}\r\n                            </div>\r\n                        </GlassCardContent>\r\n\r\n                        {/* Actions Footer */}\r\n                        <div className=\"border-t p-4 space-y-2\">\r\n                            <GlassButton\r\n                                variant=\"primary\"\r\n                                className=\"w-full\"\r\n                                onClick={saveChanges}\r\n                                disabled={!hasChanges}\r\n                            >\r\n                                <Save className=\"w-4 h-4 ml-2\" />\r\n                                 \r\n                            </GlassButton>\r\n                            <GlassButton\r\n                                variant=\"outline\"\r\n                                className=\"w-full\"\r\n                                onClick={resetToDefault}\r\n                            >\r\n                                <RotateCcw className=\"w-4 h-4 ml-2\" />\r\n                                 \r\n                            </GlassButton>\r\n                        </div>\r\n                    </GlassCard>\r\n                </>\r\n            )}\r\n        </>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\shavi acadimy\\Shavierp\\components\\settings\\theme-toggle.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\shavi acadimy\\Shavierp\\components\\tech-panel\\TechLayout.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\shavi acadimy\\Shavierp\\components\\tech-panel\\WebhookTester.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":7,"column":15,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":7,"endColumn":18,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[198,201],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[198,201],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":8,"column":31,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":8,"endColumn":34,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[234,237],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[234,237],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":13,"column":42,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":13,"endColumn":45,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[438,441],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[438,441],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'parseError' is defined but never used.","line":38,"column":26,"nodeType":null,"messageId":"unusedVar","endLine":38,"endColumn":36}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport { useState } from 'react';\r\nimport { BoltIcon, CheckCircleIcon, XCircleIcon, ClockIcon } from '@heroicons/react/24/outline';\r\n\r\ninterface WebhookTesterProps {\r\n    endpoint: any;\r\n    onTestComplete?: (result: any) => void;\r\n}\r\n\r\nexport default function WebhookTester({ endpoint, onTestComplete }: WebhookTesterProps) {\r\n    const [testing, setTesting] = useState(false);\r\n    const [result, setResult] = useState<any>(null);\r\n    const [payload, setPayload] = useState('');\r\n\r\n    // Default payload template\r\n    const defaultPayload = JSON.stringify({\r\n        type: endpoint.event_type || 'test.event',\r\n        id: `test_${Date.now()}`,\r\n        version: '1.0',\r\n        timestamp: new Date().toISOString(),\r\n        data: {\r\n            test: true,\r\n            message: 'Test webhook event'\r\n        }\r\n    }, null, 2);\r\n\r\n    async function handleTest() {\r\n        setTesting(true);\r\n        setResult(null);\r\n\r\n        try {\r\n            // Parse payload if provided\r\n            let parsedPayload = null;\r\n            if (payload.trim()) {\r\n                try {\r\n                    parsedPayload = JSON.parse(payload);\r\n                } catch (parseError) {\r\n                    setResult({\r\n                        success: false,\r\n                        error: 'Invalid JSON payload'\r\n                    });\r\n                    setTesting(false);\r\n                    return;\r\n                }\r\n            }\r\n\r\n            // Send test request\r\n            const response = await fetch(`/api/tech/endpoints/${endpoint.id}/test`, {\r\n                method: 'POST',\r\n                headers: { 'Content-Type': 'application/json' },\r\n                body: JSON.stringify({\r\n                    payload: parsedPayload\r\n                })\r\n            });\r\n\r\n            const data = await response.json();\r\n            setResult(data);\r\n\r\n            if (onTestComplete) {\r\n                onTestComplete(data);\r\n            }\r\n\r\n        } catch (error) {\r\n            setResult({\r\n                success: false,\r\n                error: error instanceof Error ? error.message : 'Test failed'\r\n            });\r\n        } finally {\r\n            setTesting(false);\r\n        }\r\n    }\r\n\r\n    return (\r\n        <div className=\"space-y-6\">\r\n            {/* Header */}\r\n            <div>\r\n                <h3 className=\"text-lg font-semibold text-white flex items-center gap-2\">\r\n                    <BoltIcon className=\"w-5 h-5 text-purple-500\" />\r\n                    Webhook Tester\r\n                </h3>\r\n                <p className=\"text-sm text-slate-400 mt-1\">\r\n                    Test {endpoint.name} webhook endpoint\r\n                </p>\r\n            </div>\r\n\r\n            {/* Endpoint Info */}\r\n            <div className=\"bg-slate-800/30 border border-slate-700 rounded-lg p-4\">\r\n                <div className=\"grid grid-cols-2 gap-4 text-sm\">\r\n                    <div>\r\n                        <span className=\"text-slate-400\">Endpoint:</span>\r\n                        <p className=\"text-white font-mono mt-1\">{endpoint.endpoint_path}</p>\r\n                    </div>\r\n                    <div>\r\n                        <span className=\"text-slate-400\">Method:</span>\r\n                        <p className=\"text-white font-mono mt-1\">{endpoint.method || 'POST'}</p>\r\n                    </div>\r\n                    <div>\r\n                        <span className=\"text-slate-400\">Event Type:</span>\r\n                        <p className=\"text-white font-mono mt-1\">{endpoint.event_type || 'N/A'}</p>\r\n                    </div>\r\n                    <div>\r\n                        <span className=\"text-slate-400\">Status:</span>\r\n                        <p className=\"text-white mt-1\">\r\n                            {endpoint.enabled ? (\r\n                                <span className=\"text-green-400\">Enabled</span>\r\n                            ) : (\r\n                                <span className=\"text-red-400\">Disabled</span>\r\n                            )}\r\n                        </p>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\r\n            {/* Payload Editor */}\r\n            <div>\r\n                <label className=\"block text-sm font-medium text-slate-300 mb-2\">\r\n                    Test Payload (JSON)\r\n                </label>\r\n                <textarea\r\n                    value={payload}\r\n                    onChange={(e) => setPayload(e.target.value)}\r\n                    placeholder={defaultPayload}\r\n                    rows={12}\r\n                    className=\"w-full px-3 py-2 bg-slate-900 border border-slate-700 rounded-lg text-white font-mono text-sm focus:outline-none focus:ring-2 focus:ring-purple-600\"\r\n                />\r\n                <p className=\"text-xs text-slate-400 mt-2\">\r\n                    Leave empty to use default template\r\n                </p>\r\n            </div>\r\n\r\n            {/* Test Button */}\r\n            <button\r\n                onClick={handleTest}\r\n                disabled={testing || !endpoint.enabled}\r\n                className={`\r\n                    w-full px-4 py-3 rounded-lg font-medium transition-colors\r\n                    flex items-center justify-center gap-2\r\n                    ${testing\r\n                        ? 'bg-slate-700 text-slate-400 cursor-not-allowed'\r\n                        : endpoint.enabled\r\n                            ? 'bg-purple-600 text-white hover:bg-purple-700'\r\n                            : 'bg-slate-700 text-slate-400 cursor-not-allowed'\r\n                    }\r\n                `}\r\n            >\r\n                <BoltIcon className=\"w-5 h-5\" />\r\n                {testing ? 'Testing...' : 'Send Test Webhook'}\r\n            </button>\r\n\r\n            {/* Result Display */}\r\n            {result && (\r\n                <div className={`\r\n                    border rounded-lg overflow-hidden\r\n                    ${result.success\r\n                        ? 'border-green-600 bg-green-900/20'\r\n                        : 'border-red-600 bg-red-900/20'\r\n                    }\r\n                `}>\r\n                    {/* Result Header */}\r\n                    <div className={`\r\n                        px-4 py-3 border-b flex items-center justify-between\r\n                        ${result.success ? 'border-green-600' : 'border-red-600'}\r\n                    `}>\r\n                        <div className=\"flex items-center gap-2\">\r\n                            {result.success ? (\r\n                                <>\r\n                                    <CheckCircleIcon className=\"w-5 h-5 text-green-400\" />\r\n                                    <span className=\"font-medium text-green-400\">Test Successful</span>\r\n                                </>\r\n                            ) : (\r\n                                <>\r\n                                    <XCircleIcon className=\"w-5 h-5 text-red-400\" />\r\n                                    <span className=\"font-medium text-red-400\">Test Failed</span>\r\n                                </>\r\n                            )}\r\n                        </div>\r\n\r\n                        {result.test?.performance && (\r\n                            <div className=\"flex items-center gap-2 text-sm text-slate-300\">\r\n                                <ClockIcon className=\"w-4 h-4\" />\r\n                                <span>{result.test.performance.duration_ms}ms</span>\r\n                            </div>\r\n                        )}\r\n                    </div>\r\n\r\n                    {/* Response Details */}\r\n                    <div className=\"p-4 space-y-4\">\r\n                        {/* Status */}\r\n                        {result.test?.response?.status && (\r\n                            <div>\r\n                                <span className=\"text-sm text-slate-400\">HTTP Status:</span>\r\n                                <p className={`\r\n                                    font-mono text-sm mt-1\r\n                                    ${result.test.response.status < 400\r\n                                        ? 'text-green-400'\r\n                                        : 'text-red-400'\r\n                                    }\r\n                                `}>\r\n                                    {result.test.response.status} {result.test.response.ok ? 'OK' : 'Error'}\r\n                                </p>\r\n                            </div>\r\n                        )}\r\n\r\n                        {/* Error */}\r\n                        {result.error && (\r\n                            <div>\r\n                                <span className=\"text-sm text-slate-400\">Error:</span>\r\n                                <p className=\"text-red-400 font-mono text-sm mt-1\">{result.error}</p>\r\n                            </div>\r\n                        )}\r\n\r\n                        {/* Response Body */}\r\n                        {result.test?.response?.body && (\r\n                            <div>\r\n                                <span className=\"text-sm text-slate-400\">Response Body:</span>\r\n                                <pre className=\"mt-2 p-3 bg-slate-900 border border-slate-700 rounded text-xs text-slate-300 overflow-auto max-h-60\">\r\n                                    {JSON.stringify(result.test.response.body, null, 2)}\r\n                                </pre>\r\n                            </div>\r\n                        )}\r\n\r\n                        {/* Request Info */}\r\n                        {result.test?.request && (\r\n                            <details className=\"text-sm\">\r\n                                <summary className=\"text-slate-400 cursor-pointer hover:text-slate-300\">\r\n                                    View Request Details\r\n                                </summary>\r\n                                <pre className=\"mt-2 p-3 bg-slate-900 border border-slate-700 rounded text-xs text-slate-300 overflow-auto\">\r\n                                    {JSON.stringify(result.test.request, null, 2)}\r\n                                </pre>\r\n                            </details>\r\n                        )}\r\n                    </div>\r\n                </div>\r\n            )}\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\shavi acadimy\\Shavierp\\components\\theme-provider.tsx","messages":[{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\nD:\\shavi acadimy\\Shavierp\\components\\theme-provider.tsx:23:13\n  21 |         const savedTheme = localStorage.getItem(\"shavi-theme\") as Theme;\n  22 |         if (savedTheme) {\n> 23 |             setTheme(savedTheme);\n     |             ^^^^^^^^ Avoid calling setState() directly within an effect\n  24 |         }\n  25 |     }, []);\n  26 |","line":23,"column":13,"nodeType":null,"endLine":23,"endColumn":21},{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\nD:\\shavi acadimy\\Shavierp\\components\\theme-provider.tsx:43:9\n  41 |\n  42 |         // Apply theme\n> 43 |         setResolvedTheme(appliedTheme);\n     |         ^^^^^^^^^^^^^^^^ Avoid calling setState() directly within an effect\n  44 |         root.setAttribute(\"data-theme\", appliedTheme);\n  45 |\n  46 |         // Save to localStorage","line":43,"column":9,"nodeType":null,"endLine":43,"endColumn":25}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { createContext, useContext, useEffect, useState, ReactNode } from \"react\";\r\n\r\ntype Theme = \"light\" | \"dark\" | \"system\";\r\n\r\ninterface ThemeContextType {\r\n    theme: Theme;\r\n    setTheme: (theme: Theme) => void;\r\n    resolvedTheme: \"light\" | \"dark\";\r\n}\r\n\r\nconst ThemeContext = createContext<ThemeContextType | undefined>(undefined);\r\n\r\nexport function ThemeProvider({ children }: { children: ReactNode }) {\r\n    const [theme, setTheme] = useState<Theme>(\"system\");\r\n    const [resolvedTheme, setResolvedTheme] = useState<\"light\" | \"dark\">(\"light\");\r\n\r\n    useEffect(() => {\r\n        // Load saved theme from localStorage\r\n        const savedTheme = localStorage.getItem(\"shavi-theme\") as Theme;\r\n        if (savedTheme) {\r\n            setTheme(savedTheme);\r\n        }\r\n    }, []);\r\n\r\n    useEffect(() => {\r\n        const root = window.document.documentElement;\r\n\r\n        // Determine the actual theme to apply\r\n        let appliedTheme: \"light\" | \"dark\";\r\n\r\n        if (theme === \"system\") {\r\n            const systemTheme = window.matchMedia(\"(prefers-color-scheme: dark)\").matches\r\n                ? \"dark\"\r\n                : \"light\";\r\n            appliedTheme = systemTheme;\r\n        } else {\r\n            appliedTheme = theme;\r\n        }\r\n\r\n        // Apply theme\r\n        setResolvedTheme(appliedTheme);\r\n        root.setAttribute(\"data-theme\", appliedTheme);\r\n\r\n        // Save to localStorage\r\n        localStorage.setItem(\"shavi-theme\", theme);\r\n\r\n        // Listen for system theme changes when in system mode\r\n        if (theme === \"system\") {\r\n            const mediaQuery = window.matchMedia(\"(prefers-color-scheme: dark)\");\r\n            const handleChange = (e: MediaQueryListEvent) => {\r\n                const newTheme = e.matches ? \"dark\" : \"light\";\r\n                setResolvedTheme(newTheme);\r\n                root.setAttribute(\"data-theme\", newTheme);\r\n            };\r\n\r\n            mediaQuery.addEventListener(\"change\", handleChange);\r\n            return () => mediaQuery.removeEventListener(\"change\", handleChange);\r\n        }\r\n    }, [theme]);\r\n\r\n    return (\r\n        <ThemeContext.Provider value={{ theme, setTheme, resolvedTheme }}>\r\n            {children}\r\n        </ThemeContext.Provider>\r\n    );\r\n}\r\n\r\nexport function useTheme() {\r\n    const context = useContext(ThemeContext);\r\n    if (context === undefined) {\r\n        throw new Error(\"useTheme must be used within a ThemeProvider\");\r\n    }\r\n    return context;\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\shavi acadimy\\Shavierp\\components\\ui\\avatar.tsx","messages":[{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":40,"column":21,"nodeType":"JSXOpeningElement","endLine":45,"endColumn":23}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import * as React from \"react\";\r\nimport { cn } from \"@/lib/utils\";\r\nimport { User } from \"@/lib/types\";\r\n\r\nexport interface AvatarProps extends React.HTMLAttributes<HTMLDivElement> {\r\n    src?: string;\r\n    alt?: string;\r\n    fallback?: string;\r\n    name?: string; // For simple name string\r\n    user?: User;   // For User object\r\n}\r\n\r\nconst Avatar = React.forwardRef<HTMLDivElement, AvatarProps>(\r\n    ({ className, src, alt, fallback, name, user, ...props }, ref) => {\r\n        const [imageError, setImageError] = React.useState(false);\r\n\r\n        // Determine display name from multiple sources\r\n        const displayName = name || user?.full_name || fallback || alt || \"User\";\r\n        const avatarSrc = src || user?.avatar_url;\r\n\r\n        const initials = React.useMemo(() => {\r\n            return displayName\r\n                .split(\" \")\r\n                .map((n) => n[0])\r\n                .join(\"\")\r\n                .toUpperCase()\r\n                .slice(0, 2);\r\n        }, [displayName]);\r\n\r\n        return (\r\n            <div\r\n                ref={ref}\r\n                className={cn(\r\n                    \"relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full\",\r\n                    className\r\n                )}\r\n                {...props}\r\n            >\r\n                {avatarSrc && !imageError ? (\r\n                    <img\r\n                        src={avatarSrc}\r\n                        alt={displayName}\r\n                        className=\"aspect-square h-full w-full object-cover\"\r\n                        onError={() => setImageError(true)}\r\n                    />\r\n                ) : (\r\n                    <div className=\"flex h-full w-full items-center justify-center bg-primary text-primary-foreground text-sm font-medium\">\r\n                        {initials}\r\n                    </div>\r\n                )}\r\n            </div>\r\n        );\r\n    }\r\n);\r\nAvatar.displayName = \"Avatar\";\r\n\r\nexport { Avatar };\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\shavi acadimy\\Shavierp\\components\\ui\\badge.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\shavi acadimy\\Shavierp\\components\\ui\\button.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\shavi acadimy\\Shavierp\\components\\ui\\card.tsx","messages":[{"ruleId":"@typescript-eslint/no-empty-object-type","severity":2,"message":"An interface declaring no members is equivalent to its supertype.","line":4,"column":18,"nodeType":"Identifier","messageId":"noEmptyInterfaceWithSuper","endLine":4,"endColumn":27,"suggestions":[{"messageId":"replaceEmptyInterfaceWithSuper","fix":{"range":[77,145],"text":"type CardProps = React.HTMLAttributes<HTMLDivElement>"},"desc":"Replace empty interface with a type alias."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import * as React from \"react\";\r\nimport { cn } from \"@/lib/utils\";\r\n\r\nexport interface CardProps extends React.HTMLAttributes<HTMLDivElement> { }\r\n\r\nconst Card = React.forwardRef<HTMLDivElement, CardProps>(\r\n    ({ className, ...props }, ref) => (\r\n        <div\r\n            ref={ref}\r\n            className={cn(\r\n                \"rounded-lg border border-border bg-background text-foreground shadow-sm\",\r\n                className\r\n            )}\r\n            {...props}\r\n        />\r\n    )\r\n);\r\nCard.displayName = \"Card\";\r\n\r\nconst CardHeader = React.forwardRef<\r\n    HTMLDivElement,\r\n    React.HTMLAttributes<HTMLDivElement>\r\n>(({ className, ...props }, ref) => (\r\n    <div\r\n        ref={ref}\r\n        className={cn(\"flex flex-col space-y-1.5 p-6\", className)}\r\n        {...props}\r\n    />\r\n));\r\nCardHeader.displayName = \"CardHeader\";\r\n\r\nconst CardTitle = React.forwardRef<\r\n    HTMLParagraphElement,\r\n    React.HTMLAttributes<HTMLHeadingElement>\r\n>(({ className, ...props }, ref) => (\r\n    <h3\r\n        ref={ref}\r\n        className={cn(\r\n            \"text-2xl font-semibold leading-none tracking-tight\",\r\n            className\r\n        )}\r\n        {...props}\r\n    />\r\n));\r\nCardTitle.displayName = \"CardTitle\";\r\n\r\nconst CardDescription = React.forwardRef<\r\n    HTMLParagraphElement,\r\n    React.HTMLAttributes<HTMLParagraphElement>\r\n>(({ className, ...props }, ref) => (\r\n    <p\r\n        ref={ref}\r\n        className={cn(\"text-sm text-muted-foreground\", className)}\r\n        {...props}\r\n    />\r\n));\r\nCardDescription.displayName = \"CardDescription\";\r\n\r\nconst CardContent = React.forwardRef<\r\n    HTMLDivElement,\r\n    React.HTMLAttributes<HTMLDivElement>\r\n>(({ className, ...props }, ref) => (\r\n    <div ref={ref} className={cn(\"p-6 pt-0\", className)} {...props} />\r\n));\r\nCardContent.displayName = \"CardContent\";\r\n\r\nconst CardFooter = React.forwardRef<\r\n    HTMLDivElement,\r\n    React.HTMLAttributes<HTMLDivElement>\r\n>(({ className, ...props }, ref) => (\r\n    <div\r\n        ref={ref}\r\n        className={cn(\"flex items-center p-6 pt-0\", className)}\r\n        {...props}\r\n    />\r\n));\r\nCardFooter.displayName = \"CardFooter\";\r\n\r\nexport { Card, CardHeader, CardFooter, CardTitle, CardDescription, CardContent };\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\shavi acadimy\\Shavierp\\components\\ui\\glass-button.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\shavi acadimy\\Shavierp\\components\\ui\\glass-card.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\shavi acadimy\\Shavierp\\components\\ui\\input.tsx","messages":[{"ruleId":"@typescript-eslint/no-empty-object-type","severity":2,"message":"An interface declaring no members is equivalent to its supertype.","line":4,"column":18,"nodeType":"Identifier","messageId":"noEmptyInterfaceWithSuper","endLine":4,"endColumn":28,"suggestions":[{"messageId":"replaceEmptyInterfaceWithSuper","fix":{"range":[77,158],"text":"type InputProps = React.InputHTMLAttributes<HTMLInputElement>"},"desc":"Replace empty interface with a type alias."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import * as React from \"react\";\r\nimport { cn } from \"@/lib/utils\";\r\n\r\nexport interface InputProps\r\n    extends React.InputHTMLAttributes<HTMLInputElement> { }\r\n\r\nconst Input = React.forwardRef<HTMLInputElement, InputProps>(\r\n    ({ className, type, ...props }, ref) => {\r\n        return (\r\n            <input\r\n                type={type}\r\n                className={cn(\r\n                    \"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50\",\r\n                    className\r\n                )}\r\n                ref={ref}\r\n                {...props}\r\n            />\r\n        );\r\n    }\r\n);\r\nInput.displayName = \"Input\";\r\n\r\nexport { Input };\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\shavi acadimy\\Shavierp\\components\\ui\\loading.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\shavi acadimy\\Shavierp\\eslint.config.mjs","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\shavi acadimy\\Shavierp\\lib\\auth.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":95,"column":14,"nodeType":null,"messageId":"unusedVar","endLine":95,"endColumn":19}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { cookies } from \"next/headers\";\r\nimport { User, UserRole } from \"./types\";\r\n\r\n// Mock users for development\r\nconst MOCK_USERS: Record<string, { password: string; user: User }> = {\r\n    \"admin@shavi.com\": {\r\n        password: \"admin123\",\r\n        user: {\r\n            id: \"1\",\r\n            email: \"admin@shavi.com\",\r\n            full_name: \" \",\r\n            role: \"admin\",\r\n            department: \"management\",\r\n            status: \"active\",\r\n            avatar_url: \"\",\r\n            created_at: new Date().toISOString(),\r\n            updated_at: new Date().toISOString(),\r\n        },\r\n    },\r\n    \"sales@shavi.com\": {\r\n        password: \"sales123\",\r\n        user: {\r\n            id: \"2\",\r\n            email: \"sales@shavi.com\",\r\n            full_name: \" \",\r\n            role: \"sales\",\r\n            department: \"sales\",\r\n            status: \"active\",\r\n            avatar_url: \"\",\r\n            created_at: new Date().toISOString(),\r\n            updated_at: new Date().toISOString(),\r\n        },\r\n    },\r\n    \"marketing@shavi.com\": {\r\n        password: \"marketing123\",\r\n        user: {\r\n            id: \"3\",\r\n            email: \"marketing@shavi.com\",\r\n            full_name: \" \",\r\n            role: \"marketing\",\r\n            department: \"marketing\",\r\n            status: \"active\",\r\n            avatar_url: \"\",\r\n            created_at: new Date().toISOString(),\r\n            updated_at: new Date().toISOString(),\r\n        },\r\n    },\r\n};\r\n\r\nexport interface SessionData {\r\n    user: User;\r\n    expiresAt: number;\r\n}\r\n\r\nexport async function createSession(user: User): Promise<string> {\r\n    const sessionData: SessionData = {\r\n        user,\r\n        expiresAt: Date.now() + 24 * 60 * 60 * 1000, // 24 hours\r\n    };\r\n\r\n    const sessionToken = Buffer.from(JSON.stringify(sessionData)).toString(\"base64\");\r\n\r\n    const cookieStore = await cookies();\r\n    cookieStore.set(\"session\", sessionToken, {\r\n        httpOnly: true,\r\n        secure: process.env.NODE_ENV === \"production\",\r\n        sameSite: \"lax\",\r\n        maxAge: 24 * 60 * 60, // 24 hours in seconds\r\n        path: \"/\",\r\n    });\r\n\r\n    return sessionToken;\r\n}\r\n\r\nexport async function getSession(): Promise<SessionData | null> {\r\n    const cookieStore = await cookies();\r\n    const sessionToken = cookieStore.get(\"session\");\r\n\r\n    if (!sessionToken) {\r\n        return null;\r\n    }\r\n\r\n    try {\r\n        const sessionData: SessionData = JSON.parse(\r\n            Buffer.from(sessionToken.value, \"base64\").toString()\r\n        );\r\n\r\n        // Check if session is expired\r\n        if (sessionData.expiresAt < Date.now()) {\r\n            await destroySession();\r\n            return null;\r\n        }\r\n\r\n        return sessionData;\r\n    } catch (error) {\r\n        return null;\r\n    }\r\n}\r\n\r\nexport async function destroySession(): Promise<void> {\r\n    const cookieStore = await cookies();\r\n    cookieStore.delete(\"session\");\r\n}\r\n\r\nexport async function verifyCredentials(\r\n    email: string,\r\n    password: string\r\n): Promise<User | null> {\r\n    const userRecord = MOCK_USERS[email];\r\n\r\n    if (!userRecord || userRecord.password !== password) {\r\n        return null;\r\n    }\r\n\r\n    return userRecord.user;\r\n}\r\n\r\nexport function hasRole(user: User, allowedRoles: UserRole[]): boolean {\r\n    return allowedRoles.includes(user.role);\r\n}\r\n\r\nexport function canAccessDepartment(user: User, department: string): boolean {\r\n    // Admin can access all departments\r\n    if (user.role === \"admin\") {\r\n        return true;\r\n    }\r\n\r\n    // Users can access their own department\r\n    return user.department === department;\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\shavi acadimy\\Shavierp\\lib\\encryption\\secrets.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\shavi acadimy\\Shavierp\\lib\\intelligence\\analytics.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":114,"column":58,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":114,"endColumn":61,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3637,3640],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3637,3640],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { createClient } from '@/lib/supabase/server';\r\n\r\ninterface RevenueForecast {\r\n    nextMonth: number;\r\n    confidence: number;\r\n    trend: 'up' | 'down' | 'stable';\r\n}\r\n\r\ninterface ChurnRisk {\r\n    studentId: string;\r\n    riskScore: number; // 0-100\r\n    reasons: string[];\r\n}\r\n\r\n/**\r\n * Predictive Analytics Engine\r\n */\r\nexport async function getRevenueForecast(): Promise<RevenueForecast> {\r\n    const supabase = createClient();\r\n\r\n    // Get last 6 months of \"Closed Won\" deals\r\n    const sixMonthsAgo = new Date();\r\n    sixMonthsAgo.setMonth(sixMonthsAgo.getMonth() - 6);\r\n\r\n    const { data: deals } = await supabase\r\n        .from('deals')\r\n        .select('value, closed_at')\r\n        .eq('stage', 'closed_won')\r\n        .gte('closed_at', sixMonthsAgo.toISOString())\r\n        .order('closed_at', { ascending: true });\r\n\r\n    if (!deals || deals.length < 5) {\r\n        return { nextMonth: 0, confidence: 0, trend: 'stable' };\r\n    }\r\n\r\n    // Group by month\r\n    const monthlyRevenue: Record<string, number> = {};\r\n    deals.forEach(d => {\r\n        const month = d.closed_at.substring(0, 7); // YYYY-MM\r\n        monthlyRevenue[month] = (monthlyRevenue[month] || 0) + Number(d.value);\r\n    });\r\n\r\n    const values = Object.values(monthlyRevenue);\r\n    if (values.length < 2) return { nextMonth: values[0] || 0, confidence: 0.1, trend: 'stable' };\r\n\r\n    // Simple Linear Regression\r\n    const n = values.length;\r\n    const x = Array.from({ length: n }, (_, i) => i); // 0, 1, 2...\r\n    const y = values;\r\n\r\n    const sumX = x.reduce((a, b) => a + b, 0);\r\n    const sumY = y.reduce((a, b) => a + b, 0);\r\n    const sumXY = x.reduce((a, i) => a + (i * y[i]), 0);\r\n    const sumXX = x.reduce((a, b) => a + (b * b), 0);\r\n\r\n    const slope = (n * sumXY - sumX * sumY) / (n * sumXX - sumX * sumX);\r\n    const intercept = (sumY - slope * sumX) / n;\r\n\r\n    const nextMonthPrediction = slope * n + intercept;\r\n    const trend = slope > 100 ? 'up' : slope < -100 ? 'down' : 'stable';\r\n\r\n    return {\r\n        nextMonth: Math.max(0, Math.round(nextMonthPrediction)),\r\n        confidence: 0.75, // Placeholder confidence (could calculate R-squared)\r\n        trend\r\n    };\r\n}\r\n\r\n/**\r\n * Detect At-Risk Students (Churn Prediction)\r\n */\r\nexport async function detectChurnRisks(): Promise<ChurnRisk[]> {\r\n    const supabase = createClient();\r\n\r\n    // Fetch active students with engagement metrics\r\n    const { data: students } = await supabase\r\n        .from('students')\r\n        .select(`\r\n      id, full_name, engagement_score, attendance_rate, last_login_at,\r\n      tickets:support_tickets(priority, status)\r\n    `)\r\n        .eq('status', 'active');\r\n\r\n    const risks: ChurnRisk[] = [];\r\n\r\n    if (!students) return [];\r\n\r\n    for (const s of students) {\r\n        let riskScore = 0;\r\n        const reasons: string[] = [];\r\n\r\n        // Factor 1: Low Engagement (< 40%)\r\n        if (s.engagement_score < 40) {\r\n            riskScore += 40;\r\n            reasons.push('Low Engagement Score');\r\n        }\r\n\r\n        // Factor 2: Low Attendance (< 50%)\r\n        if (s.attendance_rate < 50) {\r\n            riskScore += 30;\r\n            reasons.push('Poor Attendance');\r\n        }\r\n\r\n        // Factor 3: Ghosting (No login > 14 days)\r\n        if (s.last_login_at) {\r\n            const daysSinceLogin = (Date.now() - new Date(s.last_login_at).getTime()) / (1000 * 3600 * 24);\r\n            if (daysSinceLogin > 14) {\r\n                riskScore += 20;\r\n                reasons.push('Inactive > 14 days');\r\n            }\r\n        }\r\n\r\n        // Factor 4: Unresolved High Priority Tickets\r\n        const openCriticalTickets = s.tickets.filter((t: any) => t.status !== 'closed' && t.priority === 'high').length;\r\n        if (openCriticalTickets > 0) {\r\n            riskScore += 30;\r\n            reasons.push('Unresolved Critical Support Issues');\r\n        }\r\n\r\n        if (riskScore >= 50) {\r\n            risks.push({\r\n                studentId: s.id,\r\n                riskScore: Math.min(riskScore, 100),\r\n                reasons\r\n            });\r\n\r\n            // Auto-flag in database\r\n            await supabase.from('students').update({ status: 'at_risk' }).eq('id', s.id);\r\n        }\r\n    }\r\n\r\n    return risks;\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\shavi acadimy\\Shavierp\\lib\\intelligence\\routing.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":68,"column":33,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":68,"endColumn":36,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2186,2189],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2186,2189],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":68,"column":48,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":68,"endColumn":51,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2201,2204],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2201,2204],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":77,"column":63,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":77,"endColumn":66,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2507,2510],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2507,2510],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":97,"column":61,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":97,"endColumn":64,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3218,3221],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3218,3221],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { createClient } from '@/lib/supabase/server';\r\n\r\ninterface RoutingResult {\r\n    assignedTo: string | null;  // User ID\r\n    ruleApplied: string;\r\n    success: boolean;\r\n}\r\n\r\n/**\r\n * Smart Routing Engine\r\n * Assigns a lead (or other resource) to the best available agent.\r\n */\r\nexport async function routeLead(leadId: string): Promise<RoutingResult> {\r\n    const supabase = createClient();\r\n\r\n    // 1. Fetch Lead\r\n    const { data: lead, error } = await supabase\r\n        .from('leads')\r\n        .select('*')\r\n        .eq('id', leadId)\r\n        .single();\r\n\r\n    if (error || !lead) throw new Error('Lead not found');\r\n\r\n    // 2. Fetch Active Routing Rules for 'lead_created'\r\n    const { data: rules } = await supabase\r\n        .from('routing_rules')\r\n        .select('*')\r\n        .eq('trigger_event', 'lead_created')\r\n        .eq('is_active', true)\r\n        .order('priority', { ascending: false }); // High priority first\r\n\r\n    if (!rules || rules.length === 0) {\r\n        return { assignedTo: null, ruleApplied: 'no_rules', success: false };\r\n    }\r\n\r\n    // 3. Evaluate Rules\r\n    for (const rule of rules) {\r\n        const isMatch = evaluateCriteria(lead, rule.criteria);\r\n\r\n        if (isMatch) {\r\n            // 4. Execute Action (Assign)\r\n            const action = rule.action_config;\r\n\r\n            if (action.type === 'assign_round_robin') {\r\n                const targetRole = action.target_role || 'sales_agent';\r\n                const agentId = await getNextAgentRoundRobin(targetRole, supabase);\r\n\r\n                if (agentId) {\r\n                    // Assign lead\r\n                    await supabase.from('leads').update({ assigned_to: agentId }).eq('id', leadId);\r\n                    await incrementAgentLoad(agentId, supabase);\r\n\r\n                    return { assignedTo: agentId, ruleApplied: rule.name, success: true };\r\n                }\r\n            }\r\n\r\n            // Add other assignment types here (e.g., 'assign_specific_user')\r\n        }\r\n    }\r\n\r\n    // Default Fallback\r\n    return { assignedTo: null, ruleApplied: 'fallback (no match)', success: false };\r\n}\r\n\r\n// ---------------- Helpers ----------------\r\n\r\nfunction evaluateCriteria(data: any, criteria: any): boolean {\r\n    // Simple subset match\r\n    // e.g. criteria: { \"source\": \"linkedin\" } -> data.source === \"linkedin\"\r\n    for (const key in criteria) {\r\n        if (data[key] !== criteria[key]) return false;\r\n    }\r\n    return true;\r\n}\r\n\r\nasync function getNextAgentRoundRobin(role: string, supabase: any): Promise<string | null> {\r\n    // Find eligible agents\r\n    const { data: agents } = await supabase\r\n        .from('profiles')\r\n        .select('*')\r\n        .eq('role', role)\r\n        .eq('status', 'online') // Only assign to online agents\r\n        .lt('current_load', 50)  // Ensure not overloaded (hardcoded max for now, or use max_load col)\r\n        .order('current_load', { ascending: true }) // Least loaded first\r\n        .limit(1);\r\n\r\n    if (agents && agents.length > 0) {\r\n        return agents[0].user_id;\r\n    }\r\n\r\n    // If no online agents, try offline but available? Or queue?\r\n    // For now, return null.\r\n    return null;\r\n}\r\n\r\nasync function incrementAgentLoad(userId: string, supabase: any) {\r\n    // Atomic increment would be better, but this suffices for MVP\r\n    // Ideally use a stored procedure or rpc\r\n    const { data: profile } = await supabase.from('profiles').select('current_load').eq('user_id', userId).single();\r\n    if (profile) {\r\n        await supabase.from('profiles').update({ current_load: profile.current_load + 1 }).eq('user_id', userId);\r\n    }\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\shavi acadimy\\Shavierp\\lib\\intelligence\\scoring.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":72,"column":46,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":72,"endColumn":49,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2329,2332],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2329,2332],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":73,"column":46,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":73,"endColumn":49,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2427,2430],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2427,2430],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'websiteVisits' is assigned a value but never used.","line":74,"column":11,"nodeType":null,"messageId":"unusedVar","endLine":74,"endColumn":24},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":74,"column":49,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":74,"endColumn":52,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2528,2531],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2528,2531],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":75,"column":44,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":75,"endColumn":47,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2621,2624],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2621,2624],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { createClient } from '@/lib/supabase/server';\r\n\r\ninterface ScoreComponent {\r\n    category: 'demographics' | 'engagement' | 'behavior';\r\n    score: number;\r\n    reason: string;\r\n}\r\n\r\ninterface ScoringResult {\r\n    totalScore: number;\r\n    breakdown: ScoreComponent[];\r\n    level: 'cold' | 'warm' | 'hot';\r\n}\r\n\r\n/**\r\n * AI Lead Scoring Engine\r\n * Calculates a score (0-100) for a lead based on multiple factors.\r\n */\r\nexport async function calculateLeadScore(leadId: string): Promise<ScoringResult> {\r\n    const supabase = createClient();\r\n    let totalScore = 0;\r\n    const breakdown: ScoreComponent[] = [];\r\n\r\n    // 1. Fetch Lead Data with detailed info\r\n    const { data: lead, error } = await supabase\r\n        .from('leads')\r\n        .select('*, activities:lead_activities(*)')\r\n        .eq('id', leadId)\r\n        .single();\r\n\r\n    if (error || !lead) {\r\n        throw new Error(`Lead not found or error fetching: ${error?.message}`);\r\n    }\r\n\r\n    // --- A. Demographics (Max 30 pts) ---\r\n    let demoScore = 0;\r\n\r\n    // Job Title Check\r\n    const tier1Titles = ['ceo', 'cto', 'founder', 'director', 'vp'];\r\n    const tier2Titles = ['manager', 'head', 'lead'];\r\n\r\n    if (lead.job_title) {\r\n        const title = lead.job_title.toLowerCase();\r\n        if (tier1Titles.some(t => title.includes(t))) {\r\n            demoScore += 15;\r\n            breakdown.push({ category: 'demographics', score: 15, reason: 'High-value Job Title' });\r\n        } else if (tier2Titles.some(t => title.includes(t))) {\r\n            demoScore += 10;\r\n            breakdown.push({ category: 'demographics', score: 10, reason: 'Mid-level Job Title' });\r\n        }\r\n    }\r\n\r\n    // Company / Industry (Placeholder logic)\r\n    if (lead.company) {\r\n        demoScore += 5;\r\n        breakdown.push({ category: 'demographics', score: 5, reason: 'Company info provided' });\r\n    }\r\n\r\n    // Source Quality\r\n    if (['referral', 'linkedin_ad'].includes(lead.source)) {\r\n        demoScore += 10;\r\n        breakdown.push({ category: 'demographics', score: 10, reason: 'High-quality Source' });\r\n    }\r\n\r\n    totalScore += Math.min(demoScore, 30);\r\n\r\n    // --- B. Engagement (Max 40 pts) ---\r\n    // Derived from lead_activities\r\n    let engageScore = 0;\r\n    const activities = lead.activities || [];\r\n\r\n    const emailOpens = activities.filter((a: any) => a.activity_type === 'email_opened').length;\r\n    const linkClicks = activities.filter((a: any) => a.activity_type === 'link_clicked').length;\r\n    const websiteVisits = activities.filter((a: any) => a.activity_type === 'page_view').length;\r\n    const meetings = activities.filter((a: any) => a.activity_type === 'meeting_booked').length;\r\n\r\n    if (emailOpens > 0) {\r\n        const points = Math.min(emailOpens * 2, 10);\r\n        engageScore += points;\r\n        breakdown.push({ category: 'engagement', score: points, reason: `${emailOpens} Email Opens` });\r\n    }\r\n\r\n    if (linkClicks > 0) {\r\n        const points = Math.min(linkClicks * 5, 15);\r\n        engageScore += points;\r\n        breakdown.push({ category: 'engagement', score: points, reason: `${linkClicks} Link Clicks` });\r\n    }\r\n\r\n    if (meetings > 0) {\r\n        engageScore += 20; // High value!\r\n        breakdown.push({ category: 'engagement', score: 20, reason: 'Meeting Booked' });\r\n    }\r\n\r\n    totalScore += Math.min(engageScore, 40);\r\n\r\n    // --- C. Behavior / Negative signals (Max 30 pts) ---\r\n    let behaviorScore = 0;\r\n\r\n    // Recent activity (Last 7 days)\r\n    const lastActivity = activities[0] ? new Date(activities[0].created_at) : null;\r\n    if (lastActivity) {\r\n        const daysSince = (Date.now() - lastActivity.getTime()) / (1000 * 3600 * 24);\r\n        if (daysSince < 3) {\r\n            behaviorScore += 15;\r\n            breakdown.push({ category: 'behavior', score: 15, reason: 'Active in last 3 days' });\r\n        } else if (daysSince < 7) {\r\n            behaviorScore += 5;\r\n            breakdown.push({ category: 'behavior', score: 5, reason: 'Active in last week' });\r\n        }\r\n    } else {\r\n        // New lead bonus\r\n        const daysSinceCreated = (Date.now() - new Date(lead.created_at).getTime()) / (1000 * 3600 * 24);\r\n        if (daysSinceCreated < 2) {\r\n            behaviorScore += 10;\r\n            breakdown.push({ category: 'behavior', score: 10, reason: 'New Lead' });\r\n        }\r\n    }\r\n\r\n    totalScore += Math.min(behaviorScore, 30);\r\n\r\n    // Final Cap\r\n    totalScore = Math.min(Math.max(totalScore, 0), 100);\r\n\r\n    // Determine Level\r\n    let level: 'cold' | 'warm' | 'hot' = 'cold';\r\n    if (totalScore >= 70) level = 'hot';\r\n    else if (totalScore >= 40) level = 'warm';\r\n\r\n    // --- Persist Score ---\r\n    // Don't recurse (infinite loop if we listen to update events improperly)\r\n    // We just update the score field.\r\n    await supabase\r\n        .from('leads')\r\n        .update({\r\n            score: totalScore,\r\n            status: level === 'hot' && lead.status === 'new' ? 'qualified' : lead.status // Auto-qualify hot leads? Optional.\r\n        })\r\n        .eq('id', leadId);\r\n\r\n    // Log calculation for AI transparency\r\n    await supabase\r\n        .from('ai_score_logs')\r\n        .insert({\r\n            resource_type: 'lead',\r\n            resource_id: leadId,\r\n            score: totalScore,\r\n            reasons: breakdown,\r\n            model_version: 'v1.0-heuristic'\r\n        });\r\n\r\n    return { totalScore, breakdown, level };\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\shavi acadimy\\Shavierp\\lib\\nazmly\\lead-scorer.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'e' is defined but never used.","line":76,"column":14,"nodeType":null,"messageId":"unusedVar","endLine":76,"endColumn":15}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { parsePhoneNumber, isValidPhoneNumber } from 'libphonenumber-js';\r\nimport { LeadTemperature, LeadScore } from './types';\r\n\r\n/**\r\n * AI-powered Lead Scoring Algorithm\r\n * \r\n * Scores leads based on multiple factors:\r\n * 1. Contact Information Quality (0-20 points)\r\n * 2. Engagement Level (0-30 points)\r\n * 3. Course Interest Clarity (0-20 points)\r\n * 4. Source Quality (0-30 points)\r\n * \r\n * Total Score: 0-100\r\n * Temperature: Hot (70+), Warm (40-69), Cold (0-39)\r\n */\r\n\r\ninterface LeadData {\r\n    email?: string;\r\n    phone?: string;\r\n    course_interest?: string;\r\n    source?: string;\r\n    utm_campaign?: string;\r\n    nazmly_created_at?: string;\r\n}\r\n\r\n/**\r\n * Validate and score email quality\r\n */\r\nfunction scoreEmail(email?: string): number {\r\n    if (!email) return 0;\r\n\r\n    // Basic email validation\r\n    const emailRegex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\r\n    if (!emailRegex.test(email)) return 0;\r\n\r\n    // Bonus for professional domains\r\n    const professionalDomains = ['gmail.com', 'outlook.com', 'hotmail.com', 'yahoo.com'];\r\n    const domain = email.split('@')[1]?.toLowerCase();\r\n\r\n    if (domain && !professionalDomains.includes(domain)) {\r\n        // Corporate/custom domain emails are higher quality\r\n        return 12;\r\n    }\r\n\r\n    return 10;\r\n}\r\n\r\n/**\r\n * Validate and score phone quality using generic international standards\r\n */\r\nfunction scorePhone(phone?: string): number {\r\n    if (!phone) return 0;\r\n\r\n    try {\r\n        // Strict validation for any country\r\n        if (isValidPhoneNumber(phone)) {\r\n            // Check for Country\r\n            const phoneNumber = parsePhoneNumber(phone);\r\n\r\n            // Bonus for local (Saudi) numbers if that matches target market\r\n            if (phoneNumber && phoneNumber.country === 'SA') {\r\n                return 15; // Higher score for local market\r\n            }\r\n\r\n            return 10; // Valid international number\r\n        }\r\n\r\n        // Partial credit if it looks like a phone but fails strict check\r\n        // (e.g. missing + but has correct digits)\r\n        const digitsOnly = phone.replace(/\\D/g, '');\r\n        if (digitsOnly.length >= 7 && digitsOnly.length <= 15) {\r\n            return 5;\r\n        }\r\n\r\n        return 0;\r\n    } catch (e) {\r\n        // Fallback for parsing errors\r\n        const digitsOnly = phone.replace(/\\D/g, '');\r\n        if (digitsOnly.length >= 10 && digitsOnly.length <= 15) {\r\n            return 5;\r\n        }\r\n        return 0;\r\n    }\r\n}\r\n\r\n/**\r\n * Score contact information quality (0-20)\r\n */\r\nfunction scoreContactQuality(data: LeadData): number {\r\n    let score = 0;\r\n\r\n    score += scoreEmail(data.email);\r\n    score += scorePhone(data.phone);\r\n\r\n    return Math.min(score, 20); // Cap at 20\r\n}\r\n\r\n/**\r\n * Score engagement level based on time (0-30)\r\n */\r\nfunction scoreEngagement(data: LeadData): number {\r\n    if (!data.nazmly_created_at) return 15; // Default medium score\r\n\r\n    try {\r\n        const leadTime = new Date(data.nazmly_created_at);\r\n        const now = new Date();\r\n        const hoursSinceCreation = (now.getTime() - leadTime.getTime()) / (1000 * 60 * 60);\r\n\r\n        // Immediate submission (< 1 hour)\r\n        if (hoursSinceCreation < 1) return 30;\r\n\r\n        // Same day (< 24 hours)\r\n        if (hoursSinceCreation < 24) return 25;\r\n\r\n        // Within a week\r\n        if (hoursSinceCreation < 168) return 15;\r\n\r\n        // Older leads\r\n        return 5;\r\n    } catch {\r\n        return 15; // Default on error\r\n    }\r\n}\r\n\r\n/**\r\n * Score course interest clarity (0-20)\r\n */\r\nfunction scoreInterest(data: LeadData): number {\r\n    if (!data.course_interest) return 0;\r\n\r\n    const interest = data.course_interest.toLowerCase();\r\n\r\n    // Specific course names indicate high interest\r\n    const specificCourses = [\r\n        'data science',\r\n        'web development',\r\n        'python',\r\n        'javascript',\r\n        'ui/ux',\r\n        'digital marketing',\r\n    ];\r\n\r\n    for (const course of specificCourses) {\r\n        if (interest.includes(course)) {\r\n            return 20;\r\n        }\r\n    }\r\n\r\n    // Category-level interest\r\n    const categories = ['programming', 'design', 'marketing', 'business'];\r\n    for (const category of categories) {\r\n        if (interest.includes(category)) {\r\n            return 12;\r\n        }\r\n    }\r\n\r\n    // Has some interest mentioned\r\n    if (interest.length > 3) {\r\n        return 8;\r\n    }\r\n\r\n    return 0;\r\n}\r\n\r\n/**\r\n * Score traffic source quality (0-30)\r\n */\r\nfunction scoreSource(data: LeadData): number {\r\n    const source = data.source?.toLowerCase() || '';\r\n    const utm_campaign = data.utm_campaign?.toLowerCase() || '';\r\n\r\n    // Referral - highest quality\r\n    if (source.includes('referral') || source.includes('friend')) {\r\n        return 30;\r\n    }\r\n\r\n    // Organic search - very high quality\r\n    if (source.includes('organic') || source.includes('google') || source.includes('search')) {\r\n        return 28;\r\n    }\r\n\r\n    // Direct traffic - high quality\r\n    if (source.includes('direct') || source === '') {\r\n        return 25;\r\n    }\r\n\r\n    // Paid ads - medium-high quality\r\n    if (source.includes('ads') || source.includes('cpc') || utm_campaign.includes('paid')) {\r\n        return 18;\r\n    }\r\n\r\n    // Social media - medium quality\r\n    if (source.includes('facebook') || source.includes('instagram') ||\r\n        source.includes('twitter') || source.includes('linkedin')) {\r\n        return 15;\r\n    }\r\n\r\n    // Email marketing - medium-low quality\r\n    if (source.includes('email') || source.includes('newsletter')) {\r\n        return 12;\r\n    }\r\n\r\n    // Unknown source\r\n    return 10;\r\n}\r\n\r\n/**\r\n * Determine lead temperature based on total score\r\n */\r\nfunction calculateTemperature(score: number): LeadTemperature {\r\n    if (score >= 70) return 'hot';\r\n    if (score >= 40) return 'warm';\r\n    return 'cold';\r\n}\r\n\r\n/**\r\n * Calculate comprehensive lead score\r\n * \r\n * @param data - Lead data from webhook\r\n * @returns LeadScore object with detailed breakdown\r\n */\r\nexport function calculateLeadScore(data: LeadData): LeadScore {\r\n    const contactQuality = scoreContactQuality(data);\r\n    const engagement = scoreEngagement(data);\r\n    const interest = scoreInterest(data);\r\n    const source = scoreSource(data);\r\n\r\n    const total = contactQuality + engagement + interest + source;\r\n    const temperature = calculateTemperature(total);\r\n\r\n    return {\r\n        total,\r\n        contactQuality,\r\n        engagement,\r\n        interest,\r\n        source,\r\n        temperature,\r\n    };\r\n}\r\n\r\n/**\r\n * Get predicted conversion value based on score\r\n * \r\n * @param score - Total lead score (0-100)\r\n * @returns Estimated conversion value in SAR\r\n */\r\nexport function predictConversionValue(score: number): number {\r\n    // Base course price assumption: 5000 SAR\r\n    const baseValue = 5000;\r\n\r\n    // Conversion probability based on score\r\n    const conversionProbability = score / 100;\r\n\r\n    // Predicted value = base value * conversion probability * upsell factor\r\n    const upsellFactor = score >= 70 ? 1.3 : score >= 40 ? 1.1 : 1.0;\r\n\r\n    return Math.round(baseValue * conversionProbability * upsellFactor);\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\shavi acadimy\\Shavierp\\lib\\nazmly\\schemas.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\shavi acadimy\\Shavierp\\lib\\nazmly\\store-helpers.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":226,"column":39,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":226,"endColumn":42,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7232,7235],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7232,7235],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { createClient } from '@/lib/supabase/server';\r\nimport type { StoreCustomer, StoreOrder, StorePayment } from './store-schemas';\r\n\r\n/**\r\n * Insert a new customer into the database\r\n * \r\n * @param customer - Customer data from Nazmly webhook\r\n * @returns Created customer record\r\n */\r\nexport async function insertCustomer(customer: StoreCustomer) {\r\n    const supabase = createClient();\r\n\r\n    // Check if customer already exists\r\n    const { data: existingCustomer } = await supabase\r\n        .from('customers')\r\n        .select('id')\r\n        .eq('nazmly_customer_id', customer.id)\r\n        .maybeSingle();\r\n\r\n    if (existingCustomer) {\r\n        console.log(`Customer ${customer.id} already exists, skipping insert`);\r\n        return existingCustomer;\r\n    }\r\n\r\n    // Combine first and last name\r\n    const fullName = `${customer.first_name} ${customer.last_name}`.trim();\r\n\r\n    // Insert new customer\r\n    const { data, error } = await supabase\r\n        .from('customers')\r\n        .insert({\r\n            nazmly_customer_id: customer.id,\r\n            full_name: fullName,\r\n            email: customer.email,\r\n            phone: customer.phone || null,\r\n            country: customer.country || null,\r\n            city: customer.city || null,\r\n            address: customer.address || null,\r\n            nazmly_created_at: customer.created_at || new Date().toISOString(),\r\n            last_synced_at: new Date().toISOString(),\r\n        })\r\n        .select()\r\n        .single();\r\n\r\n    if (error) {\r\n        console.error('Error inserting customer:', error);\r\n        throw new Error(`Failed to insert customer: ${error.message}`);\r\n    }\r\n\r\n    console.log(`Customer ${customer.id} inserted successfully`);\r\n    return data;\r\n}\r\n\r\n/**\r\n * Insert a new order into the database\r\n * \r\n * @param order - Order data from Nazmly webhook\r\n * @returns Created order record\r\n */\r\nexport async function insertOrder(order: StoreOrder) {\r\n    const supabase = createClient();\r\n\r\n    // Check if order already exists\r\n    const { data: existingOrder } = await supabase\r\n        .from('orders')\r\n        .select('id')\r\n        .eq('nazmly_order_id', order.id)\r\n        .maybeSingle();\r\n\r\n    if (existingOrder) {\r\n        console.log(`Order ${order.id} already exists, updating status`);\r\n\r\n        // Update existing order status\r\n        const { data, error } = await supabase\r\n            .from('orders')\r\n            .update({\r\n                status: order.status,\r\n                confirmed_at: order.confirmed_at || null,\r\n                last_synced_at: new Date().toISOString(),\r\n            })\r\n            .eq('id', existingOrder.id)\r\n            .select()\r\n            .single();\r\n\r\n        if (error) {\r\n            throw new Error(`Failed to update order: ${error.message}`);\r\n        }\r\n\r\n        return data;\r\n    }\r\n\r\n    // Find corresponding customer\r\n    const { data: customer } = await supabase\r\n        .from('customers')\r\n        .select('id')\r\n        .eq('nazmly_customer_id', order.customer_id)\r\n        .maybeSingle();\r\n\r\n    if (!customer) {\r\n        throw new Error(`Customer ${order.customer_id} not found. Ensure customer.created event is processed first.`);\r\n    }\r\n\r\n    // Insert new order\r\n    const { data, error } = await supabase\r\n        .from('orders')\r\n        .insert({\r\n            nazmly_order_id: order.id,\r\n            customer_id: customer.id,\r\n            order_number: order.order_number,\r\n            status: order.status,\r\n            items: order.items, // Store as JSONB\r\n            subtotal: order.subtotal,\r\n            tax: order.tax,\r\n            shipping_fee: order.shipping_fee,\r\n            discount: order.discount,\r\n            total: order.total,\r\n            currency: order.currency,\r\n            payment_method: order.payment_method || null,\r\n            shipping_address: order.shipping_address || null, // Store as JSONB\r\n            notes: order.notes || null,\r\n            nazmly_created_at: order.created_at,\r\n            confirmed_at: order.confirmed_at || null,\r\n            last_synced_at: new Date().toISOString(),\r\n        })\r\n        .select()\r\n        .single();\r\n\r\n    if (error) {\r\n        console.error('Error inserting order:', error);\r\n        throw new Error(`Failed to insert order: ${error.message}`);\r\n    }\r\n\r\n    console.log(`Order ${order.id} inserted successfully`);\r\n    return data;\r\n}\r\n\r\n/**\r\n * Insert a new payment record into the database\r\n * \r\n * @param payment - Payment data from Nazmly webhook\r\n * @returns Created payment record\r\n */\r\nexport async function insertPayment(payment: StorePayment) {\r\n    const supabase = createClient();\r\n\r\n    // Check if payment already exists\r\n    const { data: existingPayment } = await supabase\r\n        .from('payments')\r\n        .select('id')\r\n        .eq('nazmly_payment_id', payment.id)\r\n        .maybeSingle();\r\n\r\n    if (existingPayment) {\r\n        console.log(`Payment ${payment.id} already exists, skipping insert`);\r\n        return existingPayment;\r\n    }\r\n\r\n    // Find corresponding order\r\n    const { data: order } = await supabase\r\n        .from('orders')\r\n        .select('id, customer_id')\r\n        .eq('nazmly_order_id', payment.order_id)\r\n        .maybeSingle();\r\n\r\n    if (!order) {\r\n        throw new Error(`Order ${payment.order_id} not found. Ensure order event is processed first.`);\r\n    }\r\n\r\n    // Insert payment record\r\n    const { data, error } = await supabase\r\n        .from('payments')\r\n        .insert({\r\n            nazmly_payment_id: payment.id,\r\n            order_id: order.id,\r\n            customer_id: order.customer_id,\r\n            amount: payment.amount,\r\n            currency: payment.currency,\r\n            payment_method: payment.payment_method,\r\n            status: payment.status === 'succeeded' ? 'completed' : payment.status,\r\n            transaction_id: payment.transaction_id || null,\r\n            payment_date: payment.paid_at,\r\n            receipt_url: payment.receipt_url || null,\r\n            last_synced_at: new Date().toISOString(),\r\n        })\r\n        .select()\r\n        .single();\r\n\r\n    if (error) {\r\n        console.error('Error inserting payment:', error);\r\n        throw new Error(`Failed to insert payment: ${error.message}`);\r\n    }\r\n\r\n    // Update order status to 'completed' if payment succeeded\r\n    if (payment.status === 'succeeded') {\r\n        await supabase\r\n            .from('orders')\r\n            .update({ status: 'completed' })\r\n            .eq('id', order.id);\r\n    }\r\n\r\n    console.log(`Payment ${payment.id} inserted successfully`);\r\n    return data;\r\n}\r\n\r\n/**\r\n * Log webhook event for audit trail\r\n * \r\n * @param eventType - Type of webhook event\r\n * @param payload - Full webhook payload\r\n * @param status - Processing status\r\n * @param errorMessage - Optional error message\r\n */\r\nexport async function logStoreWebhookEvent(\r\n    eventType: string,\r\n    payload: unknown,\r\n    status: 'pending' | 'success' | 'failed',\r\n    errorMessage?: string\r\n): Promise<string | null> {\r\n    try {\r\n        const supabase = createClient();\r\n\r\n        const { data, error } = await supabase\r\n            .from('webhook_logs')\r\n            .insert({\r\n                event_type: eventType,\r\n                event_id: (payload as any)?.data?.id || 'unknown',\r\n                payload: payload,\r\n                status,\r\n                error_message: errorMessage || null,\r\n                processed_at: status !== 'pending' ? new Date().toISOString() : null,\r\n            })\r\n            .select('id')\r\n            .single();\r\n\r\n        if (error) {\r\n            console.error('Failed to log webhook event:', error);\r\n            return null;\r\n        }\r\n\r\n        return data.id;\r\n    } catch (error) {\r\n        console.error('Exception while logging webhook:', error);\r\n        return null;\r\n    }\r\n}\r\n\r\n/**\r\n * Update webhook log status\r\n * \r\n * @param logId - Webhook log ID\r\n * @param status - New status\r\n * @param errorMessage - Optional error message\r\n */\r\nexport async function updateStoreWebhookLog(\r\n    logId: string,\r\n    status: 'success' | 'failed',\r\n    errorMessage?: string\r\n): Promise<void> {\r\n    try {\r\n        const supabase = createClient();\r\n\r\n        await supabase\r\n            .from('webhook_logs')\r\n            .update({\r\n                status,\r\n                error_message: errorMessage || null,\r\n                processed_at: new Date().toISOString(),\r\n            })\r\n            .eq('id', logId);\r\n    } catch (error) {\r\n        console.error('Failed to update webhook log:', error);\r\n    }\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\shavi acadimy\\Shavierp\\lib\\nazmly\\store-schemas.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":98,"column":12,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":98,"endColumn":15,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2753,2756],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2753,2756],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":106,"column":24,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":106,"endColumn":27,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2948,2951],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2948,2951],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { z } from 'zod';\r\n\r\n/**\r\n * Nazmly Store Event Types \r\n * Based on actual Nazmly API payloads\r\n */\r\nexport type NazmlyStoreEventType =\r\n    | 'store.customer.created'\r\n    | 'store.order.created'\r\n    | 'store.order.confirmed'\r\n    | 'store.order.payment_succeeded';\r\n\r\n/**\r\n * Customer Schema (nested within order)\r\n */\r\nexport const NazmlyCustomerSchema = z.object({\r\n    id: z.string(),\r\n    first_name: z.string(),\r\n    last_name: z.string(),\r\n    email: z.string().email(),\r\n    phone: z.string().optional(),\r\n    country: z.string().optional(),\r\n    city: z.string().optional(),\r\n    address: z.string().optional(),\r\n    created_at: z.string().optional()\r\n});\r\n\r\n/**\r\n * Product Schema (Nazmly format)\r\n */\r\nexport const NazmlyProductSchema = z.object({\r\n    id: z.string(),\r\n    title: z.string(),\r\n});\r\n\r\n/**\r\n * Promo Schema\r\n */\r\nexport const NazmlyPromoSchema = z.object({\r\n    code: z.string(),\r\n    discount_amount: z.number(),\r\n    currency: z.string(),\r\n});\r\n\r\n/**\r\n * Charge Amount Schema  \r\n */\r\nexport const NazmlyChargeAmountSchema = z.object({\r\n    amount: z.number(),\r\n    promo_discount: z.number().optional(),\r\n    currency: z.string(),\r\n    discount_amount: z.number().optional(),\r\n    total_amount: z.number(),\r\n});\r\n\r\n/**\r\n * Order Data Schema (matches Nazmly's actual format)\r\n */\r\nexport const NazmlyOrderDataSchema = z.object({\r\n    id: z.string(),\r\n    status: z.string(), // Can be: pendingPayment, confirmed, etc.\r\n    created_at: z.string(),\r\n    customer: NazmlyCustomerSchema,\r\n    promo: NazmlyPromoSchema.optional().nullable(),\r\n    charge_amount: NazmlyChargeAmountSchema,\r\n    settlement_amount: z.any().optional().nullable(),\r\n    products: z.array(NazmlyProductSchema),\r\n});\r\n\r\n/**\r\n * Generic Webhook Schema (flexible for all event types)\r\n */\r\nexport const NazmlyWebhookSchema = z.object({\r\n    type: z.string(), // Event type: store.order.created, etc.\r\n    id: z.string(), // Webhook event ID\r\n    version: z.string().optional(), // API version\r\n    data: z.any(), // Flexible data - will be parsed based on type\r\n});\r\n\r\n/**\r\n * TypeScript Types\r\n */\r\nexport type NazmlyCustomer = z.infer<typeof NazmlyCustomerSchema>;\r\nexport type NazmlyProduct = z.infer<typeof NazmlyProductSchema>;\r\nexport type NazmlyOrderData = z.infer<typeof NazmlyOrderDataSchema>;\r\nexport type NazmlyWebhook = z.infer<typeof NazmlyWebhookSchema>;\r\n\r\n// Aliases for compatibility with helpers\r\nexport type StoreCustomer = NazmlyCustomer;\r\n\r\n// Expanded Order type for helper usage (relaxed to allow customer_id access if flattened)\r\nexport interface StoreOrder {\r\n    id: string;\r\n    customer_id?: string; // Optional if using nested\r\n    customer?: NazmlyCustomer;\r\n    order_number: string;\r\n    status: string;\r\n    items: any[];\r\n    subtotal: number;\r\n    tax: number;\r\n    shipping_fee: number;\r\n    discount: number;\r\n    total: number;\r\n    currency: string;\r\n    payment_method?: string;\r\n    shipping_address?: any;\r\n    notes?: string;\r\n    created_at: string;\r\n    confirmed_at?: string;\r\n}\r\n\r\nexport interface StorePayment {\r\n    id: string;\r\n    order_id: string;\r\n    amount: number;\r\n    currency: string;\r\n    status: string;\r\n    payment_method: string;\r\n    transaction_id?: string;\r\n    paid_at: string;\r\n    receipt_url?: string;\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\shavi acadimy\\Shavierp\\lib\\nazmly\\types.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":85,"column":29,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":85,"endColumn":32,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2124,2127],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2124,2127],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// Nazmly Integration Types\r\n\r\nexport interface NazmlyLeadWebhook {\r\n    event: 'lead.created' | 'lead.updated';\r\n    timestamp: string;\r\n    data: {\r\n        id: string;\r\n        formId: string;\r\n        name: string;\r\n        email?: string;\r\n        phone?: string;\r\n        course_interest?: string;\r\n        source?: string;\r\n        utm_campaign?: string;\r\n        utm_source?: string;\r\n        utm_medium?: string;\r\n        notes?: string;\r\n    };\r\n}\r\n\r\nexport interface NazmlyEnrollmentWebhook {\r\n    event: 'student.enrolled';\r\n    timestamp: string;\r\n    data: {\r\n        studentId: string;\r\n        enrollmentId: string;\r\n        courseId: string;\r\n        courseName?: string;\r\n        enrolledAt: string;\r\n        studentInfo: {\r\n            name: string;\r\n            email?: string;\r\n            phone?: string;\r\n        };\r\n        paymentStatus?: 'pending' | 'partial' | 'completed';\r\n        totalAmount?: number;\r\n    };\r\n}\r\n\r\nexport interface NazmlySessionWebhook {\r\n    event: 'session.completed' | 'session.cancelled';\r\n    timestamp: string;\r\n    data: {\r\n        sessionId: string;\r\n        courseId: string;\r\n        courseName?: string;\r\n        scheduledTime: string;\r\n        trainerId?: string;\r\n        trainerName?: string;\r\n        durationMinutes?: number;\r\n        attendance?: Record<string, boolean>;\r\n        feedback?: Record<string, {\r\n            rating: number;\r\n            comment?: string;\r\n        }>;\r\n    };\r\n}\r\n\r\nexport interface NazmlyPaymentWebhook {\r\n    event: 'payment.received';\r\n    timestamp: string;\r\n    data: {\r\n        paymentId: string;\r\n        studentId: string;\r\n        enrollmentId: string;\r\n        amount: number;\r\n        currency: string;\r\n        paymentMethod?: string;\r\n        paidAt: string;\r\n        installmentNumber?: number;\r\n        totalInstallments?: number;\r\n    };\r\n}\r\n\r\nexport type NazmlyWebhook =\r\n    | NazmlyLeadWebhook\r\n    | NazmlyEnrollmentWebhook\r\n    | NazmlySessionWebhook\r\n    | NazmlyPaymentWebhook;\r\n\r\nexport interface WebhookLog {\r\n    id: string;\r\n    event_type: string;\r\n    event_id?: string;\r\n    payload: Record<string, any>;\r\n    status: 'pending' | 'success' | 'failed' | 'retrying';\r\n    error_message?: string;\r\n    processed_at?: string;\r\n    created_at: string;\r\n}\r\n\r\nexport type LeadTemperature = 'hot' | 'warm' | 'cold';\r\n\r\nexport interface LeadScore {\r\n    total: number;\r\n    contactQuality: number;\r\n    engagement: number;\r\n    interest: number;\r\n    source: number;\r\n    temperature: LeadTemperature;\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\shavi acadimy\\Shavierp\\lib\\nazmly\\webhook-validator.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":44,"column":29,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":44,"endColumn":32,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1208,1211],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1208,1211],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import crypto from 'crypto';\r\nimport { createClient } from '@/lib/supabase/server';\r\n\r\n/**\r\n * Verify Nazmly webhook signature\r\n * \r\n * @param payload - Raw request body as string\r\n * @param signature - Signature from request header\r\n * @param secret - Webhook secret from environment\r\n * @returns true if signature is valid\r\n */\r\nexport function verifyWebhookSignature(\r\n    payload: string,\r\n    signature: string,\r\n    secret: string\r\n): boolean {\r\n    try {\r\n        const expectedSignature = crypto\r\n            .createHmac('sha256', secret)\r\n            .update(payload)\r\n            .digest('hex');\r\n\r\n        return crypto.timingSafeEqual(\r\n            Buffer.from(signature),\r\n            Buffer.from(expectedSignature)\r\n        );\r\n    } catch (error) {\r\n        console.error('Signature verification error:', error);\r\n        return false;\r\n    }\r\n}\r\n\r\n/**\r\n * Log webhook event to database\r\n * \r\n * @param eventType - Type of webhook event\r\n * @param payload - Full webhook payload\r\n * @param status - Processing status\r\n * @param errorMessage - Error message if failed\r\n * @returns Webhook log ID\r\n */\r\nexport async function logWebhookEvent(\r\n    eventType: string,\r\n    payload: Record<string, any>,\r\n    status: 'pending' | 'success' | 'failed' | 'retrying' = 'pending',\r\n    errorMessage?: string\r\n): Promise<string | null> {\r\n    try {\r\n        const supabase = createClient();\r\n\r\n        const { data, error } = await supabase\r\n            .from('webhook_logs')\r\n            .insert({\r\n                event_type: eventType,\r\n                event_id: payload.data?.id || payload.event,\r\n                payload,\r\n                status,\r\n                error_message: errorMessage,\r\n                processed_at: status === 'success' ? new Date().toISOString() : null,\r\n            })\r\n            .select('id')\r\n            .single();\r\n\r\n        if (error) {\r\n            console.error('Failed to log webhook:', error);\r\n            return null;\r\n        }\r\n\r\n        return data.id;\r\n    } catch (error) {\r\n        console.error('Webhook logging error:', error);\r\n        return null;\r\n    }\r\n}\r\n\r\n/**\r\n * Update webhook log status\r\n * \r\n * @param logId - Webhook log ID\r\n * @param status - New status\r\n * @param errorMessage - Error message if failed\r\n */\r\nexport async function updateWebhookLog(\r\n    logId: string,\r\n    status: 'success' | 'failed' | 'retrying',\r\n    errorMessage?: string\r\n): Promise<void> {\r\n    try {\r\n        const supabase = createClient();\r\n\r\n        await supabase\r\n            .from('webhook_logs')\r\n            .update({\r\n                status,\r\n                error_message: errorMessage,\r\n                processed_at: status === 'success' ? new Date().toISOString() : null,\r\n            })\r\n            .eq('id', logId);\r\n    } catch (error) {\r\n        console.error('Failed to update webhook log:', error);\r\n    }\r\n}\r\n\r\n/**\r\n * Check if webhook event has already been processed (idempotency)\r\n * \r\n * @param eventId - Unique event ID from Nazmly\r\n * @param eventType - Type of event\r\n * @returns true if already processed\r\n */\r\nexport async function isEventProcessed(\r\n    eventId: string,\r\n    eventType: string\r\n): Promise<boolean> {\r\n    try {\r\n        const supabase = createClient();\r\n\r\n        const { data, error } = await supabase\r\n            .from('webhook_logs')\r\n            .select('id')\r\n            .eq('event_id', eventId)\r\n            .eq('event_type', eventType)\r\n            .eq('status', 'success')\r\n            .maybeSingle();\r\n\r\n        if (error) {\r\n            console.error('Error checking event status:', error);\r\n            return false;\r\n        }\r\n\r\n        return data !== null;\r\n    } catch (error) {\r\n        console.error('Event check error:', error);\r\n        return false;\r\n    }\r\n}\r\n\r\n/**\r\n * Extract and validate webhook signature from headers\r\n * \r\n * @param headers - Request headers\r\n * @returns Signature string or null\r\n */\r\nexport function extractWebhookSignature(headers: Headers): string | null {\r\n    // Try common header names\r\n    const signature =\r\n        headers.get('x-nazmly-signature') ||\r\n        headers.get('x-webhook-signature') ||\r\n        headers.get('x-signature');\r\n\r\n    return signature;\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\shavi acadimy\\Shavierp\\lib\\notifications\\service.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":9,"column":16,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":9,"endColumn":19,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[246,249],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[246,249],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { createClient } from '@/lib/supabase/server';\r\n\r\ninterface NotificationPayload {\r\n    recipientId: string;\r\n    type: 'info' | 'success' | 'warning' | 'error';\r\n    title: string;\r\n    message: string;\r\n    link?: string;\r\n    metadata?: any;\r\n}\r\n\r\n/**\r\n * Send System Notification\r\n * Stores notification in database and (optionally) sends email\r\n */\r\nexport async function sendNotification(payload: NotificationPayload) {\r\n    const supabase = createClient();\r\n    const { recipientId, type, title, message, link } = payload;\r\n\r\n    try {\r\n        // 1. Store in Database\r\n        const { error } = await supabase.from('notifications').insert({\r\n            recipient_id: recipientId,\r\n            type,\r\n            title,\r\n            message,\r\n            link,\r\n            is_read: false,\r\n            metadata: payload.metadata\r\n        });\r\n\r\n        if (error) throw error;\r\n\r\n        // 2. Mock Email Sending (Real integration would use Resend/SendGrid)\r\n        console.log(`[Email Mock] To: ${recipientId} | Subject: ${title} | Body: ${message}`);\r\n\r\n        return { success: true };\r\n\r\n    } catch (error) {\r\n        console.error('[Notification Service] Failed to send notification:', error);\r\n        return { success: false, error };\r\n    }\r\n}\r\n\r\n/**\r\n * Mark notification as read\r\n */\r\nexport async function markAsRead(notificationId: string) {\r\n    const supabase = createClient();\r\n    await supabase.from('notifications').update({ is_read: true }).eq('id', notificationId);\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\shavi acadimy\\Shavierp\\lib\\permissions\\index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\shavi acadimy\\Shavierp\\lib\\retry\\service.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":60,"column":14,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":60,"endColumn":17,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1461,1464],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1461,1464],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":101,"column":53,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":101,"endColumn":56,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2525,2528],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2525,2528],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":131,"column":16,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":131,"endColumn":19,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3398,3401],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3398,3401],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * Retry Service for Failed Webhooks\r\n * Implements exponential backoff strategy\r\n */\r\n\r\nimport { createClient } from '@/lib/supabase/server';\r\n\r\nexport type RetryStrategy = 'exponential' | 'fixed' | 'linear';\r\n\r\ninterface RetryConfig {\r\n    maxAttempts?: number;\r\n    strategy?: RetryStrategy;\r\n    baseDelay?: number; // milliseconds\r\n    maxDelay?: number; // milliseconds\r\n}\r\n\r\n/**\r\n * Calculate next retry time based on strategy\r\n */\r\nexport function calculateNextRetry(\r\n    attempts: number,\r\n    strategy: RetryStrategy = 'exponential',\r\n    baseDelay: number = 60000 // 1 minute\r\n): Date {\r\n    let delayMs: number;\r\n\r\n    switch (strategy) {\r\n        case 'exponential':\r\n            // 1min, 2min, 4min, 8min, 16min...\r\n            delayMs = baseDelay * Math.pow(2, attempts);\r\n            break;\r\n\r\n        case 'linear':\r\n            // 1min, 2min, 3min, 4min...\r\n            delayMs = baseDelay * (attempts + 1);\r\n            break;\r\n\r\n        case 'fixed':\r\n            // Always same delay\r\n            delayMs = baseDelay;\r\n            break;\r\n\r\n        default:\r\n            delayMs = baseDelay;\r\n    }\r\n\r\n    // Cap at max delay (default 1 hour)\r\n    const maxDelay = 3600000; // 1 hour\r\n    delayMs = Math.min(delayMs, maxDelay);\r\n\r\n    return new Date(Date.now() + delayMs);\r\n}\r\n\r\n/**\r\n * Add failed webhook to retry queue\r\n */\r\nexport async function addToRetryQueue(\r\n    integrationId: string,\r\n    endpointId: string,\r\n    payload: any,\r\n    originalLogId?: string,\r\n    config: RetryConfig = {}\r\n): Promise<string> {\r\n    const supabase = createClient();\r\n\r\n    const {\r\n        maxAttempts = 3,\r\n        strategy = 'exponential',\r\n        baseDelay = 60000\r\n    } = config;\r\n\r\n    const nextRetryAt = calculateNextRetry(0, strategy, baseDelay);\r\n\r\n    const { data, error } = await supabase\r\n        .from('failed_webhooks')\r\n        .insert({\r\n            integration_id: integrationId,\r\n            endpoint_id: endpointId,\r\n            original_log_id: originalLogId,\r\n            payload,\r\n            attempts: 0,\r\n            max_attempts: maxAttempts,\r\n            next_retry_at: nextRetryAt.toISOString(),\r\n            retry_strategy: strategy,\r\n            status: 'pending',\r\n            error_log: []\r\n        })\r\n        .select('id')\r\n        .single();\r\n\r\n    if (error) {\r\n        throw new Error(`Failed to add to retry queue: ${error.message}`);\r\n    }\r\n\r\n    return data.id;\r\n}\r\n\r\n/**\r\n * Get webhooks ready for retry\r\n */\r\nexport async function getWebhooksToRetry(): Promise<any[]> {\r\n    const supabase = createClient();\r\n\r\n    const { data, error } = await supabase\r\n        .from('failed_webhooks')\r\n        .select(`\r\n            *,\r\n            integrations (name, webhook_url),\r\n            integration_endpoints (name, endpoint_path, method)\r\n        `)\r\n        .eq('status', 'pending')\r\n        .lte('next_retry_at', new Date().toISOString())\r\n        .lt('attempts', supabase.rpc('max_attempts'))\r\n        .order('next_retry_at', { ascending: true })\r\n        .limit(50); // Process 50 at a time\r\n\r\n    if (error) {\r\n        console.error('[Retry Service] Error fetching webhooks to retry:', error);\r\n        return [];\r\n    }\r\n\r\n    return data || [];\r\n}\r\n\r\n/**\r\n * Attempt to retry a failed webhook\r\n */\r\nexport async function retryWebhook(failedWebhookId: string): Promise<{\r\n    success: boolean;\r\n    error?: string;\r\n    response?: any;\r\n}> {\r\n    const supabase = createClient();\r\n\r\n    // Get failed webhook details\r\n    const { data: failedWebhook, error: fetchError } = await supabase\r\n        .from('failed_webhooks')\r\n        .select(`\r\n            *,\r\n            integrations (name, webhook_url),\r\n            integration_endpoints (name, endpoint_path, method)\r\n        `)\r\n        .eq('id', failedWebhookId)\r\n        .single();\r\n\r\n    if (fetchError || !failedWebhook) {\r\n        return { success: false, error: 'Failed webhook not found' };\r\n    }\r\n\r\n    // Build webhook URL\r\n    const baseUrl = process.env.NEXT_PUBLIC_APP_URL || 'http://localhost:3000';\r\n    const webhookUrl = `${baseUrl}${failedWebhook.integration_endpoints.endpoint_path}`;\r\n\r\n    // Attempt retry\r\n    try {\r\n        const response = await fetch(webhookUrl, {\r\n            method: failedWebhook.integration_endpoints.method || 'POST',\r\n            headers: { 'Content-Type': 'application/json' },\r\n            body: JSON.stringify(failedWebhook.payload)\r\n        });\r\n\r\n        const responseBody = await response.json().catch(() => response.text());\r\n\r\n        if (response.ok) {\r\n            // Success! Mark as resolved\r\n            await supabase\r\n                .from('failed_webhooks')\r\n                .update({\r\n                    status: 'resolved',\r\n                    resolved_at: new Date().toISOString()\r\n                })\r\n                .eq('id', failedWebhookId);\r\n\r\n            // Log success\r\n            await supabase.from('integration_logs').insert({\r\n                integration_id: failedWebhook.integration_id,\r\n                endpoint_id: failedWebhook.endpoint_id,\r\n                event_type: failedWebhook.payload.type || 'retry',\r\n                status: 'success',\r\n                request_payload: failedWebhook.payload,\r\n                response_payload: responseBody,\r\n                response_status: response.status\r\n            });\r\n\r\n            return { success: true, response: responseBody };\r\n\r\n        } else {\r\n            // Still failing - update retry count\r\n            const newAttempts = failedWebhook.attempts + 1;\r\n            const isDead = newAttempts >= failedWebhook.max_attempts;\r\n\r\n            const nextRetryAt = isDead\r\n                ? null\r\n                : calculateNextRetry(\r\n                    newAttempts,\r\n                    failedWebhook.retry_strategy as RetryStrategy,\r\n                    60000\r\n                );\r\n\r\n            const errorMessage = `HTTP ${response.status}: ${responseBody}`;\r\n            const updatedErrorLog = Array.isArray(failedWebhook.error_log)\r\n                ? [...failedWebhook.error_log, errorMessage]\r\n                : [errorMessage];\r\n\r\n            await supabase\r\n                .from('failed_webhooks')\r\n                .update({\r\n                    attempts: newAttempts,\r\n                    next_retry_at: nextRetryAt?.toISOString(),\r\n                    status: isDead ? 'dead' : 'pending',\r\n                    error_log: updatedErrorLog\r\n                })\r\n                .eq('id', failedWebhookId);\r\n\r\n            return {\r\n                success: false,\r\n                error: errorMessage,\r\n                response: responseBody\r\n            };\r\n        }\r\n\r\n    } catch (error) {\r\n        // Network/fetch error\r\n        const newAttempts = failedWebhook.attempts + 1;\r\n        const isDead = newAttempts >= failedWebhook.max_attempts;\r\n\r\n        const nextRetryAt = isDead\r\n            ? null\r\n            : calculateNextRetry(\r\n                newAttempts,\r\n                failedWebhook.retry_strategy as RetryStrategy,\r\n                60000\r\n            );\r\n\r\n        const errorMessage = error instanceof Error ? error.message : 'Unknown error';\r\n        const updatedErrorLog = Array.isArray(failedWebhook.error_log)\r\n            ? [...failedWebhook.error_log, errorMessage]\r\n            : [errorMessage];\r\n\r\n        await supabase\r\n            .from('failed_webhooks')\r\n            .update({\r\n                attempts: newAttempts,\r\n                next_retry_at: nextRetryAt?.toISOString(),\r\n                status: isDead ? 'dead' : 'pending',\r\n                error_log: updatedErrorLog\r\n            })\r\n            .eq('id', failedWebhookId);\r\n\r\n        return { success: false, error: errorMessage };\r\n    }\r\n}\r\n\r\n/**\r\n * Process retry queue (call this from a cron job)\r\n */\r\nexport async function processRetryQueue(): Promise<{\r\n    processed: number;\r\n    succeeded: number;\r\n    failed: number;\r\n}> {\r\n    const webhooks = await getWebhooksToRetry();\r\n\r\n    let succeeded = 0;\r\n    let failed = 0;\r\n\r\n    for (const webhook of webhooks) {\r\n        const result = await retryWebhook(webhook.id);\r\n\r\n        if (result.success) {\r\n            succeeded++;\r\n        } else {\r\n            failed++;\r\n        }\r\n\r\n        // Small delay between retries to avoid overwhelming the system\r\n        await new Promise(resolve => setTimeout(resolve, 100));\r\n    }\r\n\r\n    return {\r\n        processed: webhooks.length,\r\n        succeeded,\r\n        failed\r\n    };\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\shavi acadimy\\Shavierp\\lib\\supabase\\server.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\shavi acadimy\\Shavierp\\lib\\types.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\shavi acadimy\\Shavierp\\lib\\utils.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\shavi acadimy\\Shavierp\\middleware.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\shavi acadimy\\Shavierp\\next.config.ts","messages":[{"ruleId":"@typescript-eslint/no-require-imports","severity":2,"message":"A `require()` style import is forbidden.","line":3,"column":17,"nodeType":"CallExpression","messageId":"noRequireImports","endLine":3,"endColumn":48},{"ruleId":"@typescript-eslint/no-require-imports","severity":2,"message":"A `require()` style import is forbidden.","line":15,"column":28,"nodeType":"CallExpression","messageId":"noRequireImports","endLine":15,"endColumn":60}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import type { NextConfig } from \"next\";\n\nconst withPWA = require(\"@ducanh2912/next-pwa\").default({\n  dest: \"public\",\n  cacheOnFrontEndNav: true,\n  aggressiveFrontEndNavCaching: true,\n  reloadOnOnline: true,\n  swcMinify: true,\n  disable: process.env.NODE_ENV === \"development\",\n  workboxOptions: {\n    disableDevLogs: true,\n  },\n});\n\nconst withBundleAnalyzer = require(\"@next/bundle-analyzer\")({\n  enabled: process.env.ANALYZE === \"true\",\n});\n\nconst nextConfig: NextConfig = {\n  turbopack: {}, // Silence Turbopack warning\n\n  // Image optimization\n  images: {\n    formats: [\"image/avif\", \"image/webp\"],\n    deviceSizes: [640, 750, 828, 1080, 1200, 1920, 2048, 3840],\n    imageSizes: [16, 32, 48, 64, 96, 128, 256, 384],\n  },\n\n  // Compression\n  compress: true,\n};\n\nexport default withBundleAnalyzer(withPWA(nextConfig));\n","usedDeprecatedRules":[]},{"filePath":"D:\\shavi acadimy\\Shavierp\\postcss.config.mjs","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\shavi acadimy\\Shavierp\\vitest.config.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\shavi acadimy\\Shavierp\\vitest.setup.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'expect' is defined but never used.","line":2,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":2,"endColumn":16}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import '@testing-library/jest-dom';\r\nimport { expect, afterEach, vi } from 'vitest';\r\nimport { cleanup } from '@testing-library/react';\r\n\r\n// Cleanup after each test\r\nafterEach(() => {\r\n    cleanup();\r\n});\r\n\r\n// Mock Next.js router\r\nvi.mock('next/navigation', () => ({\r\n    useRouter: () => ({\r\n        push: vi.fn(),\r\n        replace: vi.fn(),\r\n        prefetch: vi.fn(),\r\n    }),\r\n    usePathname: () => '/',\r\n    useSearchParams: () => new URLSearchParams(),\r\n}));\r\n\r\n// Mock matchMedia\r\nObject.defineProperty(window, 'matchMedia', {\r\n    writable: true,\r\n    value: vi.fn().mockImplementation(query => ({\r\n        matches: false,\r\n        media: query,\r\n        onchange: null,\r\n        addListener: vi.fn(),\r\n        removeListener: vi.fn(),\r\n        addEventListener: vi.fn(),\r\n        removeEventListener: vi.fn(),\r\n        dispatchEvent: vi.fn(),\r\n    })),\r\n});\r\n\r\n// Mock ResizeObserver\r\nglobal.ResizeObserver = vi.fn().mockImplementation(() => ({\r\n    observe: vi.fn(),\r\n    unobserve: vi.fn(),\r\n    disconnect: vi.fn(),\r\n}));\r\n","usedDeprecatedRules":[]}]